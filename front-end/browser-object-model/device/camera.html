<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/ec0a9d078e716e00.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/485ff6fe79292a08.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/0ff121a467c0636f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-53834dba86d90934.js"/><script src="/_next/static/chunks/4bd1b696-20882bf820444624.js" async=""></script><script src="/_next/static/chunks/517-98ed787e5f259f2c.js" async=""></script><script src="/_next/static/chunks/main-app-f33d3e3aed85e21f.js" async=""></script><meta name="next-size-adjust" content=""/><title>front-end</title><meta name="description" content="front-end knowledge"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_4d318d __variable_ea5f4b antialiased"><main><div class="markdown-body"><article><h1>摄录设备</h1>
<p>HTML5 的 <code>getUserMedia</code> API 提供了访问用户媒体设备的能力，基于该特性，开发者可以在不依赖任何浏览器插件的条件下访问视频和音频等设备。</p>
<h2>getUserMedia API</h2>
<p>各主要浏览器对 <code>getUserMedia</code> API 的支持情况。</p>
<table>
<thead>
<tr>
<th>浏览器</th>
<th>版本（旧版 API）</th>
<th>版本（新版 API）</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>IE</td>
<td>不支持</td>
<td>不支持</td>
<td></td>
</tr>
<tr>
<td>Edge</td>
<td>12+</td>
<td>不支持</td>
<td></td>
</tr>
<tr>
<td>Firefox</td>
<td>17+</td>
<td>36+</td>
<td>需要前缀 <code>moz</code></td>
</tr>
<tr>
<td>Chrome</td>
<td>21+</td>
<td>47+</td>
<td>部分支持，需要前缀 <code>webkit</code></td>
</tr>
<tr>
<td>Safari</td>
<td>不支持</td>
<td>不支持</td>
<td></td>
</tr>
<tr>
<td>iOS Safari</td>
<td>不支持</td>
<td>不支持</td>
<td></td>
</tr>
<tr>
<td>Android Browser</td>
<td>56+</td>
<td>不支持</td>
<td>部分支持，需要前缀 <code>webkit</code></td>
</tr>
<tr>
<td>Chrome for Android</td>
<td>57+</td>
<td>不支持</td>
<td>部分支持，需要前缀 <code>webkit</code></td>
</tr>
<tr>
<td>UC Browser for Android</td>
<td>11.4+</td>
<td>不支持</td>
<td>部分支持，需要前缀 <code>webkit</code></td>
</tr>
</tbody>
</table>
<p>旧版语法</p>
<pre class="hljs"><code class="language-js"><span class="hljs-title function_">getUserMedia</span>(constraints, successCallback, errorCallback);
</code></pre>
<p>新版语法</p>
<pre class="hljs"><code class="language-js"><span class="hljs-title function_">getUserMedia</span>(constraints)
  .<span class="hljs-title function_">then</span>(successCallback)
  .<span class="hljs-title function_">catch</span>(errorCallback);
</code></pre>
<p>参数 <code>constraints</code> 指定请求的媒体类型，主要包含 video 和 audio。</p>
<pre class="hljs"><code class="language-js"><span class="hljs-comment">// 请求不带任何参数的视频和音频</span>
{<span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span>}

<span class="hljs-comment">// 可指定视频分辨率</span>
{<span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span>}

<span class="hljs-comment">// 移动设备上，可指定使用前置摄像头</span>
{<span class="hljs-attr">video</span>: { <span class="hljs-attr">facingMode</span>: <span class="hljs-string">&#x27;user&#x27;</span> } }

<span class="hljs-comment">// 使用后置摄像头</span>
{<span class="hljs-attr">video</span>: { <span class="hljs-attr">facingMode</span>: { <span class="hljs-attr">exact</span>: <span class="hljs-string">&#x27;environment&#x27;</span>} } }
</code></pre>
<ul>
<li>成功回调函数 <code>successCallback</code> 的参数 stream，为 MediaStream 对象，表示媒体内容的数据流，可以通过 <code>URL.createObjectURL</code> 转换后设置为 Video 或 Audio 元素的 <code>src</code> 属性来使用，部分较新的浏览器也可以直接设置为 <code>srcObject</code> 属性来使用。</li>
<li>失败回调函数 <code>errorCallback</code> 的参数 <code>error</code>，其中 <code>name</code> 属性的值参考下表。</li>
</ul>
<table>
<thead>
<tr>
<th>错误值</th>
<th>错误名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>AbortError</td>
<td>中止错误</td>
</tr>
<tr>
<td>NotAllowedError</td>
<td>拒绝错误</td>
</tr>
<tr>
<td>NotFoundError</td>
<td>找不到错误</td>
</tr>
<tr>
<td>NotReadableError</td>
<td>无法读取错误</td>
</tr>
<tr>
<td>OverConstrainedError</td>
<td>无法满足要求错误</td>
</tr>
<tr>
<td>SecurityError</td>
<td>安全错误</td>
</tr>
<tr>
<td>TypeError</td>
<td>类型错误</td>
</tr>
</tbody>
</table>
<p>实例代码：</p>
<pre class="hljs"><code class="language-js">navigator.<span class="hljs-property">mediaDevices</span>
  .<span class="hljs-title function_">getUseMedia</span>({ <span class="hljs-attr">video</span>: <span class="hljs-literal">true</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">stream</span>) {
    <span class="hljs-comment">// 成功获得媒体流</span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;获取用户媒体失败:&#x27;</span> + error.<span class="hljs-property">name</span>);
  });
</code></pre>
<p>初次访问用户媒体设备时，浏览器会询问用户是否允许访问，在用户允许后获得访问媒体设备授权。</p>
<h2>调用摄像头拍照实例</h2>
<p>本例子中，将请求访问用户摄像头，并把视频流通过 Video 元素显示出来。</p>
<pre class="hljs"><code class="language-html"><span class="hljs-comment">&lt;!-- video用于显示媒体设备的视频流,自动播放 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;video&quot;</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:480px;height:320px&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;capture&quot;</span>&gt;</span>拍照<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 拍照按钮--&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;canvas&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;480&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;320&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
<span class="hljs-comment">&lt;!-- 描绘video截图 --&gt;</span>
</code></pre>
<pre class="hljs"><code class="language-js"><span class="hljs-comment">// 访问用户媒体设备的兼容方法</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserMedia</span>(<span class="hljs-params">constraints, success, error</span>) {
  <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">mediaDevice</span>.<span class="hljs-property">getUserMedia</span>) {
    <span class="hljs-comment">// 最新的标准API</span>
    navigator.<span class="hljs-property">mediaDevice</span>
      .<span class="hljs-title function_">getUserMedia</span>(constraints)
      .<span class="hljs-title function_">then</span>(success)
      .<span class="hljs-title function_">catch</span>(error);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">webkitGetUserMedia</span>) {
    <span class="hljs-comment">// Webkit 核心浏览器</span>
    navigator.<span class="hljs-title function_">webkitGetUserMedia</span>(constraints, success, error);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">mozGetUserMedia</span>) {
    <span class="hljs-comment">// Firefox 浏览器</span>
    navigator.<span class="hljs-title function_">mozGetUserMedia</span>(constraints, success, error);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">getUserMedia</span>) {
    <span class="hljs-comment">// 旧版 API</span>
    navigator.<span class="hljs-title function_">getUserMedia</span>(constraints, success, error);
  }
}

<span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;video&#x27;</span>);
<span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>);
<span class="hljs-keyword">const</span> context = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2D&#x27;</span>);

<span class="hljs-comment">// 成功的回调函数</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">success</span>(<span class="hljs-params">stream</span>) {
  <span class="hljs-comment">// 兼容的webkit核心浏览器</span>
  <span class="hljs-keyword">const</span> compatobleURL = <span class="hljs-variable language_">window</span>.<span class="hljs-property">URL</span> || <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkitURL</span>;
  <span class="hljs-comment">// 将视频流设置为video元素的源</span>
  video.<span class="hljs-property">src</span> = compatibleURL.<span class="hljs-title function_">createObjectURL</span>(stream);
  video.<span class="hljs-title function_">play</span>(); <span class="hljs-comment">// 播放视频</span>
}

<span class="hljs-comment">// 异常的回调函数</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">error</span>(<span class="hljs-params">error</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;访问用户媒体设备失败:&#x27;</span>, error.<span class="hljs-property">name</span>, error.<span class="hljs-property">message</span>);
}

<span class="hljs-keyword">if</span> (
  navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-property">getUserMedia</span> ||
  navigator.<span class="hljs-property">getUserMedia</span> ||
  navigator.<span class="hljs-property">webkitGetUserMedia</span> ||
  navigator.<span class="hljs-property">mozGetUserMedia</span>
) {
  <span class="hljs-comment">// 调用用户媒体设备，访问摄像头</span>
  <span class="hljs-title function_">getUserMedia</span>({ <span class="hljs-attr">video</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">480</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">320</span> } }, success, error);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;您的浏览器不支持访问用户媒体设备！&#x27;</span>);
}

<span class="hljs-comment">// 绑定拍照按钮的单击事件</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;capture&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  context.<span class="hljs-title function_">drawImage</span>(video, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">480</span>, <span class="hljs-number">320</span>); <span class="hljs-comment">// 将video画面在canvas上绘制出来</span>
});
</code></pre>
</article></div></main><script src="/_next/static/chunks/webpack-53834dba86d90934.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n7:I[6213,[],\"MetadataBoundary\"]\n9:I[6213,[],\"ViewportBoundary\"]\nb:I[4835,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/ec0a9d078e716e00.css\",\"style\"]\n:HL[\"/_next/static/css/485ff6fe79292a08.css\",\"style\"]\n:HL[\"/_next/static/css/0ff121a467c0636f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"NW9bMA21iAaih0TqCHqj1\",\"p\":\"\",\"c\":[\"\",\"front-end\",\"browser-object-model\",\"device\",\"camera\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"front-end\",{\"children\":[[\"slug\",\"browser-object-model/device/camera\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ec0a9d078e716e00.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_4d318d __variable_ea5f4b antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"front-end\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/485ff6fe79292a08.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0ff121a467c0636f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"slug\",\"browser-object-model/device/camera\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":\"$L6\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"RiQwiwqYiav-XCSAPTc3T\",{\"children\":[[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$b\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:T2def,"])</script><script>self.__next_f.push([1,"\u003ch1\u003e摄录设备\u003c/h1\u003e\n\u003cp\u003eHTML5 的 \u003ccode\u003egetUserMedia\u003c/code\u003e API 提供了访问用户媒体设备的能力，基于该特性，开发者可以在不依赖任何浏览器插件的条件下访问视频和音频等设备。\u003c/p\u003e\n\u003ch2\u003egetUserMedia API\u003c/h2\u003e\n\u003cp\u003e各主要浏览器对 \u003ccode\u003egetUserMedia\u003c/code\u003e API 的支持情况。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e浏览器\u003c/th\u003e\n\u003cth\u003e版本（旧版 API）\u003c/th\u003e\n\u003cth\u003e版本（新版 API）\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eIE\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eEdge\u003c/td\u003e\n\u003ctd\u003e12+\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFirefox\u003c/td\u003e\n\u003ctd\u003e17+\u003c/td\u003e\n\u003ctd\u003e36+\u003c/td\u003e\n\u003ctd\u003e需要前缀 \u003ccode\u003emoz\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eChrome\u003c/td\u003e\n\u003ctd\u003e21+\u003c/td\u003e\n\u003ctd\u003e47+\u003c/td\u003e\n\u003ctd\u003e部分支持，需要前缀 \u003ccode\u003ewebkit\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSafari\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eiOS Safari\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAndroid Browser\u003c/td\u003e\n\u003ctd\u003e56+\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e部分支持，需要前缀 \u003ccode\u003ewebkit\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eChrome for Android\u003c/td\u003e\n\u003ctd\u003e57+\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e部分支持，需要前缀 \u003ccode\u003ewebkit\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUC Browser for Android\u003c/td\u003e\n\u003ctd\u003e11.4+\u003c/td\u003e\n\u003ctd\u003e不支持\u003c/td\u003e\n\u003ctd\u003e部分支持，需要前缀 \u003ccode\u003ewebkit\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e旧版语法\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003egetUserMedia\u003c/span\u003e(constraints, successCallback, errorCallback);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e新版语法\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003egetUserMedia\u003c/span\u003e(constraints)\n  .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(successCallback)\n  .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(errorCallback);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e参数 \u003ccode\u003econstraints\u003c/code\u003e 指定请求的媒体类型，主要包含 video 和 audio。\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 请求不带任何参数的视频和音频\u003c/span\u003e\n{\u003cspan class=\"hljs-attr\"\u003evideo\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eaudio\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e}\n\n\u003cspan class=\"hljs-comment\"\u003e// 可指定视频分辨率\u003c/span\u003e\n{\u003cspan class=\"hljs-attr\"\u003evideo\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eaudio\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e}\n\n\u003cspan class=\"hljs-comment\"\u003e// 移动设备上，可指定使用前置摄像头\u003c/span\u003e\n{\u003cspan class=\"hljs-attr\"\u003evideo\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003efacingMode\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;user\u0026#x27;\u003c/span\u003e } }\n\n\u003cspan class=\"hljs-comment\"\u003e// 使用后置摄像头\u003c/span\u003e\n{\u003cspan class=\"hljs-attr\"\u003evideo\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003efacingMode\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eexact\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;environment\u0026#x27;\u003c/span\u003e} } }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e成功回调函数 \u003ccode\u003esuccessCallback\u003c/code\u003e 的参数 stream，为 MediaStream 对象，表示媒体内容的数据流，可以通过 \u003ccode\u003eURL.createObjectURL\u003c/code\u003e 转换后设置为 Video 或 Audio 元素的 \u003ccode\u003esrc\u003c/code\u003e 属性来使用，部分较新的浏览器也可以直接设置为 \u003ccode\u003esrcObject\u003c/code\u003e 属性来使用。\u003c/li\u003e\n\u003cli\u003e失败回调函数 \u003ccode\u003eerrorCallback\u003c/code\u003e 的参数 \u003ccode\u003eerror\u003c/code\u003e，其中 \u003ccode\u003ename\u003c/code\u003e 属性的值参考下表。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e错误值\u003c/th\u003e\n\u003cth\u003e错误名称\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eAbortError\u003c/td\u003e\n\u003ctd\u003e中止错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNotAllowedError\u003c/td\u003e\n\u003ctd\u003e拒绝错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNotFoundError\u003c/td\u003e\n\u003ctd\u003e找不到错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNotReadableError\u003c/td\u003e\n\u003ctd\u003e无法读取错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eOverConstrainedError\u003c/td\u003e\n\u003ctd\u003e无法满足要求错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSecurityError\u003c/td\u003e\n\u003ctd\u003e安全错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTypeError\u003c/td\u003e\n\u003ctd\u003e类型错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e实例代码：\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003enavigator.\u003cspan class=\"hljs-property\"\u003emediaDevices\u003c/span\u003e\n  .\u003cspan class=\"hljs-title function_\"\u003egetUseMedia\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003evideo\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e })\n  .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003estream\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// 成功获得媒体流\u003c/span\u003e\n  })\n  .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;获取用户媒体失败:\u0026#x27;\u003c/span\u003e + error.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e);\n  });\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e初次访问用户媒体设备时，浏览器会询问用户是否允许访问，在用户允许后获得访问媒体设备授权。\u003c/p\u003e\n\u003ch2\u003e调用摄像头拍照实例\u003c/h2\u003e\n\u003cp\u003e本例子中，将请求访问用户摄像头，并把视频流通过 Video 元素显示出来。\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- video用于显示媒体设备的视频流,自动播放 --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003evideo\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;video\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eautoplay\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;width:480px;height:320px\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003evideo\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;capture\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e拍照\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- 拍照按钮--\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ecanvas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;canvas\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ewidth\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;480\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eheight\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;320\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ecanvas\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- 描绘video截图 --\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 访问用户媒体设备的兼容方法\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetUserMedia\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003econstraints, success, error\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (navigator.\u003cspan class=\"hljs-property\"\u003emediaDevice\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egetUserMedia\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// 最新的标准API\u003c/span\u003e\n    navigator.\u003cspan class=\"hljs-property\"\u003emediaDevice\u003c/span\u003e\n      .\u003cspan class=\"hljs-title function_\"\u003egetUserMedia\u003c/span\u003e(constraints)\n      .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(success)\n      .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(error);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (navigator.\u003cspan class=\"hljs-property\"\u003ewebkitGetUserMedia\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// Webkit 核心浏览器\u003c/span\u003e\n    navigator.\u003cspan class=\"hljs-title function_\"\u003ewebkitGetUserMedia\u003c/span\u003e(constraints, success, error);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (navigator.\u003cspan class=\"hljs-property\"\u003emozGetUserMedia\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// Firefox 浏览器\u003c/span\u003e\n    navigator.\u003cspan class=\"hljs-title function_\"\u003emozGetUserMedia\u003c/span\u003e(constraints, success, error);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (navigator.\u003cspan class=\"hljs-property\"\u003egetUserMedia\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// 旧版 API\u003c/span\u003e\n    navigator.\u003cspan class=\"hljs-title function_\"\u003egetUserMedia\u003c/span\u003e(constraints, success, error);\n  }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e video = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;video\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e canvas = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;canvas\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e context = canvas.\u003cspan class=\"hljs-title function_\"\u003egetContext\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;2D\u0026#x27;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// 成功的回调函数\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esuccess\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003estream\u003c/span\u003e) {\n  \u003cspan class=\"hljs-comment\"\u003e// 兼容的webkit核心浏览器\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e compatobleURL = \u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eURL\u003c/span\u003e || \u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ewebkitURL\u003c/span\u003e;\n  \u003cspan class=\"hljs-comment\"\u003e// 将视频流设置为video元素的源\u003c/span\u003e\n  video.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e = compatibleURL.\u003cspan class=\"hljs-title function_\"\u003ecreateObjectURL\u003c/span\u003e(stream);\n  video.\u003cspan class=\"hljs-title function_\"\u003eplay\u003c/span\u003e(); \u003cspan class=\"hljs-comment\"\u003e// 播放视频\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 异常的回调函数\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e) {\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;访问用户媒体设备失败:\u0026#x27;\u003c/span\u003e, error.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e, error.\u003cspan class=\"hljs-property\"\u003emessage\u003c/span\u003e);\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\n  navigator.\u003cspan class=\"hljs-property\"\u003emediaDevices\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egetUserMedia\u003c/span\u003e ||\n  navigator.\u003cspan class=\"hljs-property\"\u003egetUserMedia\u003c/span\u003e ||\n  navigator.\u003cspan class=\"hljs-property\"\u003ewebkitGetUserMedia\u003c/span\u003e ||\n  navigator.\u003cspan class=\"hljs-property\"\u003emozGetUserMedia\u003c/span\u003e\n) {\n  \u003cspan class=\"hljs-comment\"\u003e// 调用用户媒体设备，访问摄像头\u003c/span\u003e\n  \u003cspan class=\"hljs-title function_\"\u003egetUserMedia\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003evideo\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003ewidth\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e480\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eheight\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e320\u003c/span\u003e } }, success, error);\n} \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003ealert\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;您的浏览器不支持访问用户媒体设备！\u0026#x27;\u003c/span\u003e);\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 绑定拍照按钮的单击事件\u003c/span\u003e\n\u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;capture\u0026#x27;\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;click\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n  context.\u003cspan class=\"hljs-title function_\"\u003edrawImage\u003c/span\u003e(video, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e480\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e320\u003c/span\u003e); \u003cspan class=\"hljs-comment\"\u003e// 将video画面在canvas上绘制出来\u003c/span\u003e\n});\n\u003c/code\u003e\u003c/pre\u003e\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"markdown-body\",\"children\":[\"$\",\"article\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$c\"}}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"front-end\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"front-end knowledge\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>