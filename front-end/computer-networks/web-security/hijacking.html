<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/d4dd73d504c89c58.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/485ff6fe79292a08.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/0ff121a467c0636f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-53834dba86d90934.js"/><script src="/_next/static/chunks/4bd1b696-20882bf820444624.js" async=""></script><script src="/_next/static/chunks/517-98ed787e5f259f2c.js" async=""></script><script src="/_next/static/chunks/main-app-f33d3e3aed85e21f.js" async=""></script><meta name="next-size-adjust" content=""/><title>front-end</title><meta name="description" content="front-end knowledge"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_4d318d __variable_ea5f4b antialiased"><main><div class="markdown-body"><article><h1>æµé‡åŠ«æŒ</h1>
<p>æµé‡åŠ«æŒçš„æ–¹å¼ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>åŸŸåè§£æåŠ«æŒï¼ˆDNS åŠ«æŒï¼‰</li>
<li>æ•°æ®åŠ«æŒï¼ˆHTTP åŠ«æŒï¼‰</li>
</ul>
<p>æˆ‘ä»¬å›½å†…ç”¨æˆ·ï¼Œä¸€èˆ¬æ˜¯åœ¨å®¶ç”¨è·¯ç”±å™¨åé¢ï¼Œè¦è®¿é—®ä¸€ä¸ªç½‘ç«™çš„è¯ï¼Œä¼šæœ‰ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>é¦–å…ˆè®¿é—® DNS æœåŠ¡å™¨ï¼Œå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€ã€‚</li>
<li>è®¿é—®è¿™ä¸ª IP åœ°å€ï¼Œè¿™æ ·ç”¨æˆ·å°±è®¿é—®äº†ç›®æ ‡ç½‘ç«™ã€‚</li>
<li>å¦‚æœæ˜¯ä¸€ä¸ªå»ºè®¾è‰¯å¥½çš„ç½‘ç«™ï¼Œä¸€èˆ¬ä¼šæŠŠé™æ€èµ„æºæ”¾åœ¨ CDN ä¸Šã€‚</li>
</ol>
<p>æµé‡åŠ«æŒå°±æ˜¯åœ¨è¿™äº›ç¯èŠ‚å½“ä¸­ï¼Œå¯¹æ•°æ®è¿›è¡Œ <strong>å·çªƒ</strong>ã€<strong>ç¯¡æ”¹</strong>ï¼Œç”šè‡³è½¬å‘æµé‡è¿›è¡Œæ”»å‡»çš„è¿™æ ·ä¸€ç±»è¡Œä¸ºã€‚</p>
<h2>DNS åŠ«æŒ</h2>
<p><strong>åŸŸåè§£æåŠ«æŒ</strong>ï¼ˆDNS åŠ«æŒï¼‰æ˜¯é’ˆå¯¹ä¼ ç»Ÿ DNS è§£æçš„å¸¸è§åŠ«æŒæ–¹å¼ã€‚ç”¨æˆ·åœ¨æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼Œå³å‘å‡ºä¸€ä¸ª HTTP è¯·æ±‚ï¼Œé¦–å…ˆéœ€è¦è¿›è¡ŒåŸŸåè§£æï¼Œå¾—åˆ°ä¸šåŠ¡æœåŠ¡å™¨çš„ IP åœ°å€ã€‚ä½¿ç”¨ä¼ ç»Ÿ DNS è§£ææ—¶ï¼Œä¼šé€šè¿‡å½“åœ°ç½‘ç»œè¿è¥å•†æä¾›çš„æœ¬åœ°åŸŸåæœåŠ¡å™¨è§£æå¾—åˆ°ç»“æœã€‚åœ¨è¯·æ±‚æœ¬åœ°åŸŸåæœåŠ¡å™¨è§£æåŸŸåæ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œç›®æ ‡åŸŸåè¢«æ¶æ„åœ°è§£æåˆ°å…¶ä»– IP åœ°å€ï¼Œé€ æˆç”¨æˆ·æ— æ³•æ­£å¸¸ä½¿ç”¨æœåŠ¡ã€‚</p>
<p><a href="/front-end/computer-networks/computer-network-architecture/dns#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B">ğŸŒ å…³äºåŸŸåè§£æè¿‡ç¨‹è¯¦è§£</a></p>
<h3>æ”»å‡»æ–¹å¼</h3>
<p>é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å¤Ÿæ±¡æŸ“ DNS ä»¥è¾¾æˆæµé‡åŠ«æŒçš„ç›®çš„å‘¢ï¼Ÿç²—ç•¥æ¥è¯´ï¼Œä¸€å…±æœ‰ä¸‰ç§é€”å¾„ï¼š</p>
<ol>
<li><strong>åœ¨ç”¨æˆ·è®¾å¤‡ä¸ŠåŠ¨æ‰‹</strong>ï¼šè¿™ä¸ªä¸»è¦æ˜¯é€šè¿‡ä¸€äº›æ¶æ„è½¯ä»¶å®ç°çš„ï¼Œæ¯”å¦‚æ—©æœŸä¸€äº›æµæ°“è½¯ä»¶ä¼šåœ¨ç”¨æˆ·æœ¬æœºç¯¡æ”¹ <code>hosts</code> æ–‡ä»¶ï¼Œå½±å“ç”¨æˆ·çš„æœç´¢å¼•æ“å·¥ä½œã€‚</li>
<li><strong>æ±¡æŸ“ä¸­é—´é“¾è·¯è®¾å¤‡</strong>ï¼šç”±äº DNS æŸ¥è¯¢æ˜¯åŸºäº UDP åè®®æ˜æ–‡å‘é€çš„ï¼Œå› æ­¤åœ¨ä»»æ„ä¸­é—´è®¾å¤‡ä¸Šï¼Œæ¯”å¦‚è·¯ç”±å™¨ï¼Œè¿›è¡Œä¸­é—´äººæ”»å‡»ï¼Œä¿®æ”¹ UDP åŒ…çš„å†…å®¹ï¼Œå°±å¯ä»¥å½±å“ DNS çš„ç»“æœäº†ã€‚</li>
<li><strong>å…¥ä¾µ DNS æœåŠ¡å™¨</strong>ï¼šè¿™æ˜¯ä¸€ç§æˆæœ¬æ¯”è¾ƒé«˜çš„æ–¹æ¡ˆï¼Œçœ‹èµ·æ¥ä¼¼ä¹å¾ˆå›°éš¾ï¼Œä½† DNS æ˜¯ä¸€ç§ç›¸å¯¹å¤è€çš„æŠ€æœ¯ï¼Œå…¶æœåŠ¡è½¯ä»¶çš„å®ç°å¯èƒ½å·²ç»å¹´ä¹…å¤±ä¿®ï¼Œåˆ«æœ‰ç”¨å¿ƒçš„æ”»å‡»è€…å¯ä»¥å¯»æ‰¾ä¸€äº›ç¼ºä¹ç»´æŠ¤çš„ DNS æœåŠ¡å™¨ï¼Œæ–½è¡Œæ”»å‡»ã€‚å¦å¤–ï¼Œæœ‰æ—¶ DNS æœåŠ¡å™¨ä¸Šä¸æ­¢è¿è¡Œ DNS è½¯ä»¶ï¼Œè¿˜ä¼šæœ‰ä¸€äº›å…¶ä»–çš„è½¯ä»¶ä¹Ÿåœ¨è¿è¡Œï¼Œæ¯”å¦‚åŒæ—¶ä¹Ÿå¯åŠ¨äº† HTTP æœåŠ¡ç­‰ï¼Œè¿™æ—¶æ”»å‡»è€…ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›è½¯ä»¶çš„æ¼æ´æ¥æ§åˆ¶æœåŠ¡å™¨ï¼Œè¿›è€Œå½±å“ DNS çš„è§£æã€‚ç”±äº DNS çš„ç¼“å­˜å’Œä¸Šä¸‹ä¼ é€’å…³ç³»ï¼Œä¸€æ—¦æœ‰ DNS æœåŠ¡å™¨è¢«å½±å“ï¼Œå°±ä¼šä¸€æ¬¡å½±å“å¾ˆå¤šç”¨æˆ·çš„è®¿é—®ï¼Œå› æ­¤éå¸¸å±é™©ã€‚</li>
</ol>
<p>è¿™ä¸‰ç§é€”å¾„å½“ä¸­ï¼Œç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§çš„å®æ–½æˆæœ¬éƒ½æ¯”è¾ƒé«˜ï¼Œä½†æ±¡æŸ“é“¾è·¯è®¾å¤‡ï¼Œåœ¨ Wi-Fi æ™®åŠè€Œå®‰å…¨æ„è¯†å°šæœªæ™®åŠçš„ä»Šå¤©ï¼Œæ˜¯æœ€å®¹æ˜“å¾—æ‰‹çš„ä¸€ç§é€”å¾„ã€‚</p>
<h3>é˜²å¾¡ç­–ç•¥</h3>
<p>ç›®å‰é’ˆå¯¹ DNS æŠ•æ¯’ï¼Œå¯¹æŠ—ä¸­é—´äººæ”»å‡»çš„ç ”ç©¶æ¯”è¾ƒå¤šã€‚DNS åè®®æœ¬èº«çš„å®‰å…¨æ€§è¾ƒå·®ï¼Œè€Œæ”¹é€  DNS åè®®åˆæ¯”è¾ƒå›°éš¾ï¼Œå› æ­¤ç°åœ¨ä¸»è¦çš„é˜²å¾¡æ‰‹æ®µï¼Œé›†ä¸­åœ¨æ›¿æ¢ UDP åè®®ä¸Šã€‚</p>
<ul>
<li>TLSï¼ˆCloudflareï¼‰</li>
<li>HTTPï¼ˆè…¾è®¯äº‘ã€é˜¿é‡Œäº‘ï¼‰</li>
<li>HTTPSï¼ˆCloudflareã€Googleï¼‰</li>
</ul>
<p>ç›®å‰ï¼Œä¸‰ç§å¸¸è§çš„æ›¿ä»£æ–¹å¼æ¯”è¾ƒæµè¡Œï¼š</p>
<ol>
<li>DNS over TLSã€‚è¿™ç§åè®®æ˜¯åœ¨ TLS åè®®ä¹‹ä¸Šä¼ è¾“ DNS å†…å®¹ï¼Œæœ‰ç‚¹ç±»ä¼¼ HTTPS å’Œ TLS å…³ç³»ã€‚</li>
<li>DNS over HTTPã€‚ç”¨ HTTP åè®®æ¥ä¼ è¾“ DNS ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å›½å†…å‚å•†å½“ä¸­å¯¹è¿™ç§æ–¹æ¡ˆçš„æ”¯æŒè¾ƒå¤šã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨ä¸€ä¸ª å›ºå®šçš„ IP åœ°å€ä½œä¸ºåŸŸåæœåŠ¡å™¨ï¼Œæ¯æ¬¡ä¸å‘ç”Ÿ UDP ï¼Œè€Œæ˜¯å‘è¿™å°æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚æ¥è·å–è§£æç»“æœã€‚ä½†é€šå¸¸å¾ˆéš¾ç­¾å‘ç›¸åº”çš„è¯ä¹¦ç»™å›ºå®š IPï¼Œå› æ­¤ä¹Ÿæœ‰äº›å‚å•†è‡ªå·±å¯¹ HTTP æŠ¥æ–‡è¿›è¡ŒåŠ å¯†ï¼Œä»è€Œé˜²æ­¢è¿™äº›è§£æç»“æœå†è¢«ä¸­é—´äººç¯¡æ”¹ã€‚</li>
<li>DNS over HTTPSã€‚å’Œç¬¬äºŒç‚¹æ¯”è¾ƒç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯ä½¿ç”¨äº† HTTPS åè®®ã€‚æ ¹æ®æˆ‘çš„è§‚å¯Ÿï¼Œé‡‡ç”¨è¿™ç§æ–¹æ¡ˆçš„ Google å’Œ Cloudflare éƒ½ä½¿ç”¨çš„æ˜¯åŸŸåè€Œéå›ºå®š IP ï¼Œå› æ­¤è¿˜æ˜¯è¦å…ˆè§£æä¸€æ¬¡åŸŸåæœåŠ¡å™¨è‡ªèº«çš„åŸŸåæ‰å¯ä»¥è¿›è¡ŒçœŸæ­£çš„æŸ¥è¯¢ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´å†æ¬¡è¢«ä¸­é—´äººæ‰°ä¹±ï¼Œä»è€Œè¿«ä½¿ç”¨æˆ·é™çº§åˆ°æ™®é€šçš„ UDP æ–¹å¼ä¸Šã€‚</li>
</ol>
<p>æ¯”è¾ƒé—æ†¾çš„æ˜¯ï¼Œç”±äºæµè§ˆå™¨æ²¡æœ‰æš´éœ² DNS ç›¸å…³çš„æ¥å£ï¼Œè¿™ä¸‰ç§è¾ƒä¸ºå®‰å…¨çš„ DNS æŸ¥è¯¢æ–¹å¼ï¼Œéƒ½æ— æ³•åœ¨å‰ç«¯å½“ä¸­å¾—ä»¥ä½¿ç”¨ã€‚è€Œ iOS å’Œ Android å¼€å‘è€…æœ‰æœºä¼šä½¿ç”¨å…¶ä¸­çš„æŠ€æœ¯è¿›è¡ŒåŠ å¼ºï¼Œä½†éœ€è¦å•ç‹¬ç¼–å†™ä¸€äº›ä»£ç ã€‚</p>
<blockquote>
<p>æ‰“å·¥ä¿¡éƒ¨ç”µè¯ï¼ˆ12300ï¼‰æŠ•è¯‰ä¹Ÿä¸å¤±æ˜¯ä¸ªå¥½åŠæ³•ã€‚</p>
</blockquote>
<h2>HTTP åŠ«æŒ</h2>
<p>HTTP åè®®å±äºæ˜æ–‡åè®®ï¼Œä¸­é—´é“¾è·¯ä¸Šçš„ä»»æ„è®¾å¤‡ï¼Œéƒ½å¯ä»¥ç¯¡æ”¹å†…å®¹ï¼Œå¯¼è‡´æµé‡åŠ«æŒã€‚</p>
<h3>é˜²å¾¡ç­–ç•¥</h3>
<h4>Content Security Policy</h4>
<p>CSP åŸæœ¬æ˜¯ä¸ºäº†å’Œ XSS å¯¹æŠ—è€Œäº§ç”Ÿçš„ä¸€ç§æŠ€æœ¯æ–¹æ¡ˆï¼Œå…¶åŸç†æ˜¯åœ¨ HTML åŠ è½½çš„æ—¶å€™ï¼ŒæŒ‡å®šæ¯ç§èµ„æºçš„ URL ç™½åå•è§„åˆ™ï¼Œé˜²æ­¢ XSS çš„è¿è¡Œå’Œæ•°æ®å¤–é€ã€‚ä½†å¦‚æœå·§å¦™åˆ©ç”¨è§„åˆ™ï¼Œä¹Ÿå¯ä»¥è®©æ‰€æœ‰çš„èµ„æºå¼ºåˆ¶èµ° HTTPS ï¼Œè¿™æ ·å°±å¯ä»¥é™ä½æµé‡åŠ«æŒçš„å¯èƒ½æ€§ã€‚</p>
<p>å…·ä½“çš„ CSP è§„åˆ™æ¯”è¾ƒå¤æ‚ï¼Œå¤§å®¶å¯ä»¥åœ¨ <a href="https://content-security-policy.com/" target="_blank" rel="noopener noreferrer nofollow">CSP ä¸“å±ç½‘ç«™</a>ä¸Šè‡ªå·±æŸ¥çœ‹ã€‚</p>
<h4>Subresource Integrity</h4>
<p>SRI æ˜¯ä¸“é—¨ç”¨æ¥æ ¡éªŒèµ„æºçš„ä¸€ç§æ–¹æ¡ˆï¼Œå®ƒè¯»å–èµ„æºæ ‡ç­¾ä¸­çš„ <code>integrity</code> å±æ€§ï¼Œå°†å…¶ä¸­çš„ä¿¡æ¯æ‘˜è¦å€¼ï¼Œå’Œèµ„æºå®é™…çš„ä¿¡æ¯æ‘˜è¦å€¼è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœå‘ç°æ— æ³•åŒ¹é…ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šæ‹’ç»æ‰§è¡Œèµ„æºã€‚å¯¹äº <code>&lt;script&gt;</code> æ ‡ç­¾æ¥è¯´ï¼Œå°±æ˜¯æ‹’ç»æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œå¯¹äº CSS æ¥è¯´åˆ™æ˜¯ä¸åŠ è½½å…¶ä¸­çš„æ ·å¼ã€‚</p>
<p>é€šè¿‡ç»™ <code>link</code> æ ‡ç­¾æˆ–è€… <code>script</code> æ ‡ç­¾å¢åŠ  <code>integrity</code> å±æ€§å³å¯å¼€å¯ SRI åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p>
<pre class="hljs"><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>
  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>
  <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//s.url.cn/xxx/aaa.js&quot;</span>
  <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha156-xxx sha384-yyy&quot;</span>
  <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>
&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><code>integrity</code> å€¼åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æŒ‡å®šå“ˆå¸Œå€¼çš„ç”Ÿæˆç®—æ³•ï¼ˆsha256ã€sha384 åŠ sha512ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ç»è¿‡ <code>base64</code> ç¼–ç çš„å®é™…å“ˆå¸Œå€¼ï¼Œä¸¤è€…ä¹‹é—´é€šè¿‡ä¸€ä¸ªçŸ­æ¨ªï¼ˆ<code>-</code>ï¼‰åˆ†å‰²ã€‚<code>integrity</code> å€¼å¯ä»¥åŒ…å«å¤šä¸ªç”±ç©ºæ ¼åˆ†éš”çš„å“ˆå¸Œå€¼ï¼Œåªè¦æ–‡ä»¶åŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œå°±å¯ä»¥é€šè¿‡æ ¡éªŒå¹¶åŠ è½½è¯¥èµ„æºã€‚ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä½¿ç”¨äº† <code>sha256</code> å’Œ <code>sha384</code> ä¸¤ç§ <code>hash</code> æ–¹æ¡ˆã€‚</p>
<blockquote>
<p>å¤‡æ³¨ï¼šcrossorigin=&quot;anonymous&quot; çš„ä½œç”¨æ˜¯å¼•å…¥è·¨åŸŸè„šæœ¬ï¼Œåœ¨ HTML5 ä¸­æœ‰ä¸€ç§æ–¹å¼å¯ä»¥è·å–åˆ°è·¨åŸŸè„šæœ¬çš„é”™è¯¯ä¿¡æ¯ï¼Œé¦–å…ˆè·¨åŸŸè„šæœ¬çš„æœåŠ¡å™¨å¿…é¡»é€šè¿‡ Access-Controll-Allow-Origin å¤´ä¿¡æ¯å…è®¸å½“å‰åŸŸåå¯ä»¥è·å–é”™è¯¯ä¿¡æ¯ï¼Œç„¶åæ˜¯å½“å‰åŸŸåçš„ <code>script</code> æ ‡ç­¾ä¹Ÿå¿…é¡»å£°æ˜æ”¯æŒè·¨åŸŸï¼Œä¹Ÿå°±æ˜¯ <code>crossorigin</code> å±æ€§ã€‚<code>link</code>ã€<code>img</code> ç­‰æ ‡ç­¾å‡æ”¯æŒè·¨åŸŸè„šæœ¬ã€‚å¦‚æœä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶æ— æ³•æ»¡è¶³çš„è¯ï¼Œ å¯ä»¥ä½¿ç”¨ <code>try catch</code> æ–¹æ¡ˆã€‚</p>
</blockquote>
<p>é€šè¿‡ä½¿ç”¨ webpack çš„ <code>html-webpack-plugin</code> å’Œ <code>webpack-subresource-integrity</code> å¯ä»¥ç”ŸæˆåŒ…å« <code>integrity</code> å±æ€§ <code>script</code> æ ‡ç­¾ã€‚</p>
<pre class="hljs"><code class="language-js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">SriPlugin</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;webpack-subresource-integrity&#x27;</span>;

<span class="hljs-keyword">const</span> compiler = <span class="hljs-title function_">webpack</span>({
  <span class="hljs-attr">output</span>: {
    <span class="hljs-attr">crossOriginLoading</span>: <span class="hljs-string">&#x27;anonymous&#x27;</span>,
  },
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">SriPlugin</span>({
      <span class="hljs-attr">hashFuncNames</span>: [<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-string">&#x27;sha384&#x27;</span>],
      <span class="hljs-attr">enabled</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>,
    }),
  ],
});
</code></pre>
<p>é‚£ä¹ˆå½“ <code>script</code> æˆ–è€… <code>link</code> èµ„æº SRI æ ¡éªŒå¤±è´¥çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>æ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯é€šè¿‡ <code>script</code> çš„ <code>onerror</code> äº‹ä»¶ï¼Œå½“é‡åˆ° <code>onerror</code> çš„æ—¶å€™é‡æ–° <code>load</code> é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¹‹é—´çš„èµ„æºï¼š</p>
<pre class="hljs"><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>
  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>
  <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//11.url.cn/aaa.js&quot;</span>
  <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha256-xxx sha384-yyy&quot;</span>
  <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>
  <span class="hljs-attr">onerror</span>=<span class="hljs-string">&quot;loadScriptError.call(this, event)&quot;</span>
  <span class="hljs-attr">onsuccess</span>=<span class="hljs-string">&quot;loadScriptSuccess&quot;</span>
&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>åœ¨æ­¤ä¹‹å‰æ³¨å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
<pre class="hljs"><code class="language-js">(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
	<span class="hljs-keyword">function</span> <span class="hljs-title function_">loadScriptError</span> (<span class="hljs-params">event</span>) {
		<span class="hljs-comment">// ä¸ŠæŠ¥</span>
		...
		<span class="hljs-comment">// é‡æ–°åŠ è½½ js</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) {
			<span class="hljs-keyword">var</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>)
			script.<span class="hljs-property">src</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">src</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\/\/11.src.cn/</span>, <span class="hljs-string">&#x27;https://x.y.z&#x27;</span>) <span class="hljs-comment">// æ›¿æ¢ cdn åœ°å€ä¸ºé™æ€æ–‡ä»¶æœåŠ¡å™¨åœ°å€</span>
			script.<span class="hljs-property">onload</span> = resolve
			script.<span class="hljs-property">onerror</span> = reject
			script.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">&#x27;anonymous&#x27;</span>
			<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;head&#x27;</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">appendChild</span>(script)
		})
	}
	<span class="hljs-keyword">function</span> <span class="hljs-title function_">loadScriptSuccess</span> (<span class="hljs-params"></span>) {
		<span class="hljs-comment">// ä¸ŠæŠ¥</span>
		...
	}
	<span class="hljs-variable language_">window</span>.<span class="hljs-property">loadScriptError</span> = loadScriptError
	<span class="hljs-variable language_">window</span>.<span class="hljs-property">loadScriptSuccess</span> = loadScriptSuccess
})()
</code></pre>
<p>æ¯”è¾ƒç—›è‹¦çš„æ˜¯ <code>onerror</code> ä¸­çš„ <code>event</code> ä¸­æ— æ³•åŒºåˆ†ç©¶ç«Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„é”™è¯¯ï¼Œå¯èƒ½æ˜¯èµ„æºä¸å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½æ˜¯ SRI æ ¡éªŒå¤±è´¥ï¼Œå½“ç„¶å‡ºç°æœ€å¤šçš„è¿˜æ˜¯è¯·æ±‚è¶…æ—¶ï¼Œä¸è¿‡ç›®å‰æ¥çœ‹ï¼Œé™¤éæœ‰ç»Ÿè®¡éœ€æ±‚ï¼Œæ— å·®åˆ«å¯¹å¾…å¹¶æ²¡æœ‰å¤šå¤§é—®é¢˜ã€‚</p>
<p>æ³¨å…¥ <code>onerror</code> äº‹ä»¶</p>
<p>å½“ç„¶ï¼Œç”±äºé¡¹ç›®ä¸­çš„ <code>script</code> æ ‡ç­¾æ˜¯ç”± webpack æ‰“åŒ…è¿›å»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨ <code>script-ext-html-webpack-plugin</code> å°† <code>onerror</code> äº‹ä»¶å’Œ <code>onsuccess</code> äº‹ä»¶æ³¨å…¥è¿›å»ï¼š</p>
<pre class="hljs"><code class="language-js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ScriptExtHtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;script-ext-html-webpack-plugin&#x27;</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">//...</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">SriPlugin</span>({
      <span class="hljs-attr">hashFuncNames</span>: [<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-string">&#x27;sha384&#x27;</span>],
    }),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScriptExtHtmlWebpackPlugin</span>({
      <span class="hljs-attr">custom</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\/*_[A-Za-z0-9]{8}.js/</span>,
        <span class="hljs-attr">attribute</span>: <span class="hljs-string">&#x27;onerror&#x27;</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;loadScriptError.call(this, event)&#x27;</span>,
      },
    }),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScriptExtHtmlWebpackPlugin</span>({
      <span class="hljs-attr">custom</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\/*_[A-Za-z0-9]{8}.js/</span>,
        <span class="hljs-attr">attribute</span>: <span class="hljs-string">&#x27;onsuccess&#x27;</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;loadScriptSuccess.call(this, event)&#x27;</span>,
      },
    }),
  ],
};
</code></pre>
<p>ç„¶åå°† <code>loadScriptError</code> å’Œ <code>loadScriptSuccess</code> ä¸¤ä¸ªæ–¹æ³•æ³¨å…¥åˆ° HTML ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>inline</code> çš„æ–¹å¼ã€‚</p>
<h2>CDN åŠ«æŒ</h2>
<p>å‰é¢è¯´åˆ° script åŠ è½½å¤±è´¥å¯èƒ½æ˜¯ç”±äºå¤šç§åŸå› é€ æˆçš„ï¼Œé‚£å¦‚ä½•æ˜¯å¦åˆ¤æ–­å‘ç”Ÿäº† CDN åŠ«æŒå‘¢ï¼Ÿ</p>
<p>æ–¹æ³•å°±æ˜¯å†è¯·æ±‚ä¸€æ¬¡æ•°æ®ï¼Œæ¯”è¾ƒä¸¤æ¬¡å¾—åˆ°æ–‡ä»¶çš„å†…å®¹ï¼ˆå½“ç„¶ä¸å¿…å…¨éƒ¨æ¯”è¾ƒï¼‰ï¼Œå¦‚æœå†…å®¹ä¸ä¸€è‡´ï¼Œå°±å¯ä»¥å¾—å‡ºç»“è®ºäº†ã€‚</p>
<pre class="hljs"><code class="language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">loadScript</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(url)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (res.<span class="hljs-property">ok</span>) {
        <span class="hljs-keyword">return</span> res;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>());
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">text</span>();
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;
    });
}
</code></pre>
<p>æ¯”è¾ƒä¸¤æ¬¡åŠ è½½çš„ <code>script</code> æ˜¯å¦ç›¸åŒ</p>
<pre class="hljs"><code class="language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">checkScriptDiff</span>(<span class="hljs-params">src, srcNew</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">loadScript</span>(src), <span class="hljs-title function_">loadScript</span>(srcNew)])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-keyword">var</span> res1 = data[<span class="hljs-number">0</span>].<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>);
      <span class="hljs-keyword">var</span> res2 = data[<span class="hljs-number">1</span>].<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>);
      <span class="hljs-keyword">if</span> (!!res1 &amp;&amp; !!res2 &amp;&amp; res1 !== res2) {
        <span class="hljs-comment">// CDNåŠ«æŒäº‹ä»¶å‘ç”Ÿ</span>
      }
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-comment">// ...</span>
    });
}
</code></pre>
<p>è¿™é‡Œä¸ºä»€ä¹ˆåªæ¯”è¾ƒå‰ 1000 ä¸ªå­—ç¬¦ï¼Ÿå› ä¸ºé€šå¸¸ CDN åŠ«æŒè€…ä¼šåœ¨ js æ–‡ä»¶æœ€å‰é¢æ³¨å…¥ä¸€äº›ä»£ç æ¥è¾¾åˆ°ä»–ä»¬çš„ç›®çš„ï¼Œæ³¨å…¥ä¸­é—´ä»£ç éœ€è¦ AST è§£æï¼Œæˆæœ¬è¾ƒé«˜ï¼Œæ‰€ä»¥æ¯”è¾ƒå…¨éƒ¨å­—ç¬¦ä¸²æ²¡æœ‰æ„ä¹‰ã€‚å¦‚æœä½ è¿˜æ˜¯æœ‰é¡¾è™‘çš„è¯ï¼Œå¯ä»¥åŠ ä¸Šå n ä¸ªå­—ç¬¦çš„æ¯”è¾ƒã€‚</p>
<h2>å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity" target="_blank" rel="noopener noreferrer nofollow">ğŸ“– MDNï¼šSubresource Integrity</a></li>
<li><a href="https://juejin.im/entry/5a559dd36fb9a01c9e45d896" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ å¸¸è§ Web å®‰å…¨æ”»é˜²æ€»ç»“</a></li>
<li><a href="https://juejin.im/entry/5bcec8e2518825102423e391" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ æµ…è°ˆæµé‡åŠ«æŒä¸é˜²æ²»</a></li>
<li><a href="https://juejin.im/post/5c355a816fb9a049a42f3ac8" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ è…¾è®¯ IVWEB å›¢é˜Ÿï¼šä½¿ç”¨ SRI è§£å†³ CDN åŠ«æŒ</a></li>
<li><a href="https://www.zhihu.com/question/35720092" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ åº”å¯¹æµé‡åŠ«æŒï¼Œå‰ç«¯èƒ½åšå“ªäº›å·¥ä½œï¼Ÿ</a></li>
<li><a href="https://js8.in/2017/08/04/Web%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%8A%AB%E6%8C%81%E5%92%8C%E5%8F%8D%E5%8A%AB%E6%8C%81/#more" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ Web å‰ç«¯é¡µé¢åŠ«æŒå’ŒååŠ«æŒ</a></li>
</ul>
</article></div></main><script src="/_next/static/chunks/webpack-53834dba86d90934.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n7:I[6213,[],\"MetadataBoundary\"]\n9:I[6213,[],\"ViewportBoundary\"]\nb:I[4835,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/d4dd73d504c89c58.css\",\"style\"]\n:HL[\"/_next/static/css/485ff6fe79292a08.css\",\"style\"]\n:HL[\"/_next/static/css/0ff121a467c0636f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"1zJy3VHENUSg9vzcRvJ6P\",\"p\":\"\",\"c\":[\"\",\"front-end\",\"computer-networks\",\"web-security\",\"hijacking\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"front-end\",{\"children\":[[\"slug\",\"computer-networks/web-security/hijacking\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d4dd73d504c89c58.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_4d318d __variable_ea5f4b antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"front-end\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/485ff6fe79292a08.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0ff121a467c0636f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"slug\",\"computer-networks/web-security/hijacking\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":\"$L6\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"jyWZulmR2WzKTqj4sjuZN\",{\"children\":[[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$b\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:T4bd4,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eæµé‡åŠ«æŒ\u003c/h1\u003e\n\u003cp\u003eæµé‡åŠ«æŒçš„æ–¹å¼ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eåŸŸåè§£æåŠ«æŒï¼ˆDNS åŠ«æŒï¼‰\u003c/li\u003e\n\u003cli\u003eæ•°æ®åŠ«æŒï¼ˆHTTP åŠ«æŒï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eæˆ‘ä»¬å›½å†…ç”¨æˆ·ï¼Œä¸€èˆ¬æ˜¯åœ¨å®¶ç”¨è·¯ç”±å™¨åé¢ï¼Œè¦è®¿é—®ä¸€ä¸ªç½‘ç«™çš„è¯ï¼Œä¼šæœ‰ä¸‰ä¸ªæ­¥éª¤ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eé¦–å…ˆè®¿é—® DNS æœåŠ¡å™¨ï¼Œå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€ã€‚\u003c/li\u003e\n\u003cli\u003eè®¿é—®è¿™ä¸ª IP åœ°å€ï¼Œè¿™æ ·ç”¨æˆ·å°±è®¿é—®äº†ç›®æ ‡ç½‘ç«™ã€‚\u003c/li\u003e\n\u003cli\u003eå¦‚æœæ˜¯ä¸€ä¸ªå»ºè®¾è‰¯å¥½çš„ç½‘ç«™ï¼Œä¸€èˆ¬ä¼šæŠŠé™æ€èµ„æºæ”¾åœ¨ CDN ä¸Šã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eæµé‡åŠ«æŒå°±æ˜¯åœ¨è¿™äº›ç¯èŠ‚å½“ä¸­ï¼Œå¯¹æ•°æ®è¿›è¡Œ \u003cstrong\u003eå·çªƒ\u003c/strong\u003eã€\u003cstrong\u003eç¯¡æ”¹\u003c/strong\u003eï¼Œç”šè‡³è½¬å‘æµé‡è¿›è¡Œæ”»å‡»çš„è¿™æ ·ä¸€ç±»è¡Œä¸ºã€‚\u003c/p\u003e\n\u003ch2\u003eDNS åŠ«æŒ\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eåŸŸåè§£æåŠ«æŒ\u003c/strong\u003eï¼ˆDNS åŠ«æŒï¼‰æ˜¯é’ˆå¯¹ä¼ ç»Ÿ DNS è§£æçš„å¸¸è§åŠ«æŒæ–¹å¼ã€‚ç”¨æˆ·åœ¨æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼Œå³å‘å‡ºä¸€ä¸ª HTTP è¯·æ±‚ï¼Œé¦–å…ˆéœ€è¦è¿›è¡ŒåŸŸåè§£æï¼Œå¾—åˆ°ä¸šåŠ¡æœåŠ¡å™¨çš„ IP åœ°å€ã€‚ä½¿ç”¨ä¼ ç»Ÿ DNS è§£ææ—¶ï¼Œä¼šé€šè¿‡å½“åœ°ç½‘ç»œè¿è¥å•†æä¾›çš„æœ¬åœ°åŸŸåæœåŠ¡å™¨è§£æå¾—åˆ°ç»“æœã€‚åœ¨è¯·æ±‚æœ¬åœ°åŸŸåæœåŠ¡å™¨è§£æåŸŸåæ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œç›®æ ‡åŸŸåè¢«æ¶æ„åœ°è§£æåˆ°å…¶ä»– IP åœ°å€ï¼Œé€ æˆç”¨æˆ·æ— æ³•æ­£å¸¸ä½¿ç”¨æœåŠ¡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"/front-end/computer-networks/computer-network-architecture/dns#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B\"\u003eğŸŒ å…³äºåŸŸåè§£æè¿‡ç¨‹è¯¦è§£\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eæ”»å‡»æ–¹å¼\u003c/h3\u003e\n\u003cp\u003eé‚£ä¹ˆå¦‚ä½•æ‰èƒ½å¤Ÿæ±¡æŸ“ DNS ä»¥è¾¾æˆæµé‡åŠ«æŒçš„ç›®çš„å‘¢ï¼Ÿç²—ç•¥æ¥è¯´ï¼Œä¸€å…±æœ‰ä¸‰ç§é€”å¾„ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eåœ¨ç”¨æˆ·è®¾å¤‡ä¸ŠåŠ¨æ‰‹\u003c/strong\u003eï¼šè¿™ä¸ªä¸»è¦æ˜¯é€šè¿‡ä¸€äº›æ¶æ„è½¯ä»¶å®ç°çš„ï¼Œæ¯”å¦‚æ—©æœŸä¸€äº›æµæ°“è½¯ä»¶ä¼šåœ¨ç”¨æˆ·æœ¬æœºç¯¡æ”¹ \u003ccode\u003ehosts\u003c/code\u003e æ–‡ä»¶ï¼Œå½±å“ç”¨æˆ·çš„æœç´¢å¼•æ“å·¥ä½œã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ±¡æŸ“ä¸­é—´é“¾è·¯è®¾å¤‡\u003c/strong\u003eï¼šç”±äº DNS æŸ¥è¯¢æ˜¯åŸºäº UDP åè®®æ˜æ–‡å‘é€çš„ï¼Œå› æ­¤åœ¨ä»»æ„ä¸­é—´è®¾å¤‡ä¸Šï¼Œæ¯”å¦‚è·¯ç”±å™¨ï¼Œè¿›è¡Œä¸­é—´äººæ”»å‡»ï¼Œä¿®æ”¹ UDP åŒ…çš„å†…å®¹ï¼Œå°±å¯ä»¥å½±å“ DNS çš„ç»“æœäº†ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå…¥ä¾µ DNS æœåŠ¡å™¨\u003c/strong\u003eï¼šè¿™æ˜¯ä¸€ç§æˆæœ¬æ¯”è¾ƒé«˜çš„æ–¹æ¡ˆï¼Œçœ‹èµ·æ¥ä¼¼ä¹å¾ˆå›°éš¾ï¼Œä½† DNS æ˜¯ä¸€ç§ç›¸å¯¹å¤è€çš„æŠ€æœ¯ï¼Œå…¶æœåŠ¡è½¯ä»¶çš„å®ç°å¯èƒ½å·²ç»å¹´ä¹…å¤±ä¿®ï¼Œåˆ«æœ‰ç”¨å¿ƒçš„æ”»å‡»è€…å¯ä»¥å¯»æ‰¾ä¸€äº›ç¼ºä¹ç»´æŠ¤çš„ DNS æœåŠ¡å™¨ï¼Œæ–½è¡Œæ”»å‡»ã€‚å¦å¤–ï¼Œæœ‰æ—¶ DNS æœåŠ¡å™¨ä¸Šä¸æ­¢è¿è¡Œ DNS è½¯ä»¶ï¼Œè¿˜ä¼šæœ‰ä¸€äº›å…¶ä»–çš„è½¯ä»¶ä¹Ÿåœ¨è¿è¡Œï¼Œæ¯”å¦‚åŒæ—¶ä¹Ÿå¯åŠ¨äº† HTTP æœåŠ¡ç­‰ï¼Œè¿™æ—¶æ”»å‡»è€…ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›è½¯ä»¶çš„æ¼æ´æ¥æ§åˆ¶æœåŠ¡å™¨ï¼Œè¿›è€Œå½±å“ DNS çš„è§£æã€‚ç”±äº DNS çš„ç¼“å­˜å’Œä¸Šä¸‹ä¼ é€’å…³ç³»ï¼Œä¸€æ—¦æœ‰ DNS æœåŠ¡å™¨è¢«å½±å“ï¼Œå°±ä¼šä¸€æ¬¡å½±å“å¾ˆå¤šç”¨æˆ·çš„è®¿é—®ï¼Œå› æ­¤éå¸¸å±é™©ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eè¿™ä¸‰ç§é€”å¾„å½“ä¸­ï¼Œç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§çš„å®æ–½æˆæœ¬éƒ½æ¯”è¾ƒé«˜ï¼Œä½†æ±¡æŸ“é“¾è·¯è®¾å¤‡ï¼Œåœ¨ Wi-Fi æ™®åŠè€Œå®‰å…¨æ„è¯†å°šæœªæ™®åŠçš„ä»Šå¤©ï¼Œæ˜¯æœ€å®¹æ˜“å¾—æ‰‹çš„ä¸€ç§é€”å¾„ã€‚\u003c/p\u003e\n\u003ch3\u003eé˜²å¾¡ç­–ç•¥\u003c/h3\u003e\n\u003cp\u003eç›®å‰é’ˆå¯¹ DNS æŠ•æ¯’ï¼Œå¯¹æŠ—ä¸­é—´äººæ”»å‡»çš„ç ”ç©¶æ¯”è¾ƒå¤šã€‚DNS åè®®æœ¬èº«çš„å®‰å…¨æ€§è¾ƒå·®ï¼Œè€Œæ”¹é€  DNS åè®®åˆæ¯”è¾ƒå›°éš¾ï¼Œå› æ­¤ç°åœ¨ä¸»è¦çš„é˜²å¾¡æ‰‹æ®µï¼Œé›†ä¸­åœ¨æ›¿æ¢ UDP åè®®ä¸Šã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTLSï¼ˆCloudflareï¼‰\u003c/li\u003e\n\u003cli\u003eHTTPï¼ˆè…¾è®¯äº‘ã€é˜¿é‡Œäº‘ï¼‰\u003c/li\u003e\n\u003cli\u003eHTTPSï¼ˆCloudflareã€Googleï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç›®å‰ï¼Œä¸‰ç§å¸¸è§çš„æ›¿ä»£æ–¹å¼æ¯”è¾ƒæµè¡Œï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eDNS over TLSã€‚è¿™ç§åè®®æ˜¯åœ¨ TLS åè®®ä¹‹ä¸Šä¼ è¾“ DNS å†…å®¹ï¼Œæœ‰ç‚¹ç±»ä¼¼ HTTPS å’Œ TLS å…³ç³»ã€‚\u003c/li\u003e\n\u003cli\u003eDNS over HTTPã€‚ç”¨ HTTP åè®®æ¥ä¼ è¾“ DNS ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å›½å†…å‚å•†å½“ä¸­å¯¹è¿™ç§æ–¹æ¡ˆçš„æ”¯æŒè¾ƒå¤šã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨ä¸€ä¸ª å›ºå®šçš„ IP åœ°å€ä½œä¸ºåŸŸåæœåŠ¡å™¨ï¼Œæ¯æ¬¡ä¸å‘ç”Ÿ UDP ï¼Œè€Œæ˜¯å‘è¿™å°æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚æ¥è·å–è§£æç»“æœã€‚ä½†é€šå¸¸å¾ˆéš¾ç­¾å‘ç›¸åº”çš„è¯ä¹¦ç»™å›ºå®š IPï¼Œå› æ­¤ä¹Ÿæœ‰äº›å‚å•†è‡ªå·±å¯¹ HTTP æŠ¥æ–‡è¿›è¡ŒåŠ å¯†ï¼Œä»è€Œé˜²æ­¢è¿™äº›è§£æç»“æœå†è¢«ä¸­é—´äººç¯¡æ”¹ã€‚\u003c/li\u003e\n\u003cli\u003eDNS over HTTPSã€‚å’Œç¬¬äºŒç‚¹æ¯”è¾ƒç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯ä½¿ç”¨äº† HTTPS åè®®ã€‚æ ¹æ®æˆ‘çš„è§‚å¯Ÿï¼Œé‡‡ç”¨è¿™ç§æ–¹æ¡ˆçš„ Google å’Œ Cloudflare éƒ½ä½¿ç”¨çš„æ˜¯åŸŸåè€Œéå›ºå®š IP ï¼Œå› æ­¤è¿˜æ˜¯è¦å…ˆè§£æä¸€æ¬¡åŸŸåæœåŠ¡å™¨è‡ªèº«çš„åŸŸåæ‰å¯ä»¥è¿›è¡ŒçœŸæ­£çš„æŸ¥è¯¢ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´å†æ¬¡è¢«ä¸­é—´äººæ‰°ä¹±ï¼Œä»è€Œè¿«ä½¿ç”¨æˆ·é™çº§åˆ°æ™®é€šçš„ UDP æ–¹å¼ä¸Šã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eæ¯”è¾ƒé—æ†¾çš„æ˜¯ï¼Œç”±äºæµè§ˆå™¨æ²¡æœ‰æš´éœ² DNS ç›¸å…³çš„æ¥å£ï¼Œè¿™ä¸‰ç§è¾ƒä¸ºå®‰å…¨çš„ DNS æŸ¥è¯¢æ–¹å¼ï¼Œéƒ½æ— æ³•åœ¨å‰ç«¯å½“ä¸­å¾—ä»¥ä½¿ç”¨ã€‚è€Œ iOS å’Œ Android å¼€å‘è€…æœ‰æœºä¼šä½¿ç”¨å…¶ä¸­çš„æŠ€æœ¯è¿›è¡ŒåŠ å¼ºï¼Œä½†éœ€è¦å•ç‹¬ç¼–å†™ä¸€äº›ä»£ç ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eæ‰“å·¥ä¿¡éƒ¨ç”µè¯ï¼ˆ12300ï¼‰æŠ•è¯‰ä¹Ÿä¸å¤±æ˜¯ä¸ªå¥½åŠæ³•ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eHTTP åŠ«æŒ\u003c/h2\u003e\n\u003cp\u003eHTTP åè®®å±äºæ˜æ–‡åè®®ï¼Œä¸­é—´é“¾è·¯ä¸Šçš„ä»»æ„è®¾å¤‡ï¼Œéƒ½å¯ä»¥ç¯¡æ”¹å†…å®¹ï¼Œå¯¼è‡´æµé‡åŠ«æŒã€‚\u003c/p\u003e\n\u003ch3\u003eé˜²å¾¡ç­–ç•¥\u003c/h3\u003e\n\u003ch4\u003eContent Security Policy\u003c/h4\u003e\n\u003cp\u003eCSP åŸæœ¬æ˜¯ä¸ºäº†å’Œ XSS å¯¹æŠ—è€Œäº§ç”Ÿçš„ä¸€ç§æŠ€æœ¯æ–¹æ¡ˆï¼Œå…¶åŸç†æ˜¯åœ¨ HTML åŠ è½½çš„æ—¶å€™ï¼ŒæŒ‡å®šæ¯ç§èµ„æºçš„ URL ç™½åå•è§„åˆ™ï¼Œé˜²æ­¢ XSS çš„è¿è¡Œå’Œæ•°æ®å¤–é€ã€‚ä½†å¦‚æœå·§å¦™åˆ©ç”¨è§„åˆ™ï¼Œä¹Ÿå¯ä»¥è®©æ‰€æœ‰çš„èµ„æºå¼ºåˆ¶èµ° HTTPS ï¼Œè¿™æ ·å°±å¯ä»¥é™ä½æµé‡åŠ«æŒçš„å¯èƒ½æ€§ã€‚\u003c/p\u003e\n\u003cp\u003eå…·ä½“çš„ CSP è§„åˆ™æ¯”è¾ƒå¤æ‚ï¼Œå¤§å®¶å¯ä»¥åœ¨ \u003ca href=\"https://content-security-policy.com/\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eCSP ä¸“å±ç½‘ç«™\u003c/a\u003eä¸Šè‡ªå·±æŸ¥çœ‹ã€‚\u003c/p\u003e\n\u003ch4\u003eSubresource Integrity\u003c/h4\u003e\n\u003cp\u003eSRI æ˜¯ä¸“é—¨ç”¨æ¥æ ¡éªŒèµ„æºçš„ä¸€ç§æ–¹æ¡ˆï¼Œå®ƒè¯»å–èµ„æºæ ‡ç­¾ä¸­çš„ \u003ccode\u003eintegrity\u003c/code\u003e å±æ€§ï¼Œå°†å…¶ä¸­çš„ä¿¡æ¯æ‘˜è¦å€¼ï¼Œå’Œèµ„æºå®é™…çš„ä¿¡æ¯æ‘˜è¦å€¼è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœå‘ç°æ— æ³•åŒ¹é…ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šæ‹’ç»æ‰§è¡Œèµ„æºã€‚å¯¹äº \u003ccode\u003e\u0026lt;script\u0026gt;\u003c/code\u003e æ ‡ç­¾æ¥è¯´ï¼Œå°±æ˜¯æ‹’ç»æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œå¯¹äº CSS æ¥è¯´åˆ™æ˜¯ä¸åŠ è½½å…¶ä¸­çš„æ ·å¼ã€‚\u003c/p\u003e\n\u003cp\u003eé€šè¿‡ç»™ \u003ccode\u003elink\u003c/code\u003e æ ‡ç­¾æˆ–è€… \u003ccode\u003escript\u003c/code\u003e æ ‡ç­¾å¢åŠ  \u003ccode\u003eintegrity\u003c/code\u003e å±æ€§å³å¯å¼€å¯ SRI åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/javascript\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;//s.url.cn/xxx/aaa.js\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eintegrity\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;sha156-xxx sha384-yyy\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ecrossorigin\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;anonymous\u0026quot;\u003c/span\u003e\n\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eintegrity\u003c/code\u003e å€¼åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æŒ‡å®šå“ˆå¸Œå€¼çš„ç”Ÿæˆç®—æ³•ï¼ˆsha256ã€sha384 åŠ sha512ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ç»è¿‡ \u003ccode\u003ebase64\u003c/code\u003e ç¼–ç çš„å®é™…å“ˆå¸Œå€¼ï¼Œä¸¤è€…ä¹‹é—´é€šè¿‡ä¸€ä¸ªçŸ­æ¨ªï¼ˆ\u003ccode\u003e-\u003c/code\u003eï¼‰åˆ†å‰²ã€‚\u003ccode\u003eintegrity\u003c/code\u003e å€¼å¯ä»¥åŒ…å«å¤šä¸ªç”±ç©ºæ ¼åˆ†éš”çš„å“ˆå¸Œå€¼ï¼Œåªè¦æ–‡ä»¶åŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œå°±å¯ä»¥é€šè¿‡æ ¡éªŒå¹¶åŠ è½½è¯¥èµ„æºã€‚ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä½¿ç”¨äº† \u003ccode\u003esha256\u003c/code\u003e å’Œ \u003ccode\u003esha384\u003c/code\u003e ä¸¤ç§ \u003ccode\u003ehash\u003c/code\u003e æ–¹æ¡ˆã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå¤‡æ³¨ï¼šcrossorigin=\u0026quot;anonymous\u0026quot; çš„ä½œç”¨æ˜¯å¼•å…¥è·¨åŸŸè„šæœ¬ï¼Œåœ¨ HTML5 ä¸­æœ‰ä¸€ç§æ–¹å¼å¯ä»¥è·å–åˆ°è·¨åŸŸè„šæœ¬çš„é”™è¯¯ä¿¡æ¯ï¼Œé¦–å…ˆè·¨åŸŸè„šæœ¬çš„æœåŠ¡å™¨å¿…é¡»é€šè¿‡ Access-Controll-Allow-Origin å¤´ä¿¡æ¯å…è®¸å½“å‰åŸŸåå¯ä»¥è·å–é”™è¯¯ä¿¡æ¯ï¼Œç„¶åæ˜¯å½“å‰åŸŸåçš„ \u003ccode\u003escript\u003c/code\u003e æ ‡ç­¾ä¹Ÿå¿…é¡»å£°æ˜æ”¯æŒè·¨åŸŸï¼Œä¹Ÿå°±æ˜¯ \u003ccode\u003ecrossorigin\u003c/code\u003e å±æ€§ã€‚\u003ccode\u003elink\u003c/code\u003eã€\u003ccode\u003eimg\u003c/code\u003e ç­‰æ ‡ç­¾å‡æ”¯æŒè·¨åŸŸè„šæœ¬ã€‚å¦‚æœä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶æ— æ³•æ»¡è¶³çš„è¯ï¼Œ å¯ä»¥ä½¿ç”¨ \u003ccode\u003etry catch\u003c/code\u003e æ–¹æ¡ˆã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eé€šè¿‡ä½¿ç”¨ webpack çš„ \u003ccode\u003ehtml-webpack-plugin\u003c/code\u003e å’Œ \u003ccode\u003ewebpack-subresource-integrity\u003c/code\u003e å¯ä»¥ç”ŸæˆåŒ…å« \u003ccode\u003eintegrity\u003c/code\u003e å±æ€§ \u003ccode\u003escript\u003c/code\u003e æ ‡ç­¾ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSriPlugin\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;webpack-subresource-integrity\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e compiler = \u003cspan class=\"hljs-title function_\"\u003ewebpack\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eoutput\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003ecrossOriginLoading\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;anonymous\u0026#x27;\u003c/span\u003e,\n  },\n  \u003cspan class=\"hljs-attr\"\u003eplugins\u003c/span\u003e: [\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSriPlugin\u003c/span\u003e({\n      \u003cspan class=\"hljs-attr\"\u003ehashFuncNames\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;sha256\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;sha384\u0026#x27;\u003c/span\u003e],\n      \u003cspan class=\"hljs-attr\"\u003eenabled\u003c/span\u003e: process.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eNODE_ENV\u003c/span\u003e === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;production\u0026#x27;\u003c/span\u003e,\n    }),\n  ],\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eé‚£ä¹ˆå½“ \u003ccode\u003escript\u003c/code\u003e æˆ–è€… \u003ccode\u003elink\u003c/code\u003e èµ„æº SRI æ ¡éªŒå¤±è´¥çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ\u003c/p\u003e\n\u003cp\u003eæ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯é€šè¿‡ \u003ccode\u003escript\u003c/code\u003e çš„ \u003ccode\u003eonerror\u003c/code\u003e äº‹ä»¶ï¼Œå½“é‡åˆ° \u003ccode\u003eonerror\u003c/code\u003e çš„æ—¶å€™é‡æ–° \u003ccode\u003eload\u003c/code\u003e é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¹‹é—´çš„èµ„æºï¼š\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/javascript\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;//11.url.cn/aaa.js\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eintegrity\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;sha256-xxx sha384-yyy\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ecrossorigin\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;anonymous\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eonerror\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;loadScriptError.call(this, event)\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eonsuccess\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;loadScriptSuccess\u0026quot;\u003c/span\u003e\n\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eåœ¨æ­¤ä¹‹å‰æ³¨å…¥ä»¥ä¸‹ä»£ç ï¼š\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e(\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n\t\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eloadScriptError\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003eevent\u003c/span\u003e) {\n\t\t\u003cspan class=\"hljs-comment\"\u003e// ä¸ŠæŠ¥\u003c/span\u003e\n\t\t...\n\t\t\u003cspan class=\"hljs-comment\"\u003e// é‡æ–°åŠ è½½ js\u003c/span\u003e\n\t\t\u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) {\n\t\t\t\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e script = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecreateElement\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;script\u0026#x27;\u003c/span\u003e)\n\t\t\tscript.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ereplace\u003c/span\u003e(\u003cspan class=\"hljs-regexp\"\u003e/\\/\\/11.src.cn/\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;https://x.y.z\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e// æ›¿æ¢ cdn åœ°å€ä¸ºé™æ€æ–‡ä»¶æœåŠ¡å™¨åœ°å€\u003c/span\u003e\n\t\t\tscript.\u003cspan class=\"hljs-property\"\u003eonload\u003c/span\u003e = resolve\n\t\t\tscript.\u003cspan class=\"hljs-property\"\u003eonerror\u003c/span\u003e = reject\n\t\t\tscript.\u003cspan class=\"hljs-property\"\u003ecrossOrigin\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;anonymous\u0026#x27;\u003c/span\u003e\n\t\t\t\u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetElementsByTagName\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;head\u0026#x27;\u003c/span\u003e)[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eappendChild\u003c/span\u003e(script)\n\t\t})\n\t}\n\t\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eloadScriptSuccess\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n\t\t\u003cspan class=\"hljs-comment\"\u003e// ä¸ŠæŠ¥\u003c/span\u003e\n\t\t...\n\t}\n\t\u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eloadScriptError\u003c/span\u003e = loadScriptError\n\t\u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eloadScriptSuccess\u003c/span\u003e = loadScriptSuccess\n})()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eæ¯”è¾ƒç—›è‹¦çš„æ˜¯ \u003ccode\u003eonerror\u003c/code\u003e ä¸­çš„ \u003ccode\u003eevent\u003c/code\u003e ä¸­æ— æ³•åŒºåˆ†ç©¶ç«Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„é”™è¯¯ï¼Œå¯èƒ½æ˜¯èµ„æºä¸å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½æ˜¯ SRI æ ¡éªŒå¤±è´¥ï¼Œå½“ç„¶å‡ºç°æœ€å¤šçš„è¿˜æ˜¯è¯·æ±‚è¶…æ—¶ï¼Œä¸è¿‡ç›®å‰æ¥çœ‹ï¼Œé™¤éæœ‰ç»Ÿè®¡éœ€æ±‚ï¼Œæ— å·®åˆ«å¯¹å¾…å¹¶æ²¡æœ‰å¤šå¤§é—®é¢˜ã€‚\u003c/p\u003e\n\u003cp\u003eæ³¨å…¥ \u003ccode\u003eonerror\u003c/code\u003e äº‹ä»¶\u003c/p\u003e\n\u003cp\u003eå½“ç„¶ï¼Œç”±äºé¡¹ç›®ä¸­çš„ \u003ccode\u003escript\u003c/code\u003e æ ‡ç­¾æ˜¯ç”± webpack æ‰“åŒ…è¿›å»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨ \u003ccode\u003escript-ext-html-webpack-plugin\u003c/code\u003e å°† \u003ccode\u003eonerror\u003c/code\u003e äº‹ä»¶å’Œ \u003ccode\u003eonsuccess\u003c/code\u003e äº‹ä»¶æ³¨å…¥è¿›å»ï¼š\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eScriptExtHtmlWebpackPlugin\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;script-ext-html-webpack-plugin\u0026#x27;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = {\n  \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eplugins\u003c/span\u003e: [\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHtmlWebpackPlugin\u003c/span\u003e(),\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSriPlugin\u003c/span\u003e({\n      \u003cspan class=\"hljs-attr\"\u003ehashFuncNames\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;sha256\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;sha384\u0026#x27;\u003c/span\u003e],\n    }),\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eScriptExtHtmlWebpackPlugin\u003c/span\u003e({\n      \u003cspan class=\"hljs-attr\"\u003ecustom\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\/*_[A-Za-z0-9]{8}.js/\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eattribute\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;onerror\u0026#x27;\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;loadScriptError.call(this, event)\u0026#x27;\u003c/span\u003e,\n      },\n    }),\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eScriptExtHtmlWebpackPlugin\u003c/span\u003e({\n      \u003cspan class=\"hljs-attr\"\u003ecustom\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\/*_[A-Za-z0-9]{8}.js/\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eattribute\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;onsuccess\u0026#x27;\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;loadScriptSuccess.call(this, event)\u0026#x27;\u003c/span\u003e,\n      },\n    }),\n  ],\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eç„¶åå°† \u003ccode\u003eloadScriptError\u003c/code\u003e å’Œ \u003ccode\u003eloadScriptSuccess\u003c/code\u003e ä¸¤ä¸ªæ–¹æ³•æ³¨å…¥åˆ° HTML ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ \u003ccode\u003einline\u003c/code\u003e çš„æ–¹å¼ã€‚\u003c/p\u003e\n\u003ch2\u003eCDN åŠ«æŒ\u003c/h2\u003e\n\u003cp\u003eå‰é¢è¯´åˆ° script åŠ è½½å¤±è´¥å¯èƒ½æ˜¯ç”±äºå¤šç§åŸå› é€ æˆçš„ï¼Œé‚£å¦‚ä½•æ˜¯å¦åˆ¤æ–­å‘ç”Ÿäº† CDN åŠ«æŒå‘¢ï¼Ÿ\u003c/p\u003e\n\u003cp\u003eæ–¹æ³•å°±æ˜¯å†è¯·æ±‚ä¸€æ¬¡æ•°æ®ï¼Œæ¯”è¾ƒä¸¤æ¬¡å¾—åˆ°æ–‡ä»¶çš„å†…å®¹ï¼ˆå½“ç„¶ä¸å¿…å…¨éƒ¨æ¯”è¾ƒï¼‰ï¼Œå¦‚æœå†…å®¹ä¸ä¸€è‡´ï¼Œå°±å¯ä»¥å¾—å‡ºç»“è®ºäº†ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eloadScript\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eurl\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(url)\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eres\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.\u003cspan class=\"hljs-property\"\u003eok\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res;\n      }\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ereject\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e());\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eres\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003etext\u003c/span\u003e();\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e;\n    });\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eæ¯”è¾ƒä¸¤æ¬¡åŠ è½½çš„ \u003ccode\u003escript\u003c/code\u003e æ˜¯å¦ç›¸åŒ\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003echeckScriptDiff\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003esrc, srcNew\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eall\u003c/span\u003e([\u003cspan class=\"hljs-title function_\"\u003eloadScript\u003c/span\u003e(src), \u003cspan class=\"hljs-title function_\"\u003eloadScript\u003c/span\u003e(srcNew)])\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e res1 = data[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eslice\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e res2 = data[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eslice\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!!res1 \u0026amp;\u0026amp; !!res2 \u0026amp;\u0026amp; res1 !== res2) {\n        \u003cspan class=\"hljs-comment\"\u003e// CDNåŠ«æŒäº‹ä»¶å‘ç”Ÿ\u003c/span\u003e\n      }\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n    });\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eè¿™é‡Œä¸ºä»€ä¹ˆåªæ¯”è¾ƒå‰ 1000 ä¸ªå­—ç¬¦ï¼Ÿå› ä¸ºé€šå¸¸ CDN åŠ«æŒè€…ä¼šåœ¨ js æ–‡ä»¶æœ€å‰é¢æ³¨å…¥ä¸€äº›ä»£ç æ¥è¾¾åˆ°ä»–ä»¬çš„ç›®çš„ï¼Œæ³¨å…¥ä¸­é—´ä»£ç éœ€è¦ AST è§£æï¼Œæˆæœ¬è¾ƒé«˜ï¼Œæ‰€ä»¥æ¯”è¾ƒå…¨éƒ¨å­—ç¬¦ä¸²æ²¡æœ‰æ„ä¹‰ã€‚å¦‚æœä½ è¿˜æ˜¯æœ‰é¡¾è™‘çš„è¯ï¼Œå¯ä»¥åŠ ä¸Šå n ä¸ªå­—ç¬¦çš„æ¯”è¾ƒã€‚\u003c/p\u003e\n\u003ch2\u003eå‚è€ƒèµ„æ–™\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“– MDNï¼šSubresource Integrity\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/entry/5a559dd36fb9a01c9e45d896\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ å¸¸è§ Web å®‰å…¨æ”»é˜²æ€»ç»“\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/entry/5bcec8e2518825102423e391\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ æµ…è°ˆæµé‡åŠ«æŒä¸é˜²æ²»\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/post/5c355a816fb9a049a42f3ac8\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ è…¾è®¯ IVWEB å›¢é˜Ÿï¼šä½¿ç”¨ SRI è§£å†³ CDN åŠ«æŒ\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.zhihu.com/question/35720092\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ åº”å¯¹æµé‡åŠ«æŒï¼Œå‰ç«¯èƒ½åšå“ªäº›å·¥ä½œï¼Ÿ\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://js8.in/2017/08/04/Web%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%8A%AB%E6%8C%81%E5%92%8C%E5%8F%8D%E5%8A%AB%E6%8C%81/#more\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ Web å‰ç«¯é¡µé¢åŠ«æŒå’ŒååŠ«æŒ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"markdown-body\",\"children\":[\"$\",\"article\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$c\"}}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"front-end\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"front-end knowledge\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>