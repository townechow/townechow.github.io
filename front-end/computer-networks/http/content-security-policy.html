<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/d498c84e4ab246b3.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/485ff6fe79292a08.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b9d97b2190475167.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/851cdee6d90716dd.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-78112f590b744806.js"/><script src="/_next/static/chunks/4bd1b696-20882bf820444624.js" async=""></script><script src="/_next/static/chunks/517-98ed787e5f259f2c.js" async=""></script><script src="/_next/static/chunks/main-app-f33d3e3aed85e21f.js" async=""></script><meta name="next-size-adjust" content=""/><title>front-end</title><meta name="description" content="front-end knowledge"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_4d318d __variable_ea5f4b antialiased"><main><div class="markdown-body"><article><h1>HTTP CSP å†…å®¹å®‰å…¨ç­–ç•¥</h1>
<p>å†…å®¹å®‰å…¨ç­–ç•¥ (CSP) æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚</p>
<p>CSP æ˜¯ä¸€ç§ç”±å¼€å‘è€…å®šä¹‰çš„å®‰å…¨æ€§æ”¿ç­–æ€§ç”³æ˜ï¼Œé€šè¿‡ CSP æ‰€çº¦æŸçš„è§„åˆ™æŒ‡å®šå¯ä¿¡çš„å†…å®¹æ¥æºï¼ˆè¿™é‡Œçš„å†…å®¹å¯ä»¥æŒ‡è„šæœ¬ã€å›¾ç‰‡ã€<code>iframe</code>ã€<code>font</code>ã€<code>style</code> ç­‰ç­‰å¯èƒ½çš„è¿œç¨‹çš„èµ„æºï¼‰ã€‚é€šè¿‡ CSP åå®šï¼Œè®© Web å¤„äºä¸€ä¸ªå®‰å…¨çš„è¿è¡Œç¯å¢ƒä¸­ã€‚</p>
<p>ä¸ºä½¿ CSP å¯ç”¨ï¼Œéœ€è¦é…ç½®ç½‘ç»œæœåŠ¡å™¨è¿”å› <code>Content-Security-Policy</code> HTTP å¤´éƒ¨ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>&lt;meta&gt;</code> å…ƒç´ ä¹Ÿå¯ä»¥ç”¨äºé…ç½®è¯¥ç­–ç•¥ï¼š</p>
<pre class="hljs language-html"  style=--lang:"html" ><code><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Security-Policy&quot;</span> /&gt;</span>
</code></pre>
<h2>æŒ‡ä»¤é€‰é¡¹</h2>
<h3>èµ„æºåŠ è½½æŒ‡ä»¤</h3>
<p>é€šè¿‡è·å–æŒ‡ä»¤æ¥æ§åˆ¶æŸäº›å¯èƒ½è¢«åŠ è½½çš„ç¡®åˆ‡çš„èµ„æºç±»å‹çš„ä½ç½®ï¼š</p>
<p>CSP ç­–ç•¥åœ¨é»˜è®¤çš„æƒ…å†µä¸‹æ˜¯ä¸å…è®¸ä½¿ç”¨ <code>data URIs</code> èµ„æºçš„ï¼Œå¦‚æœè¦ä½¿ç”¨ï¼Œé‚£ä¹ˆéœ€è¦æ˜¾ç¤ºçš„æŒ‡å®šï¼š</p>
<ul>
<li><code>script-src</code>ï¼šåœ¨å¤„ç†è„šæœ¬èµ„æºçš„æ—¶å€™è®¾ç½® <code>unsafe-inline</code> å¯ä»¥é˜»æ­¢å†…è” Js ä»£ç çš„æ‰§è¡Œï¼Œä½¿ç”¨ <code>unsafe-eval</code> å¼€å…³å¯ä»¥ç¦æ­¢ <code>eval</code>ã€<code>setTimeout</code>ã€<code>setInterval</code> å‡½æ•°çš„æ‰§è¡Œ</li>
<li><code>style-src</code>ï¼šä¼šæ§åˆ¶æ ·å¼è¡¨@import å’Œ rel æ—¶æ‰€å¼•å…¥çš„ URI èµ„æºï¼Œè®¾ç½® unsafe-inline è§„åˆ™å¯ä»¥æ˜¯æµè§ˆå™¨æ‹’ç»è§£æå†…éƒ¨æ ·å¼å’Œå†…è”æ ·å¼å®šä¹‰ã€‚å¹¶ä¸ä¼šé˜»æ­¢é“¾å…¥å¤–éƒ¨æ ·å¼è¡¨ã€‚</li>
<li><code>img-src</code>ï¼šå¯ä»¥æ§åˆ¶å›¾ç‰‡èµ„æºçš„è¿æ¥ï¼ŒåŒ…æ‹¬ <code>img</code> æ ‡ç­¾çš„ <code>src</code> å±æ€§ï¼Œä»¥åŠ CSS3 ä¸­çš„ <code>url()</code> å’Œ <code>image()</code> æ–¹æ³•ï¼Œä»¥åŠ <code>link</code> æ ‡ç­¾ä¸­çš„ <code>href</code> å±æ€§ï¼ˆå½“ <code>rel</code> è®¾ç½®æˆä¸å›¾åƒç›¸å…³çš„å€¼ï¼Œæ¯”å¦‚ HTML æ”¯æŒçš„ iconï¼‰</li>
<li><code>font-src</code>ï¼šæ§åˆ¶ CSS ä¸­çš„ <code>@font-face</code> åŠ è½½çš„å­—ä½“æºåœ°å€</li>
<li><code>frame-src</code>ï¼šè®¾ç½®å…è®¸é€šè¿‡ç±»ä¼¼ <code>&lt;frame&gt;</code> å’Œ <code>&lt;iframe&gt;</code> æ ‡ç­¾åŠ è½½çš„å†…åµŒå†…å®¹çš„æºåœ°å€</li>
<li><code>manifest-src</code>ï¼šé™åˆ¶åº”ç”¨å£°æ˜æ–‡ä»¶çš„æºåœ°å€</li>
<li><code>media-src</code>ï¼šæ§åˆ¶åª’ä½“ç±»å‹çš„å¤–éƒ¨é“¾å…¥èµ„æºï¼Œå¦‚ <code>&lt;audio&gt;</code>ã€<code>&lt;video&gt;</code>ã€<code>&lt;source&gt;</code> å’Œ <code>&lt;track&gt;</code> æ ‡ç­¾çš„ <code>src</code> å±æ€§</li>
<li><code>object-src</code>ï¼šæ§åˆ¶ <code>&lt;embed&gt;</code>ã€<code>&lt;code&gt;</code>ã€<code>&lt;archive&gt;</code>ã€<code>&lt;applet&gt;</code> ç­‰å¯¹è±¡</li>
<li><code>prefetch-src</code>ï¼šæŒ‡å®šé¢„åŠ è½½æˆ–é¢„æ¸²æŸ“çš„å…è®¸æºåœ°å€</li>
<li><code>connect-src</code>ï¼šæ§åˆ¶ XMLHttpRequest ä¸­çš„ <code>open()</code>ã€WebSocketã€EventSource</li>
</ul>
<p>å¦å¤– <code>inline script</code> å’Œ <code>eval</code> ç±»å‹å‡½æ•°ï¼ˆåŒ…æ‹¬ <code>eval</code>ã€<code>setInterval</code>ã€<code>setTimeout</code> å’Œ <code>new Function()</code>ï¼‰ä¹Ÿæ˜¯ä¸è¢«æ‰§è¡Œçš„ã€‚</p>
<h3>default-src</h3>
<p><code>default-src</code> ç”¨äºè®¾ç½®ä¸Šé¢å„ä¸ªé€‰é¡¹çš„é»˜è®¤å€¼ã€‚</p>
<pre class="hljs language-http"  style=--lang:"http" ><code><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>default-src &#x27;self&#x27;
</code></pre>
<p>ä¸Šé¢ä»£ç é™åˆ¶æ‰€æœ‰å¤–éƒ¨èµ„æºï¼Œåªèƒ½ä»å½“å‰æ¸”æ°‘è¯¥åŠ è½½ã€‚</p>
<p>å¦‚æœåŒæ—¶è®¾ç½®æŸä¸ªå•é¡¹é™åˆ¶ï¼ˆæ¯”å¦‚ <code>font-src</code>ï¼‰å’Œ <code>default-src</code>ï¼Œå‰è€…ä¼šè¦†ç›–åè€…ï¼Œå³å­—ä½“æ–‡ä»¶ä¼šé‡‡ç”¨ <code>font-src</code> çš„å€¼ï¼Œå…¶ä»–èµ„æºä¾ç„¶é‡‡ç”¨ <code>default-src</code> çš„å€¼ã€‚</p>
<h3>å…¶ä»–é™åˆ¶</h3>
<p>å…¶ä»–ä¸€äº›å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œä¹Ÿæ”¾åœ¨äº† CSP é‡Œé¢ï¼š</p>
<ul>
<li><code>block-all-mixed-content</code>ï¼šHTTPS ç½‘é¡µä¸å¾—åŠ è½½ HTTP èµ„æºï¼ˆæµè§ˆå™¨å·²ç»é»˜è®¤å¼€å¯ï¼‰</li>
<li><code>upgrade-insecure-requests</code>ï¼šè‡ªåŠ¨å°†ç½‘é¡µä¸Šæ‰€æœ‰åŠ è½½å¤–éƒ¨èµ„æºçš„ HTTP é“¾æ¥æ¢æˆ HTTPS åè®®</li>
<li><code>plugin-types</code>ï¼šé™åˆ¶å¯ä»¥ä½¿ç”¨çš„æ’ä»¶æ ¼å¼</li>
<li><code>sandbox</code>ï¼šæµè§ˆå™¨è¡Œä¸ºçš„é™åˆ¶ï¼Œæ¯”å¦‚ä¸èƒ½æœ‰å¼¹å‡ºçª—å£ç­‰ã€‚</li>
</ul>
<h3>report-uri</h3>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸ä»…å¸Œæœ›é˜²æ­¢ XSSï¼Œè¿˜å¸Œæœ›è®°å½•æ­¤ç±»è¡Œä¸ºã€‚<code>report-uri</code> å°±ç”¨æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œåº”è¯¥æŠŠæ³¨å…¥è¡Œä¸ºæŠ¥å‘Šç»™å“ªä¸ªç½‘å€ã€‚</p>
<pre class="hljs language-http"  style=--lang:"http" ><code><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>default-src &#x27;self&#x27;; ...; report-uri /my_amazing_csp_report_parser;
</code></pre>
<p>ä¸Šé¢ä»£ç æŒ‡å®šï¼Œå°†æ³¨å…¥è¡Œä¸ºæŠ¥å‘Šç»™ <code>/my_amazing_csp_report_parser</code> è¿™ä¸ª URLã€‚</p>
<p>æµè§ˆå™¨ä¼šä½¿ç”¨ <code>POST</code> æ–¹æ³•ï¼Œå‘é€ä¸€ä¸ª <code>JSON</code> å¯¹è±¡ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<pre class="hljs language-json"  style=--lang:"json" ><code><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;csp-report&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;document-uri&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://example.org/page.html&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;referrer&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://evil.example.com/&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;blocked-uri&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://evil.example.com/evil.js&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;violated-directive&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;script-src &#x27;self&#x27; https://apis.google.com&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;original-policy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;script-src &#x27;self&#x27; https://apis.google.com; report-uri http://example.org/my_amazing_csp_report_parser&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2>é€‰é¡¹å€¼</h2>
<p>æ¯ä¸ªé™åˆ¶é€‰é¡¹å¯ä»¥è®¾ç½®ä»¥ä¸‹å‡ ç§å€¼ï¼Œè¿™äº›å€¼å°±æ„æˆäº†ç™½åå•ã€‚</p>
<ul>
<li><strong>ä¸»æœºå</strong>ï¼š<code>example.org</code>ã€<code>https://example.com:443</code></li>
<li><strong>è·¯å¾„å</strong>ï¼š<code>example.org/resources/js/</code></li>
<li><strong>é€šé…ç¬¦</strong>ï¼š<code>*.example.org</code>ã€<code>*://*.example.com:*</code>ï¼ˆè¡¨ç¤ºä»»æ„åè®®ã€ä»»æ„å­åŸŸåã€ä»»æ„ç«¯å£ï¼‰</li>
<li><strong>åè®®å</strong>ï¼š<code>https:</code>ã€<code>data:</code></li>
<li><strong>å…³é”®å­— <code>'self'</code></strong>ï¼šå½“å‰åŸŸåï¼Œéœ€è¦åŠ å¼•å·</li>
<li><strong>å…³é”®å­— <code>'none'</code></strong>ï¼šç¦æ­¢åŠ è½½ä»»ä½•å¤–éƒ¨èµ„æºï¼Œéœ€è¦åŠ å¼•å·</li>
</ul>
<p>å¤šä¸ªå€¼ä¹Ÿå¯ä»¥å¹¶åˆ—ï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚</p>
<pre class="hljs language-http"  style=--lang:"http" ><code><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>script-src &#x27;self&#x27; https://apis.google.com
</code></pre>
<p>å¦‚æœåŒä¸€ä¸ªé™åˆ¶é€‰é¡¹ä½¿ç”¨å¤šæ¬¡ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ä¼šç”Ÿæ•ˆã€‚</p>
<pre class="hljs language-http"  style=--lang:"http" ><code># é”™è¯¯çš„å†™æ³•
<span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>script-src https://host1.com; script-src https://host2.com

# æ­£ç¡®çš„å†™æ³•
<span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>script-src https://host1.com https://host2.com
</code></pre>
<h2>script-src çš„ç‰¹æ®Šå€¼</h2>
<p>é™¤äº†å¸¸è§„å€¼ï¼Œ<code>script-src</code> è¿˜å¯ä»¥è®¾ç½®ä¸€äº›ç‰¹æ®Šå€¼ã€‚æ³¨æ„ï¼Œä¸‹é¢è¿™äº›å€¼éƒ½å¿…é¡»æ”¾åœ¨å•å¼•å·é‡Œé¢ã€‚</p>
<ul>
<li><code>unsafe-inline</code>ï¼šå…è®¸æ‰§è¡Œé¡µé¢å†…åµŒçš„ <code>&amp;lt;script&gt;</code> æ ‡ç­¾å’Œäº‹ä»¶ç›‘å¬å‡½æ•°</li>
<li><code>unsafe-eval</code>ï¼šå…è®¸å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ‰§è¡Œï¼Œæ¯”å¦‚ä½¿ç”¨ <code>eval</code>ã€<code>setTimeout</code>ã€<code>setInterval</code> å’Œ <code>Function</code> ç­‰å‡½æ•°ã€‚</li>
<li><code>nonce</code> å€¼ï¼šæ¯æ¬¡ HTTP å›åº”ç»™å‡ºä¸€ä¸ªæˆæƒ tokenï¼Œé¡µé¢å†…åµŒè„šæœ¬å¿…é¡»æœ‰è¿™ä¸ª tokenï¼Œæ‰ä¼šæ‰§è¡Œ</li>
<li><code>hash</code> å€¼ï¼šåˆ—å‡ºå…è®¸æ‰§è¡Œçš„è„šæœ¬ä»£ç çš„ Hash å€¼ï¼Œé¡µé¢å†…åµŒè„šæœ¬çš„å“ˆå¸Œå€¼åªæœ‰å»åˆçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½æ‰§è¡Œã€‚</li>
</ul>
<p><code>nonce</code> å€¼çš„ä¾‹å­å¦‚ä¸‹ï¼ŒæœåŠ¡å™¨å‘é€ç½‘é¡µçš„æ—¶å€™ï¼Œå‘Šè¯‰æµè§ˆå™¨ä¸€ä¸ªéšæœºç”Ÿæˆçš„ <code>token</code>ã€‚</p>
<pre class="hljs language-http"  style=--lang:"http" ><code><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>script-src &#x27;nonce-EDNnf03nceIOfn39fn3e9h3sdfa&#x27;
</code></pre>
<p>é¡µé¢å†…åµŒè„šæœ¬ï¼Œå¿…é¡»æœ‰è¿™ä¸ª token æ‰èƒ½æ‰§è¡Œã€‚</p>
<pre class="hljs language-html"  style=--lang:"html" ><code><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">nonce</span>=<span class="hljs-string">&quot;EDNnf03nceIOfn39fn3e9h3sdfa&quot;</span>&gt;</span><span class="language-javascript">
  <span class="hljs-comment">// some code</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><code>hash</code> å€¼çš„ä¾‹å­å¦‚ä¸‹ï¼ŒæœåŠ¡å™¨ç»™å‡ºä¸€ä¸ªå…è®¸æ‰§è¡Œçš„ä»£ç çš„ <code>hash</code> å€¼ã€‚</p>
<pre class="hljs language-http"  style=--lang:"http" ><code><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>script-src &#x27;sha256-qznLcsROx4GACP2dm0UCKCzCG-HiZ1guq6ZZDob_Tng=&#x27;
</code></pre>
<p>ä¸‹é¢çš„ä»£ç å°±ä¼šå…è®¸æ‰§è¡Œï¼Œå› ä¸º hash å€¼ç›¸ç¬¦ã€‚</p>
<pre class="hljs language-html"  style=--lang:"html" ><code><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript">
  <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Hello, world.&#x27;</span>);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æ³¨æ„ï¼Œè®¡ç®— <code>hash</code> å€¼çš„æ—¶å€™ï¼Œ<code>&lt;script&gt;</code> æ ‡ç­¾ä¸ç®—åœ¨å†…ã€‚</p>
<p>é™¤äº† <code>script-src</code> é€‰é¡¹ï¼Œ<code>nonce</code> å€¼å’Œ <code>hash</code> å€¼è¿˜å¯ä»¥ç”¨åœ¨ <code>style-src</code> é€‰é¡¹ï¼Œæ§åˆ¶é¡µé¢å†…åµŒçš„æ ·å¼è¡¨ã€‚</p>
<h2>å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP" target="_blank" rel="noopener noreferrer nofollow">ğŸ“– å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ Content Security Policy å…¥é—¨æ•™ç¨‹</a></li>
<li><a href="https://www.zhihu.com/question/21979782" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ Content Security Policyï¼ˆCSPï¼‰æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå®ƒèƒ½æŠµå¾¡ XSS æ”»å‡»ï¼Ÿ</a></li>
</ul>
</article></div></main><script src="/_next/static/chunks/webpack-78112f590b744806.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n7:I[6213,[],\"MetadataBoundary\"]\n9:I[6213,[],\"ViewportBoundary\"]\nb:I[4835,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/d498c84e4ab246b3.css\",\"style\"]\n:HL[\"/_next/static/css/485ff6fe79292a08.css\",\"style\"]\n:HL[\"/_next/static/css/b9d97b2190475167.css\",\"style\"]\n:HL[\"/_next/static/css/851cdee6d90716dd.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"NFjmtHF2up8B2PpbDjLiS\",\"p\":\"\",\"c\":[\"\",\"front-end\",\"computer-networks\",\"http\",\"content-security-policy\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"front-end\",{\"children\":[[\"slug\",\"computer-networks/http/content-security-policy\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d498c84e4ab246b3.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/485ff6fe79292a08.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b9d97b2190475167.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_4d318d __variable_ea5f4b antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"front-end\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/851cdee6d90716dd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"slug\",\"computer-networks/http/content-security-policy\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":\"$L6\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"4B334iK8wLjXIeeIacG3u\",{\"children\":[[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$b\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:T2d36,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eHTTP CSP å†…å®¹å®‰å…¨ç­–ç•¥\u003c/h1\u003e\n\u003cp\u003eå†…å®¹å®‰å…¨ç­–ç•¥ (CSP) æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚\u003c/p\u003e\n\u003cp\u003eCSP æ˜¯ä¸€ç§ç”±å¼€å‘è€…å®šä¹‰çš„å®‰å…¨æ€§æ”¿ç­–æ€§ç”³æ˜ï¼Œé€šè¿‡ CSP æ‰€çº¦æŸçš„è§„åˆ™æŒ‡å®šå¯ä¿¡çš„å†…å®¹æ¥æºï¼ˆè¿™é‡Œçš„å†…å®¹å¯ä»¥æŒ‡è„šæœ¬ã€å›¾ç‰‡ã€\u003ccode\u003eiframe\u003c/code\u003eã€\u003ccode\u003efont\u003c/code\u003eã€\u003ccode\u003estyle\u003c/code\u003e ç­‰ç­‰å¯èƒ½çš„è¿œç¨‹çš„èµ„æºï¼‰ã€‚é€šè¿‡ CSP åå®šï¼Œè®© Web å¤„äºä¸€ä¸ªå®‰å…¨çš„è¿è¡Œç¯å¢ƒä¸­ã€‚\u003c/p\u003e\n\u003cp\u003eä¸ºä½¿ CSP å¯ç”¨ï¼Œéœ€è¦é…ç½®ç½‘ç»œæœåŠ¡å™¨è¿”å› \u003ccode\u003eContent-Security-Policy\u003c/code\u003e HTTP å¤´éƒ¨ã€‚\u003c/p\u003e\n\u003cp\u003eé™¤æ­¤ä¹‹å¤–ï¼Œ\u003ccode\u003e\u0026lt;meta\u0026gt;\u003c/code\u003e å…ƒç´ ä¹Ÿå¯ä»¥ç”¨äºé…ç½®è¯¥ç­–ç•¥ï¼š\u003c/p\u003e\n\u003cpre class=\"hljs language-html\"  style=--lang:\"html\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehttp-equiv\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;Content-Security-Policy\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eæŒ‡ä»¤é€‰é¡¹\u003c/h2\u003e\n\u003ch3\u003eèµ„æºåŠ è½½æŒ‡ä»¤\u003c/h3\u003e\n\u003cp\u003eé€šè¿‡è·å–æŒ‡ä»¤æ¥æ§åˆ¶æŸäº›å¯èƒ½è¢«åŠ è½½çš„ç¡®åˆ‡çš„èµ„æºç±»å‹çš„ä½ç½®ï¼š\u003c/p\u003e\n\u003cp\u003eCSP ç­–ç•¥åœ¨é»˜è®¤çš„æƒ…å†µä¸‹æ˜¯ä¸å…è®¸ä½¿ç”¨ \u003ccode\u003edata URIs\u003c/code\u003e èµ„æºçš„ï¼Œå¦‚æœè¦ä½¿ç”¨ï¼Œé‚£ä¹ˆéœ€è¦æ˜¾ç¤ºçš„æŒ‡å®šï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003escript-src\u003c/code\u003eï¼šåœ¨å¤„ç†è„šæœ¬èµ„æºçš„æ—¶å€™è®¾ç½® \u003ccode\u003eunsafe-inline\u003c/code\u003e å¯ä»¥é˜»æ­¢å†…è” Js ä»£ç çš„æ‰§è¡Œï¼Œä½¿ç”¨ \u003ccode\u003eunsafe-eval\u003c/code\u003e å¼€å…³å¯ä»¥ç¦æ­¢ \u003ccode\u003eeval\u003c/code\u003eã€\u003ccode\u003esetTimeout\u003c/code\u003eã€\u003ccode\u003esetInterval\u003c/code\u003e å‡½æ•°çš„æ‰§è¡Œ\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003estyle-src\u003c/code\u003eï¼šä¼šæ§åˆ¶æ ·å¼è¡¨@import å’Œ rel æ—¶æ‰€å¼•å…¥çš„ URI èµ„æºï¼Œè®¾ç½® unsafe-inline è§„åˆ™å¯ä»¥æ˜¯æµè§ˆå™¨æ‹’ç»è§£æå†…éƒ¨æ ·å¼å’Œå†…è”æ ·å¼å®šä¹‰ã€‚å¹¶ä¸ä¼šé˜»æ­¢é“¾å…¥å¤–éƒ¨æ ·å¼è¡¨ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eimg-src\u003c/code\u003eï¼šå¯ä»¥æ§åˆ¶å›¾ç‰‡èµ„æºçš„è¿æ¥ï¼ŒåŒ…æ‹¬ \u003ccode\u003eimg\u003c/code\u003e æ ‡ç­¾çš„ \u003ccode\u003esrc\u003c/code\u003e å±æ€§ï¼Œä»¥åŠ CSS3 ä¸­çš„ \u003ccode\u003eurl()\u003c/code\u003e å’Œ \u003ccode\u003eimage()\u003c/code\u003e æ–¹æ³•ï¼Œä»¥åŠ \u003ccode\u003elink\u003c/code\u003e æ ‡ç­¾ä¸­çš„ \u003ccode\u003ehref\u003c/code\u003e å±æ€§ï¼ˆå½“ \u003ccode\u003erel\u003c/code\u003e è®¾ç½®æˆä¸å›¾åƒç›¸å…³çš„å€¼ï¼Œæ¯”å¦‚ HTML æ”¯æŒçš„ iconï¼‰\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efont-src\u003c/code\u003eï¼šæ§åˆ¶ CSS ä¸­çš„ \u003ccode\u003e@font-face\u003c/code\u003e åŠ è½½çš„å­—ä½“æºåœ°å€\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eframe-src\u003c/code\u003eï¼šè®¾ç½®å…è®¸é€šè¿‡ç±»ä¼¼ \u003ccode\u003e\u0026lt;frame\u0026gt;\u003c/code\u003e å’Œ \u003ccode\u003e\u0026lt;iframe\u0026gt;\u003c/code\u003e æ ‡ç­¾åŠ è½½çš„å†…åµŒå†…å®¹çš„æºåœ°å€\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emanifest-src\u003c/code\u003eï¼šé™åˆ¶åº”ç”¨å£°æ˜æ–‡ä»¶çš„æºåœ°å€\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emedia-src\u003c/code\u003eï¼šæ§åˆ¶åª’ä½“ç±»å‹çš„å¤–éƒ¨é“¾å…¥èµ„æºï¼Œå¦‚ \u003ccode\u003e\u0026lt;audio\u0026gt;\u003c/code\u003eã€\u003ccode\u003e\u0026lt;video\u0026gt;\u003c/code\u003eã€\u003ccode\u003e\u0026lt;source\u0026gt;\u003c/code\u003e å’Œ \u003ccode\u003e\u0026lt;track\u0026gt;\u003c/code\u003e æ ‡ç­¾çš„ \u003ccode\u003esrc\u003c/code\u003e å±æ€§\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eobject-src\u003c/code\u003eï¼šæ§åˆ¶ \u003ccode\u003e\u0026lt;embed\u0026gt;\u003c/code\u003eã€\u003ccode\u003e\u0026lt;code\u0026gt;\u003c/code\u003eã€\u003ccode\u003e\u0026lt;archive\u0026gt;\u003c/code\u003eã€\u003ccode\u003e\u0026lt;applet\u0026gt;\u003c/code\u003e ç­‰å¯¹è±¡\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eprefetch-src\u003c/code\u003eï¼šæŒ‡å®šé¢„åŠ è½½æˆ–é¢„æ¸²æŸ“çš„å…è®¸æºåœ°å€\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econnect-src\u003c/code\u003eï¼šæ§åˆ¶ XMLHttpRequest ä¸­çš„ \u003ccode\u003eopen()\u003c/code\u003eã€WebSocketã€EventSource\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå¦å¤– \u003ccode\u003einline script\u003c/code\u003e å’Œ \u003ccode\u003eeval\u003c/code\u003e ç±»å‹å‡½æ•°ï¼ˆåŒ…æ‹¬ \u003ccode\u003eeval\u003c/code\u003eã€\u003ccode\u003esetInterval\u003c/code\u003eã€\u003ccode\u003esetTimeout\u003c/code\u003e å’Œ \u003ccode\u003enew Function()\u003c/code\u003eï¼‰ä¹Ÿæ˜¯ä¸è¢«æ‰§è¡Œçš„ã€‚\u003c/p\u003e\n\u003ch3\u003edefault-src\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003edefault-src\u003c/code\u003e ç”¨äºè®¾ç½®ä¸Šé¢å„ä¸ªé€‰é¡¹çš„é»˜è®¤å€¼ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-http\"  style=--lang:\"http\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003edefault-src \u0026#x27;self\u0026#x27;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eä¸Šé¢ä»£ç é™åˆ¶æ‰€æœ‰å¤–éƒ¨èµ„æºï¼Œåªèƒ½ä»å½“å‰æ¸”æ°‘è¯¥åŠ è½½ã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚æœåŒæ—¶è®¾ç½®æŸä¸ªå•é¡¹é™åˆ¶ï¼ˆæ¯”å¦‚ \u003ccode\u003efont-src\u003c/code\u003eï¼‰å’Œ \u003ccode\u003edefault-src\u003c/code\u003eï¼Œå‰è€…ä¼šè¦†ç›–åè€…ï¼Œå³å­—ä½“æ–‡ä»¶ä¼šé‡‡ç”¨ \u003ccode\u003efont-src\u003c/code\u003e çš„å€¼ï¼Œå…¶ä»–èµ„æºä¾ç„¶é‡‡ç”¨ \u003ccode\u003edefault-src\u003c/code\u003e çš„å€¼ã€‚\u003c/p\u003e\n\u003ch3\u003eå…¶ä»–é™åˆ¶\u003c/h3\u003e\n\u003cp\u003eå…¶ä»–ä¸€äº›å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œä¹Ÿæ”¾åœ¨äº† CSP é‡Œé¢ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eblock-all-mixed-content\u003c/code\u003eï¼šHTTPS ç½‘é¡µä¸å¾—åŠ è½½ HTTP èµ„æºï¼ˆæµè§ˆå™¨å·²ç»é»˜è®¤å¼€å¯ï¼‰\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eupgrade-insecure-requests\u003c/code\u003eï¼šè‡ªåŠ¨å°†ç½‘é¡µä¸Šæ‰€æœ‰åŠ è½½å¤–éƒ¨èµ„æºçš„ HTTP é“¾æ¥æ¢æˆ HTTPS åè®®\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eplugin-types\u003c/code\u003eï¼šé™åˆ¶å¯ä»¥ä½¿ç”¨çš„æ’ä»¶æ ¼å¼\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esandbox\u003c/code\u003eï¼šæµè§ˆå™¨è¡Œä¸ºçš„é™åˆ¶ï¼Œæ¯”å¦‚ä¸èƒ½æœ‰å¼¹å‡ºçª—å£ç­‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003ereport-uri\u003c/h3\u003e\n\u003cp\u003eæœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸ä»…å¸Œæœ›é˜²æ­¢ XSSï¼Œè¿˜å¸Œæœ›è®°å½•æ­¤ç±»è¡Œä¸ºã€‚\u003ccode\u003ereport-uri\u003c/code\u003e å°±ç”¨æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œåº”è¯¥æŠŠæ³¨å…¥è¡Œä¸ºæŠ¥å‘Šç»™å“ªä¸ªç½‘å€ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-http\"  style=--lang:\"http\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003edefault-src \u0026#x27;self\u0026#x27;; ...; report-uri /my_amazing_csp_report_parser;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eä¸Šé¢ä»£ç æŒ‡å®šï¼Œå°†æ³¨å…¥è¡Œä¸ºæŠ¥å‘Šç»™ \u003ccode\u003e/my_amazing_csp_report_parser\u003c/code\u003e è¿™ä¸ª URLã€‚\u003c/p\u003e\n\u003cp\u003eæµè§ˆå™¨ä¼šä½¿ç”¨ \u003ccode\u003ePOST\u003c/code\u003e æ–¹æ³•ï¼Œå‘é€ä¸€ä¸ª \u003ccode\u003eJSON\u003c/code\u003e å¯¹è±¡ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-json\"  style=--lang:\"json\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;csp-report\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;document-uri\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;http://example.org/page.html\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;referrer\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;http://evil.example.com/\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;blocked-uri\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;http://evil.example.com/evil.js\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;violated-directive\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;script-src \u0026#x27;self\u0026#x27; https://apis.google.com\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;original-policy\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;script-src \u0026#x27;self\u0026#x27; https://apis.google.com; report-uri http://example.org/my_amazing_csp_report_parser\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eé€‰é¡¹å€¼\u003c/h2\u003e\n\u003cp\u003eæ¯ä¸ªé™åˆ¶é€‰é¡¹å¯ä»¥è®¾ç½®ä»¥ä¸‹å‡ ç§å€¼ï¼Œè¿™äº›å€¼å°±æ„æˆäº†ç™½åå•ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eä¸»æœºå\u003c/strong\u003eï¼š\u003ccode\u003eexample.org\u003c/code\u003eã€\u003ccode\u003ehttps://example.com:443\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eè·¯å¾„å\u003c/strong\u003eï¼š\u003ccode\u003eexample.org/resources/js/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eé€šé…ç¬¦\u003c/strong\u003eï¼š\u003ccode\u003e*.example.org\u003c/code\u003eã€\u003ccode\u003e*://*.example.com:*\u003c/code\u003eï¼ˆè¡¨ç¤ºä»»æ„åè®®ã€ä»»æ„å­åŸŸåã€ä»»æ„ç«¯å£ï¼‰\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eåè®®å\u003c/strong\u003eï¼š\u003ccode\u003ehttps:\u003c/code\u003eã€\u003ccode\u003edata:\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå…³é”®å­— \u003ccode\u003e'self'\u003c/code\u003e\u003c/strong\u003eï¼šå½“å‰åŸŸåï¼Œéœ€è¦åŠ å¼•å·\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå…³é”®å­— \u003ccode\u003e'none'\u003c/code\u003e\u003c/strong\u003eï¼šç¦æ­¢åŠ è½½ä»»ä½•å¤–éƒ¨èµ„æºï¼Œéœ€è¦åŠ å¼•å·\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå¤šä¸ªå€¼ä¹Ÿå¯ä»¥å¹¶åˆ—ï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-http\"  style=--lang:\"http\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003escript-src \u0026#x27;self\u0026#x27; https://apis.google.com\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eå¦‚æœåŒä¸€ä¸ªé™åˆ¶é€‰é¡¹ä½¿ç”¨å¤šæ¬¡ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ä¼šç”Ÿæ•ˆã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-http\"  style=--lang:\"http\" \u003e\u003ccode\u003e# é”™è¯¯çš„å†™æ³•\n\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003escript-src https://host1.com; script-src https://host2.com\n\n# æ­£ç¡®çš„å†™æ³•\n\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003escript-src https://host1.com https://host2.com\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003escript-src çš„ç‰¹æ®Šå€¼\u003c/h2\u003e\n\u003cp\u003eé™¤äº†å¸¸è§„å€¼ï¼Œ\u003ccode\u003escript-src\u003c/code\u003e è¿˜å¯ä»¥è®¾ç½®ä¸€äº›ç‰¹æ®Šå€¼ã€‚æ³¨æ„ï¼Œä¸‹é¢è¿™äº›å€¼éƒ½å¿…é¡»æ”¾åœ¨å•å¼•å·é‡Œé¢ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eunsafe-inline\u003c/code\u003eï¼šå…è®¸æ‰§è¡Œé¡µé¢å†…åµŒçš„ \u003ccode\u003e\u0026amp;lt;script\u0026gt;\u003c/code\u003e æ ‡ç­¾å’Œäº‹ä»¶ç›‘å¬å‡½æ•°\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eunsafe-eval\u003c/code\u003eï¼šå…è®¸å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ‰§è¡Œï¼Œæ¯”å¦‚ä½¿ç”¨ \u003ccode\u003eeval\u003c/code\u003eã€\u003ccode\u003esetTimeout\u003c/code\u003eã€\u003ccode\u003esetInterval\u003c/code\u003e å’Œ \u003ccode\u003eFunction\u003c/code\u003e ç­‰å‡½æ•°ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enonce\u003c/code\u003e å€¼ï¼šæ¯æ¬¡ HTTP å›åº”ç»™å‡ºä¸€ä¸ªæˆæƒ tokenï¼Œé¡µé¢å†…åµŒè„šæœ¬å¿…é¡»æœ‰è¿™ä¸ª tokenï¼Œæ‰ä¼šæ‰§è¡Œ\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehash\u003c/code\u003e å€¼ï¼šåˆ—å‡ºå…è®¸æ‰§è¡Œçš„è„šæœ¬ä»£ç çš„ Hash å€¼ï¼Œé¡µé¢å†…åµŒè„šæœ¬çš„å“ˆå¸Œå€¼åªæœ‰å»åˆçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½æ‰§è¡Œã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003enonce\u003c/code\u003e å€¼çš„ä¾‹å­å¦‚ä¸‹ï¼ŒæœåŠ¡å™¨å‘é€ç½‘é¡µçš„æ—¶å€™ï¼Œå‘Šè¯‰æµè§ˆå™¨ä¸€ä¸ªéšæœºç”Ÿæˆçš„ \u003ccode\u003etoken\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-http\"  style=--lang:\"http\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003escript-src \u0026#x27;nonce-EDNnf03nceIOfn39fn3e9h3sdfa\u0026#x27;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eé¡µé¢å†…åµŒè„šæœ¬ï¼Œå¿…é¡»æœ‰è¿™ä¸ª token æ‰èƒ½æ‰§è¡Œã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-html\"  style=--lang:\"html\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003enonce\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;EDNnf03nceIOfn39fn3e9h3sdfa\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// some code\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ehash\u003c/code\u003e å€¼çš„ä¾‹å­å¦‚ä¸‹ï¼ŒæœåŠ¡å™¨ç»™å‡ºä¸€ä¸ªå…è®¸æ‰§è¡Œçš„ä»£ç çš„ \u003ccode\u003ehash\u003c/code\u003e å€¼ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-http\"  style=--lang:\"http\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-attribute\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e: \u003c/span\u003escript-src \u0026#x27;sha256-qznLcsROx4GACP2dm0UCKCzCG-HiZ1guq6ZZDob_Tng=\u0026#x27;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eä¸‹é¢çš„ä»£ç å°±ä¼šå…è®¸æ‰§è¡Œï¼Œå› ä¸º hash å€¼ç›¸ç¬¦ã€‚\u003c/p\u003e\n\u003cpre class=\"hljs language-html\"  style=--lang:\"html\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/javascript\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\n  \u003cspan class=\"hljs-title function_\"\u003ealert\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Hello, world.\u0026#x27;\u003c/span\u003e);\n\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eæ³¨æ„ï¼Œè®¡ç®— \u003ccode\u003ehash\u003c/code\u003e å€¼çš„æ—¶å€™ï¼Œ\u003ccode\u003e\u0026lt;script\u0026gt;\u003c/code\u003e æ ‡ç­¾ä¸ç®—åœ¨å†…ã€‚\u003c/p\u003e\n\u003cp\u003eé™¤äº† \u003ccode\u003escript-src\u003c/code\u003e é€‰é¡¹ï¼Œ\u003ccode\u003enonce\u003c/code\u003e å€¼å’Œ \u003ccode\u003ehash\u003c/code\u003e å€¼è¿˜å¯ä»¥ç”¨åœ¨ \u003ccode\u003estyle-src\u003c/code\u003e é€‰é¡¹ï¼Œæ§åˆ¶é¡µé¢å†…åµŒçš„æ ·å¼è¡¨ã€‚\u003c/p\u003e\n\u003ch2\u003eå‚è€ƒèµ„æ–™\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“– å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.ruanyifeng.com/blog/2016/09/csp.html\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ Content Security Policy å…¥é—¨æ•™ç¨‹\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.zhihu.com/question/21979782\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eğŸ“ Content Security Policyï¼ˆCSPï¼‰æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå®ƒèƒ½æŠµå¾¡ XSS æ”»å‡»ï¼Ÿ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"markdown-body\",\"children\":[\"$\",\"article\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$c\"}}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"front-end\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"front-end knowledge\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>