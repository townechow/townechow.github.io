1:"$Sreact.fragment"
2:I[5244,[],""]
3:I[3866,[],""]
5:I[6213,[],"OutletBoundary"]
7:I[6213,[],"MetadataBoundary"]
9:I[6213,[],"ViewportBoundary"]
b:I[4835,[],""]
:HL["/_next/static/media/569ce4b8f30dc480-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/ec0a9d078e716e00.css","style"]
:HL["/_next/static/css/485ff6fe79292a08.css","style"]
:HL["/_next/static/css/0ff121a467c0636f.css","style"]
0:{"P":null,"b":"NW9bMA21iAaih0TqCHqj1","p":"","c":["","front-end","computer-networks","http","http2"],"i":false,"f":[[["",{"children":["front-end",{"children":[["slug","computer-networks/http/http2","oc"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/ec0a9d078e716e00.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__variable_4d318d __variable_ea5f4b antialiased","children":["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]]}],{"children":["front-end",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/485ff6fe79292a08.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/0ff121a467c0636f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","main",null,{"children":["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","front-end","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]}]]}],{"children":[["slug","computer-networks/http/http2","oc"],["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","front-end","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L4",null,["$","$L5",null,{"children":"$L6"}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","NZq2dYHuN-Y5ru69HFN6q",{"children":[["$","$L7",null,{"children":"$L8"}],["$","$L9",null,{"children":"$La"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}]]}],false]],"m":"$undefined","G":["$b","$undefined"],"s":false,"S":true}
c:T5cb7,<h1>HTTP2</h1>
<p>HTTP/2ï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ç¬¬ 2 ç‰ˆï¼Œæœ€åˆå‘½åä¸º HTTP 2.0ï¼‰ï¼Œç®€ç§°ä¸º h2ï¼ˆåŸºäº TLS/1.2 æˆ–ä»¥ä¸Šç‰ˆæœ¬çš„åŠ å¯†è¿æ¥ï¼‰æˆ– h2cï¼ˆéåŠ å¯†è¿æ¥ï¼‰ï¼Œæ˜¯ HTTP åè®®çš„çš„ç¬¬äºŒä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œä½¿ç”¨äºä¸‡ç»´ç½‘ã€‚</p>
<h2>æ—§ç‰ˆæœ¬é—®é¢˜</h2>
<ol>
<li><strong>å¤šä¸ª TCP è¿æ¥</strong>ï¼šè™½ç„¶ HTTP/1.1 ç®¡çº¿åŒ–å¯ä»¥æ”¯æŒè¯·æ±‚å¹¶å‘ï¼Œä½†æ˜¯æµè§ˆå™¨å¾ˆéš¾å®ç°ï¼Œä¸»æµæµè§ˆå™¨å‚å•†éƒ½ç¦ç”¨äº†ç®¡çº¿åŒ–</li>
<li><strong>é˜Ÿå¤´é˜»å¡</strong>ï¼šTCP è¿æ¥ä¸Šåªèƒ½å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œç”±äºå•è¿æ¥ä¸Šçš„ä¸²è¡Œè¯·æ±‚ï¼Œå‰é¢çš„è¯·æ±‚æœªå®Œæˆå‰ï¼Œåç»­çš„è¯·æ±‚éƒ½åœ¨æ’é˜Ÿç­‰å¾…</li>
<li><strong>å¤´éƒ¨å†—ä½™</strong>ï¼šHTTP/1.x é‡‡ç”¨æ–‡æœ¬æ ¼å¼ä¼ è¾“ï¼Œé¦–éƒ¨æœªå‹ç¼©ï¼Œæ— çŠ¶æ€ç‰¹æ€§è®©æ¯ä¸ªè¯·æ±‚éƒ½ä¼šå¸¦ä¸Š Cookieã€User-Agent ç­‰é‡å¤çš„ä¿¡æ¯</li>
<li><strong>ä¸æ”¯æŒæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€</strong>ï¼šHTTP/1.1 ä¸æ”¯æŒæœåŠ¡æ¨é€æ¶ˆæ¯ï¼Œåªèƒ½ä½¿ç”¨è½®è¯¢çš„æ–¹å¼è§£å†³</li>
</ol>
<h2>æ–°ç‰¹æ€§</h2>
<p>åœ¨äº†è§£ HTTP/2 æ–°ç‰¹æ€§å‰ï¼Œå¯ä»¥é€šè¿‡ DEMO ç›´è§‚æ„Ÿå— HTTP/1.1 ä¸ HTTP/2 çš„å·®è·ï¼š</p>
<p><a href="https://http2.akamai.com/demo" target="_blank" rel="noopener noreferrer nofollow">HTTP/2: the Future of the Internet | Akamai</a></p>
<p>ä¸»è¦æ–°ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>ä¼ è¾“æ•°æ®é‡å¤§é‡å‡å°‘</strong>
<ul>
<li><a href="/front-end/computer-networks/http/#%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E5%B8%A7">äºŒè¿›åˆ¶åˆ†å¸§</a></li>
<li><a href="/front-end/computer-networks/http/#%E6%A0%87%E5%A4%B4%E5%8E%8B%E7%BC%A9">æ ‡å¤´å‹ç¼©</a></li>
</ul>
</li>
<li><strong>å¤šè·¯å¤ç”¨åŠç›¸å…³åŠŸèƒ½</strong>
<ul>
<li><a href="/front-end/computer-networks/http/#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8">å¤šè·¯å¤ç”¨</a></li>
<li>ä¼˜å…ˆçº§ä¸ä¾èµ–æ€§</li>
</ul>
</li>
<li><strong>æœåŠ¡å™¨æ¶ˆæ¯æ¨é€</strong>
<ul>
<li><a href="/front-end/computer-networks/http">æœåŠ¡å™¨æ¨é€</a></li>
</ul>
</li>
<li>å…¶ä»–
<ul>
<li>é‡ç½®æµ</li>
<li>æµé‡æ§åˆ¶</li>
<li>HTTPS RFC è§„èŒƒå¹¶æ²¡æœ‰è¦æ±‚ HTTP2 å¼ºåˆ¶ä½¿ç”¨ TLSï¼Œä½†æ˜¯ç›®å‰ä¸–ç•Œæ‰€æœ‰æµè§ˆå™¨å’Œ- æœåŠ¡å™¨å®ç°éƒ½åŸºäº HTTPS æ¥å®ç° HTTP2</li>
</ul>
</li>
</ul>
<h3>äºŒè¿›åˆ¶åˆ†å¸§</h3>
<p>ç›¸æ¯”äº HTTP/1.x åŸºäºä»¥æ¢è¡Œç¬¦ä½œä¸ºçº¯æ–‡æœ¬çš„åˆ†éš”ç¬¦çš„è§£æï¼ŒHTTP/2 å°†æ‰€æœ‰çš„ä¼ è¾“ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶å¯¹å®ƒä»¬é‡‡ç”¨ <strong>äºŒè¿›åˆ¶æ ¼å¼ç¼–ç </strong>ã€‚åŸºäºäºŒè¿›åˆ¶å¯ä»¥ä½¿åè®®æœ‰æ›´å¤šçš„æ‰©å±•æ€§ï¼Œä¾‹å¦‚ï¼Œå¼•å…¥å¸§æ¥ä¼ è¾“æ•°æ®å’ŒæŒ‡ä»¤ã€‚</p>
<p>HTTP/2 æ‰€æœ‰æ€§èƒ½å¢å¼ºçš„æ ¸å¿ƒåœ¨äºæ–°çš„ &lt;strong style=&quot;color:red&quot;&gt;äºŒè¿›åˆ¶åˆ†å¸§å±‚&lt;/strong&gt;ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°è£… HTTP æ¶ˆæ¯å¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚</p>
<blockquote>
<p>è¿™é‡Œæ‰€è°“çš„ &lt;strong style=&quot;color:red&quot;&gt;å±‚&lt;/strong&gt;ï¼ŒæŒ‡çš„æ˜¯ä½äºå¥—æ¥å­—æ¥å£ä¸åº”ç”¨å¯è§çš„é«˜çº§ HTTP API ä¹‹é—´ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ–°ç¼–ç æœºåˆ¶ï¼šHTTP çš„è¯­ä¹‰ï¼ˆåŒ…æ‹¬å„ç§åŠ¨è¯ã€æ–¹æ³•ã€æ ‡å¤´ï¼‰éƒ½ä¸å—å½±å“ï¼Œä¸åŒçš„æ˜¯ä¼ è¾“æœŸé—´å¯¹å®ƒä»¬çš„ç¼–ç æ–¹å¼å˜äº†ã€‚</p>
</blockquote>
<h4>æ•°æ®æµã€æ¶ˆæ¯å’Œå¸§</h4>
<p>æ–°çš„äºŒè¿›åˆ¶åˆ†å¸§æœºåˆ¶æ”¹å˜äº†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„æ–¹å¼ã€‚</p>
<p>ä¸ºäº†è¯´æ˜è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ HTTP/2 çš„ä¸‰ä¸ªæ¦‚å¿µï¼š</p>
<ul>
<li><strong>æ•°æ®æµ</strong>ï¼ˆStreamï¼‰ï¼šå·²å»ºç«‹çš„è¿æ¥å†…çš„ &lt;u&gt;åŒå‘å­—èŠ‚æµ&lt;/u&gt;ï¼Œå¯ä»¥æ‰¿è½½ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯</li>
<li><strong>æ¶ˆæ¯</strong>ï¼ˆMessageï¼‰ï¼šä¸é€»è¾‘è¯·æ±‚æˆ–å“åº”æ¶ˆæ¯å¯¹åº”çš„å®Œæ•´çš„ä¸€ç³»åˆ—å¸§</li>
<li><strong>å¸§</strong>ï¼ˆFrameï¼‰ï¼šHTTP/2 é€šä¿¡çš„æœ€å°å•ä½ï¼Œæ¯ä¸ªå¸§éƒ½åŒ…å«å¸§å¤´ï¼Œè‡³å°‘ä¹Ÿä¼šæ ‡è¯†å‡ºå½“å‰å¸§æ‰€å±çš„æ•°æ®æµ</li>
</ul>
<p>è¿™äº›æ¦‚å¿µçš„å…³ç³»æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ‰€æœ‰é€šä¿¡éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå®Œæˆï¼Œæ­¤è¿æ¥ <strong>å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµ</strong></li>
<li>æ¯ä¸ªæ•°æ®æµéƒ½æœ‰ä¸€ä¸ª <strong>å”¯ä¸€çš„æ ‡è¯†ç¬¦å’Œå¯é€‰çš„ä¼˜å…ˆçº§ä¿¡æ¯</strong>ï¼Œç”¨äºæ‰¿è½½åŒå‘æ¶ˆæ¯</li>
<li>æ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€æ¡é€»è¾‘ HTTP æ¶ˆæ¯ï¼ˆä¾‹å¦‚è¯·æ±‚æˆ–å“åº”ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¸§</li>
<li>å¸§æ˜¯æœ€å°çš„é€šä¿¡å•ä½ï¼Œæ‰¿è½½ç€ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ HTTP æ ‡å¤´ã€æ¶ˆæ¯è´Ÿè½½ç­‰ç­‰ã€‚æ¥è‡ªä¸åŒæ•°æ®æµçš„å¸§å¯ä»¥äº¤é”™å‘é€ï¼Œç„¶åæ ¹æ®æ¯ä¸ªå¸§å¤´çš„æ•°æ®æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ã€‚</li>
</ul>
<p>HTTP/2 å°† HTTP åè®®é€šä¿¡åˆ†è§£ä¸ºäºŒè¿›åˆ¶ç¼–ç å¸§çš„äº¤æ¢ï¼Œè¿™äº›å¸§å¯¹åº”ç€ç‰¹å®šæ•°æ®æµä¸­çš„æ¶ˆæ¯ã€‚æ‰€æœ‰è¿™äº›éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥å†…å¤ç”¨ï¼Œè¿™æ˜¯ HTTP/2 åè®®æ‰€æœ‰å…¶ä»–åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚</p>
<pre class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> img <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../assets/http2/connection.svg&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> () =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;HTTP æ•°æ®æµé€šä¿¡è¿æ¥&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{img}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{640}</span> /&gt;</span></span>;
</code></pre>
<p><strong>æ¶ˆæ¯çš„ç»„æˆï¼šHEADERS å¸§ä¸ DATA å¸§</strong></p>
<ul>
<li>HEADERS frame å¤´éƒ¨å¸§</li>
<li>DATA frame æ•°æ®å¸§</li>
</ul>
<pre class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> img <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../assets/http2/binary-framing.png&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> () =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;æ¶ˆæ¯ç»„æˆ&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{img}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{640}</span> /&gt;</span></span>;
</code></pre>
<p>æ›´å¤šå…³äºå¸§å®šä¹‰è¯¦è§£ï¼Œè¯·æŸ¥é˜… <a href="https://halfrost.com/http2-http-frames-definitions/" target="_blank" rel="noopener noreferrer nofollow">HTTP/2 ä¸­çš„å¸§å®šä¹‰</a></p>
<h3>æ ‡å¤´å‹ç¼©</h3>
<p>æ ‡å¤´å‹ç¼©ï¼ˆHeader compressionï¼‰ï¼šæ¯ä¸ª HTTP ä¼ è¾“éƒ½æ‰¿è½½ä¸€ç»„æ ‡å¤´ï¼Œè¿™äº›æ ‡å¤´è¯´æ˜äº†ä¼ è¾“çš„èµ„æºåŠå…¶å±æ€§ã€‚ åœ¨ HTTP/1.x ä¸­ï¼Œæ­¤å…ƒæ•°æ®å§‹ç»ˆä»¥çº¯æ–‡æœ¬å½¢å¼ï¼Œé€šå¸¸ä¼šç»™æ¯ä¸ªä¼ è¾“å¢åŠ  500â€“800 å­—èŠ‚çš„å¼€é”€ã€‚å¦‚æœä½¿ç”¨ HTTP Cookieï¼Œå¢åŠ çš„å¼€é”€æœ‰æ—¶ä¼šè¾¾åˆ°ä¸Šåƒå­—èŠ‚ã€‚</p>
<p>ä¸ºäº†å‡å°‘æ­¤å¼€é”€å’Œæå‡æ€§èƒ½ï¼ŒHTTP/2 ä½¿ç”¨ &lt;strong style=&quot;color:red&quot;&gt;HPACK&lt;/strong&gt; å‹ç¼©æ ¼å¼å‹ç¼©è¯·æ±‚å’Œå“åº”æ ‡å¤´å…ƒæ•°æ®ï¼Œè¿™ç§æ ¼å¼é‡‡ç”¨ä¸¤ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€æœ¯ï¼š</p>
<ol>
<li>è¿™ç§æ ¼å¼æ”¯æŒé€šè¿‡é™æ€éœå¤«æ›¼ä»£ç å¯¹ä¼ è¾“çš„æ ‡å¤´å­—æ®µè¿›è¡Œç¼–ç ï¼Œä»è€Œå‡å°äº†å„ä¸ªä¼ è¾“çš„å¤§å°ã€‚</li>
<li>è¿™ç§æ ¼å¼è¦æ±‚é€šè®¯åŒæ–¹ <strong>å„è‡ªç¼“å­˜ä¸€ä»½å¤´åŸŸç´¢å¼•è¡¨</strong>ï¼Œç›¸åŒçš„æ¶ˆæ¯å¤´åªå‘é€ <strong>ç´¢å¼•å·</strong>ï¼ˆæ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥å»ºç«‹ä¸€ä¸ªå…±äº«çš„å‹ç¼©ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ­¤ç´¢å¼•è¡¨éšåä¼šç”¨ä½œå‚è€ƒï¼Œå¯¹ä¹‹å‰ä¼ è¾“çš„å€¼è¿›è¡Œæœ‰æ•ˆç¼–ç ã€‚</li>
</ol>
<p>åˆ©ç”¨éœå¤«æ›¼ç¼–ç ï¼ˆHPACKï¼‰ï¼Œå¯ä»¥åœ¨ä¼ è¾“æ—¶å¯¹å„ä¸ªå€¼è¿›è¡Œå‹ç¼©ï¼Œè€Œåˆ©ç”¨ä¹‹å‰ä¼ è¾“å€¼çš„ç´¢å¼•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ è¾“ç´¢å¼•å€¼çš„æ–¹å¼å¯¹é‡å¤å€¼è¿›è¡Œç¼–ç ï¼Œç´¢å¼•å€¼å¯ç”¨äºæœ‰æ•ˆæŸ¥è¯¢å’Œé‡æ„å®Œæ•´çš„æ ‡å¤´é”®å€¼å¯¹ã€‚</p>
<p><strong>ç´¢å¼•è¡¨ç”¨æ³•ç¤ºæ„</strong></p>
<pre class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> img <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../assets/http2/headers-compress.jpg&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> () =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;ç´¢å¼•è¡¨ç”¨æ³•ç¤ºæ„&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{img}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{520}</span> /&gt;</span></span>;
</code></pre>
<p>å®¢æˆ·ç«¯å‘äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚æœ‰å®Œæ•´çš„ HTTP æŠ¥æ–‡å¤´éƒ¨ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™åªæœ‰ä¸€ä¸ª <code>path</code> çš„å­—æ®µä¸ä¸€æ ·ï¼Œä½†æ˜¯è¿™æ¬¡æŠ¥æ–‡å¤´å®ƒåªéœ€è¦å‘é€ä¸€ä¸ª <code>path</code> çš„å­—æ®µå°±å¥½äº†ï¼Œè¿™æ ·å°±å¤§å¤§å‡å°‘äº†å‘é€çš„é‡ã€‚è¿™ä¸ªçš„å®ç°è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæŠ¥æ–‡å¤´è¡¨ã€‚</p>
<h4>HPACK éœå¤«æ›¼ç¼–ç </h4>
<p>HPACK å‹ç¼©ç¤ºæ„ï¼š</p>
<pre class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> img <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../assets/http2/hpack-header-compression.png&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> () =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;HPACKå‹ç¼©ç¤ºæ„&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{img}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{640}</span> /&gt;</span></span>;
</code></pre>
<p>ä½œä¸ºä¸€ç§è¿›ä¸€æ­¥ä¼˜åŒ–æ–¹å¼ï¼ŒHPACK å‹ç¼©ä¸Šä¸‹æ–‡åŒ…å«ä¸€ä¸ªé™æ€å­—å…¸å’Œä¸€ä¸ªåŠ¨æ€å­—å…¸ï¼š</p>
<ul>
<li><a href="https://httpwg.org/specs/rfc7541.html#static.table.definition" target="_blank" rel="noopener noreferrer nofollow">é™æ€å­—å…¸</a> åœ¨è§„èŒƒä¸­å®šä¹‰ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰è¿æ¥éƒ½å¯èƒ½ä½¿ç”¨çš„å¸¸ç”¨ HTTP æ ‡å¤´å­—æ®µï¼ˆä¾‹å¦‚ï¼Œæœ‰æ•ˆæ ‡å¤´åç§°ï¼‰çš„åˆ—è¡¨</li>
<li>åŠ¨æ€å­—å…¸æœ€åˆä¸ºç©ºï¼Œå°†æ ¹æ®åœ¨ç‰¹å®šè¿æ¥å†…äº¤æ¢çš„å€¼è¿›è¡Œæ›´æ–°</li>
</ul>
<p>å› æ­¤ï¼Œä¸ºä¹‹å‰æœªè§è¿‡çš„å€¼é‡‡ç”¨é™æ€ Huffman ç¼–ç ï¼Œå¹¶æ›¿æ¢æ¯ä¸€ä¾§é™æ€è¡¨æˆ–åŠ¨æ€è¡¨ä¸­å·²å­˜åœ¨å€¼çš„ç´¢å¼•ï¼Œå¯ä»¥å‡å°æ¯ä¸ªè¯·æ±‚çš„å¤§å°ã€‚</p>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šåœ¨ HTTP/2 ä¸­ï¼Œè¯·æ±‚å’Œå“åº”æ ‡å¤´å­—æ®µçš„å®šä¹‰ä¿æŒä¸å˜ï¼Œä»…æœ‰ä¸€äº›å¾®å°çš„å·®å¼‚ï¼šæ‰€æœ‰æ ‡å¤´å­—æ®µåç§°å‡ä¸ºå°å†™ï¼Œè¯·æ±‚è¡Œç°åœ¨æ‹†åˆ†æˆå„ä¸ª <code>:method</code>ã€<code>:scheme</code>ã€<code>:authority</code> å’Œ <code>:path</code> ä¼ªæ ‡å¤´å­—æ®µã€‚</p>
</blockquote>
<ul>
<li>å…³äº <a href="https://tools.ietf.org/html/rfc7541" target="_blank" rel="noopener noreferrer nofollow">HPACK å¤´éƒ¨å‹ç¼©æ ‡å‡†</a> çš„åˆ¶å®š</li>
<li><a href="https://httpwg.org/specs/rfc7541.html" target="_blank" rel="noopener noreferrer nofollow">HPACKï¼šHeader Compression for HTTP/2</a></li>
</ul>
<h3>å¤šè·¯å¤ç”¨</h3>
<p><strong>å¤šè·¯å¤ç”¨ï¼ˆMultiPlexingï¼‰</strong>ï¼šé€šè¿‡è¯¥åŠŸèƒ½ï¼Œåœ¨ä¸€æ¡è¿æ¥ä¸Šï¼Œæ‚¨çš„æµè§ˆå™¨å¯ä»¥åŒæ—¶å‘èµ·æ— æ•°ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å“åº”å¯ä»¥åŒæ—¶å“åº”ã€‚å¦å¤–ï¼Œå¤šè·¯å¤ç”¨ä¸­æ”¯æŒäº†æµçš„ä¼˜å…ˆçº§ï¼ˆStream dependenciesï¼‰è®¾ç½®ï¼Œå…è®¸å®¢æˆ·ç«¯å‘ŠçŸ¥æœåŠ¡å™¨æœ€ä¼˜èµ„æºï¼Œå¯ä»¥ä¼˜å…ˆä¼ è¾“ã€‚</p>
<p>å½“æˆ‘ä»¬æ‰“å¼€ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨ä¼šå¯¹æ¯ä¸ªç½‘é¡µå¹¶å‘çš„è¿æ¥è¿›è¡Œé™åˆ¶ï¼Œä¸€èˆ¬æµè§ˆå™¨çš„ HTTP è¯·æ±‚å¹¶å‘æ•°é™åˆ¶åœ¨ 6-8 ä¸ªã€‚ä½†å®é™…ä¸Šï¼Œç»å¤§éƒ¨åˆ†ç½‘ç«™é¦–é¡µæ‰€éœ€è¦çš„èµ„æºä¸ªæ•°è¿œå¤§äºè¿™ä¸ªé™åˆ¶ã€‚æ‰€ä»¥ä¸ºäº†ä¸è®©èµ„æºåœ¨ä¸‹è½½é˜¶æ®µå°±è¢«é˜»å¡ä½ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šæŠŠä¸€äº›é™æ€èµ„æºåˆ†æ•£åˆ° CDN æˆ–å…¶ä»–æœåŠ¡å™¨ä¸Šï¼Œä»è€Œé€šè¿‡å¤šåŸŸåçš„æ–¹å¼çªç ´æµè§ˆå™¨å¯¹å¹¶å‘è¿æ¥æ•°çš„é™åˆ¶ï¼Œä»è€Œä½¿å¾—ç½‘ç«™èƒ½åŒæ—¶ä¸‹è½½å°½å¯èƒ½å¤šçš„èµ„æºã€‚</p>
<p>ä½†å»ºç«‹æ›´å¤šçš„è¿æ¥ä¹Ÿæ„å‘³æ›´å¤šçš„å¼€é”€ã€‚æ¯ä¸ª HTTP è¯·æ±‚éƒ½å¯¹åº”å»ºç«‹ TCP è¿æ¥ï¼Œä¹Ÿè®¸æœ‰äº›èµ„æºä½“ç§¯åªæœ‰å‡  kbï¼Œè¿™äº›æƒ…å†µä¸‹å»ºç«‹è¿æ¥æœ¬èº«çš„å¼€é”€å°±å˜å¾—æ›´å®¢è§‚ï¼Œå¾ˆå¯èƒ½ä¸‰æ¬¡æ¡æ‰‹çš„å®è·µæ¯”ä¼ è¾“æ—¶é—´è¿˜é•¿</p>
<p>åœ¨ HTTP/2 ä¸­ï¼Œæœ‰äº†äºŒè¿›åˆ¶åˆ†å¸§ä¹‹åï¼ŒHTTP/2 ä¸å†ä¾èµ– TCP é“¾æ¥å»å®ç°å¤šæµå¹¶è¡Œï¼Œè€Œæ˜¯é€šè¿‡ &lt;strong style=&quot;color:red&quot;&gt;æµ&lt;/strong&gt; æ”¯æŒå¤šè·¯å¤ç”¨ã€‚</p>
<p>å°† HTTP æ¶ˆæ¯åˆ†è§£ä¸ºç‹¬ç«‹çš„å¸§ï¼Œäº¤é”™å‘é€ï¼Œç„¶ååœ¨å¦ä¸€ç«¯é‡æ–°ç»„è£…æ˜¯ HTTP/2 æœ€é‡è¦çš„ä¸€é¡¹å¢å¼ºã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªæœºåˆ¶ä¼šåœ¨æ•´ä¸ªç½‘ç»œæŠ€æœ¯æ ˆä¸­å¼•å‘ä¸€ç³»åˆ—è¿é”ååº”ï¼Œä»è€Œå¸¦æ¥å·¨å¤§çš„æ€§èƒ½æå‡ï¼Œè®©æˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>å¹¶è¡Œäº¤é”™åœ°å‘é€å¤šä¸ªè¯·æ±‚/å“åº”ï¼Œè¯·æ±‚/å“åº”ä¹‹é—´äº’ä¸å½±å“</li>
<li>ä¸å¿…å†ä¸ºç»•è¿‡ HTTP/1.x é™åˆ¶è€Œåšå¾ˆå¤šå·¥ä½œï¼ˆè¯·å‚é˜… <a href="https://hpbn.co/optimizing-application-delivery/#optimizing-for-http1x" target="_blank" rel="noopener noreferrer nofollow">é’ˆå¯¹ HTTP/1.x è¿›è¡Œä¼˜åŒ–</a>ï¼Œä¾‹å¦‚çº§è”æ–‡ä»¶ã€Image Sprites å’ŒåŸŸååˆ†ç‰‡</li>
<li>æ¶ˆé™¤ä¸å¿…è¦çš„å»¶è¿Ÿå’Œæé«˜ç°æœ‰ç½‘ç»œå®¹é‡çš„åˆ©ç”¨ç‡ï¼Œä»è€Œå‡å°‘é¡µé¢åŠ è½½æ—¶é—´</li>
</ul>
<p>HTTP/2 ä¸­çš„æ–°äºŒè¿›åˆ¶åˆ†å¸§å±‚è§£å†³äº† HTTP/1.x ä¸­å­˜åœ¨çš„ <strong>é˜Ÿå¤´é˜»å¡</strong> é—®é¢˜ï¼Œä¹Ÿæ¶ˆé™¤äº†å¹¶è¡Œå¤„ç†å’Œå‘é€è¯·æ±‚åŠå“åº”æ—¶å¯¹å¤šä¸ªè¿æ¥çš„ä¾èµ–ã€‚</p>
<h3>æœåŠ¡å™¨æ¨é€</h3>
<p>æœåŠ¡ç«¯æ¨é€ï¼ˆServer pushï¼‰ï¼šåŒ SPDY ä¸€æ ·ï¼ŒHTTP/2 ä¹Ÿå…·æœ‰å®¢æˆ·ç«¯æ¨é€åŠŸèƒ½ã€‚ç›®å‰ï¼Œå¤§å¤šæ•°ç½‘ç«™å·²ç»å¯ç”¨ HTTP/2ï¼Œå¦‚æ·˜å®ã€‚ä½¿ç”¨æœåŠ¡å™¨æ¨åŠ¨ï¼Œå¯ä»¥æå‰å°†èµ„æºæ¨é€è‡³æµè§ˆå™¨ç¼“å­˜ã€‚</p>
<p>HTTP/2 ä¸­çš„ Server Push å¹¶ä¸æ˜¯æŒ‡ç±»ä¼¼äºç°åœ¨çš„ Server Sent Eventï¼ˆSSEï¼‰ æˆ–è€… WebSocket çš„æ¨é€æŠ€æœ¯ã€‚<strong>å®ƒæ˜¯ä¸€ç§æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯ä»¥å‰å‘é€çš„è¯·æ±‚æ¥çŒœæµ‹æœªæ¥çš„è¯·æ±‚ï¼Œå¹¶æå‰å°†æœªæ¥è¯·æ±‚çš„ç»“æœæ¨é€ç»™å®¢æˆ·ç«¯çš„æŠ€æœ¯</strong>ã€‚</p>
<pre class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> img <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../assets/http2/server-push.png&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> () =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;æœåŠ¡å™¨æ¨é€&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{img}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{640}</span> /&gt;</span></span>;
</code></pre>
<blockquote>
<p>ä¸ºä»€ä¹ˆåœ¨æµè§ˆå™¨ä¸­éœ€è¦ä¸€ç§æ­¤ç±»æœºåˆ¶å‘¢ï¼Ÿ</p>
</blockquote>
<p>ä¸€ä¸ªå…¸å‹çš„ç½‘ç»œåº”ç”¨åŒ…å«å¤šç§èµ„æºï¼Œå®¢æˆ·ç«¯éœ€è¦æ£€æŸ¥æœåŠ¡å™¨æä¾›çš„æ–‡æ¡£æ‰èƒ½é€ä¸ªæ‰¾åˆ°å®ƒä»¬ã€‚ é‚£ä¸ºä»€ä¹ˆä¸è®©æœåŠ¡å™¨æå‰æ¨é€è¿™äº›èµ„æºï¼Œä»è€Œå‡å°‘é¢å¤–çš„å»¶è¿Ÿæ—¶é—´å‘¢ï¼Ÿ æœåŠ¡å™¨å·²ç»çŸ¥é“å®¢æˆ·ç«¯ä¸‹ä¸€æ­¥è¦è¯·æ±‚ä»€ä¹ˆèµ„æºï¼Œè¿™æ—¶å€™æœåŠ¡å™¨æ¨é€å³å¯æ´¾ä¸Šç”¨åœºã€‚</p>
<p>äº‹å®ä¸Šï¼Œå¦‚æœæ‚¨åœ¨ç½‘é¡µä¸­å†…è”è¿‡ CSSã€JavaScriptï¼Œæˆ–è€…é€šè¿‡æ•°æ® URI å†…è”è¿‡å…¶ä»–èµ„äº§ï¼ˆè¯·å‚é˜… <a href="https://hpbn.co/http1x/#resource-inlining" target="_blank" rel="noopener noreferrer nofollow">èµ„æºå†…è”</a>ï¼‰ï¼Œé‚£ä¹ˆæ‚¨å°±å·²ç»äº²èº«ä½“éªŒè¿‡æœåŠ¡å™¨æ¨é€äº†ã€‚ å¯¹äºå°†èµ„æºæ‰‹åŠ¨å†…è”åˆ°æ–‡æ¡£ä¸­çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨å°†èµ„æºæ¨é€ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸æ˜¯ç­‰å¾…å®¢æˆ·ç«¯è¯·æ±‚ã€‚ ä½¿ç”¨ HTTP/2ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥å®ç°ç›¸åŒç»“æœï¼Œè¿˜ä¼šè·å¾—å…¶ä»–æ€§èƒ½ä¼˜åŠ¿ã€‚</p>
<p>æ¨é€èµ„æºå¯ä»¥è¿›è¡Œä»¥ä¸‹å¤„ç†ï¼š</p>
<ul>
<li>ç”±å®¢æˆ·ç«¯ç¼“å­˜</li>
<li>åœ¨ä¸åŒé¡µé¢ä¹‹é—´é‡ç”¨</li>
<li>ä¸å…¶ä»–èµ„æºä¸€èµ·å¤ç”¨</li>
<li>ç”±æœåŠ¡å™¨è®¾å®šä¼˜å…ˆçº§</li>
<li>è¢«å®¢æˆ·ç«¯æ‹’ç»</li>
</ul>
<h4>Nginx é…ç½®å®ç°</h4>
<p>é€šè¿‡ Nginx é…ç½®èƒ½ä¸»åŠ¨æ¨é€ä¸¤ä¸ª HTML æ–‡æ¡£ä¸­éœ€è¦è¯·æ±‚çš„æ–‡ä»¶ï¼š</p>
<pre class="hljs"><code class="language-nginx"><span class="hljs-section">server</span> {
    <span class="hljs-comment"># è®¾å®šå¼€å¯ä½¿ç”¨ HTTP2</span>
    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2;
    <span class="hljs-attribute">server_name</span>  localhost;

    <span class="hljs-attribute">ssl</span>                      <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">ssl_certificate</span>          /etc/nginx/certs/example.crt;
    <span class="hljs-attribute">ssl_certificate_key</span>      /etc/nginx/certs/example.key;

    <span class="hljs-attribute">ssl_session_timeout</span>  <span class="hljs-number">5m</span>;

    <span class="hljs-attribute">ssl_ciphers</span> HIGH:!aNULL:!MD5;
    <span class="hljs-attribute">ssl_protocols</span> SSLv3 TLSv1 TLSv1.<span class="hljs-number">1</span> TLSv1.<span class="hljs-number">2</span>;
    <span class="hljs-attribute">ssl_prefer_server_ciphers</span>   <span class="hljs-literal">on</span>;

    <span class="hljs-section">location</span> / {
      <span class="hljs-attribute">root</span>   /usr/share/nginx/html;
      <span class="hljs-attribute">index</span>  index.html index.htm;

      <span class="hljs-comment"># æœåŠ¡å™¨ä¸»åŠ¨æ¨é€è¿™ä¸¤ä¸ªæ–‡ä»¶</span>
      <span class="hljs-attribute">http2_push</span> /style.css;
      <span class="hljs-attribute">http2_push</span> /example.png;
    }
</code></pre>
<p>è¿™ç§æ–¹å¼éœ€è¦å†™åœ¨æœåŠ¡å™¨é…ç½®ä¸­ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½è¦é‡å¯æœåŠ¡ï¼Œè€Œä¸”åº”ç”¨ä¸æœåŠ¡å™¨çš„é…ç½®ä¸åº”è¯¥æ··åœ¨ä¸€èµ·ã€‚</p>
<h4>æœåŠ¡ç«¯å®ç°</h4>
<p>æœåŠ¡å™¨æ¨é€è¿˜æœ‰å¦ä¸€ä¸ªå®ç°æ–¹æ³•ï¼Œå°±æ˜¯åç«¯åº”ç”¨äº§ç”Ÿ HTTP å“åº”å¤´ä¿¡æ¯ <code>Link</code> å‘½ä»¤ã€‚æœåŠ¡å™¨å‘ç°æœ‰è¿™ä¸ªå¤´ä¿¡æ¯ï¼Œå°±ä¼šè¿›è¡ŒæœåŠ¡å™¨æ¨é€ã€‚</p>
<pre class="hljs"><code class="language-http"><span class="hljs-attribute">Link</span><span class="hljs-punctuation">: </span>&lt;/styles.css&gt;; rel=preload; as=style
</code></pre>
<p>å¦‚æœè¦æ¨é€å¤šä¸ªèµ„æºï¼š</p>
<pre class="hljs"><code class="language-http"><span class="hljs-attribute">Link</span><span class="hljs-punctuation">: </span>&lt;/styles.css&gt;; rel=preload; as=style, &lt;/example.png&gt;; rel=preload; as=image
</code></pre>
<p>è¿™æ—¶ï¼ŒNginx çš„é…ç½®æ”¹æˆä¸‹é¢è¿™æ ·ã€‚</p>
<pre class="hljs"><code class="language-nginx"><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2;

    <span class="hljs-comment"># ...</span>

    <span class="hljs-attribute">root</span> /var/www/html;

    <span class="hljs-section">location</span> = / {
        <span class="hljs-attribute">proxy_pass</span> http://upstream;
        <span class="hljs-attribute">http2_push_preload</span> <span class="hljs-literal">on</span>;
    }
}
</code></pre>
<p>å¦‚æœæœåŠ¡å™¨æˆ–è€…æµè§ˆå™¨ä¸æ”¯æŒ HTTP2ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šæŒ‰ç…§ <code>preload</code> æ¥å¤„ç†è¿™ä¸ªå¤´ä¿¡æ¯ï¼Œé¢„åŠ è½½æŒ‡å®šçš„èµ„æºæ–‡ä»¶ã€‚</p>
<p>äº‹å®ä¸Šï¼Œè¿™ä¸ªå¤´ä¿¡æ¯å°±æ˜¯ <code>preload</code> æ ‡å‡†æå‡ºçš„ï¼Œå®ƒçš„è¯­æ³•å’Œ <code>as</code> å±æ€§çš„å€¼éƒ½å†™åœ¨äº† <a href="https://w3c.github.io/preload/#as-attribute" target="_blank" rel="noopener noreferrer nofollow">æ ‡å‡†</a> é‡Œé¢ã€‚</p>
<p>å‚è€ƒ <a href="https://blog.risingstack.com/node-js-http-2-push/" target="_blank" rel="noopener noreferrer nofollow">HTTP/2 Server Push with Node.js</a> å®ç°ã€‚</p>
<h4>ç¼“å­˜é—®é¢˜</h4>
<p>æœåŠ¡å™¨æ¨é€æœ‰ä¸€ä¸ªå¾ˆéº»çƒ¦çš„é—®é¢˜ã€‚æ‰€è¦æ¨é€çš„èµ„æºæ–‡ä»¶ï¼Œå¦‚æœæµè§ˆå™¨å·²ç»æœ‰ç¼“å­˜ï¼Œæ¨é€å°±æ˜¯æµªè´¹å¸¦å®½ã€‚å³ä½¿æ¨é€çš„æ–‡ä»¶ç‰ˆæœ¬æ›´æ–°ï¼Œæµè§ˆå™¨ä¹Ÿä¼šä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚</p>
<p>ä¸€ç§è§£å†³åŠæ³•æ˜¯ï¼Œåªå¯¹ç¬¬ä¸€æ¬¡è®¿é—®çš„ç”¨æˆ·å¼€å¯æœåŠ¡å™¨æ¨é€ã€‚ä¸‹é¢æ˜¯ Nginx å®˜æ–¹ç»™å‡ºçš„ç¤ºä¾‹ï¼Œæ ¹æ® Cookie åˆ¤æ–­æ˜¯å¦ä¸ºç¬¬ä¸€æ¬¡è®¿é—®ã€‚</p>
<pre class="hljs"><code class="language-nginx"><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2 default_server;

    <span class="hljs-attribute">ssl_certificate</span> ssl/certificate.pem;
    <span class="hljs-attribute">ssl_certificate_key</span> ssl/key.pem;

    <span class="hljs-attribute">root</span> /var/www/html;
    <span class="hljs-attribute">http2_push_preload</span> <span class="hljs-literal">on</span>;

    <span class="hljs-section">location</span> = /demo.html {
        <span class="hljs-attribute">add_header</span> Set-Cookie <span class="hljs-string">&quot;session=1&quot;</span>;
        <span class="hljs-attribute">add_header</span> Link <span class="hljs-variable">$resources</span>;
    }
}


<span class="hljs-attribute">map</span> <span class="hljs-variable">$http_cookie</span> <span class="hljs-variable">$resources</span> {
    &quot;~*session=1&quot; &quot;&quot;;
    <span class="hljs-attribute">default</span> <span class="hljs-string">&quot;&lt;/style.css&gt;; as=style; rel=preload&quot;</span>;
}
</code></pre>
<h3>å®‰å…¨æå‡</h3>
<blockquote>
<p>HTTP/2 æ˜¯ä¸æ˜¯å¿…é¡»åŸºäº TLS/SSL åè®®ï¼Ÿ</p>
</blockquote>
<ul>
<li>IETF æ ‡å‡†ä¸è¦æ±‚å¿…é¡»åŸºäº TLS/SSL åè®® ğŸ“Œ</li>
<li>æµè§ˆå™¨è¦æ±‚å¿…é¡»åŸºäº TLS/SSL åè®® ğŸ“Œ</li>
<li>åœ¨ TLS å±‚ ALPNï¼ˆApplication Layer Protocol Negotiationï¼‰æ‰©å±•åšåå•†ï¼Œåªè®¤ HTTP/1.x çš„ä»£ç†æœåŠ¡å™¨ä¸ä¼šå¹²æ‰° HTTP/2</li>
<li>shemeï¼š<code>http://</code> å’Œ <code>https://</code> é»˜è®¤åŸºäº 80 å’Œ 443 ç«¯å£</li>
<li>h2ï¼šåŸºäº TLS åè®®è¿è¡Œçš„ HTTP/2 è¢«ç§°ä¸º <code>h2</code></li>
<li>h2cï¼šåŸºäº TCP åè®®ä¹‹ä¸Šè¿è¡Œçš„ HTTP/2 è¢«ç§°ä¸º <code>h2c</code></li>
</ul>
<h2>å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/performance/http2/" target="_blank" rel="noopener noreferrer nofollow">ğŸ“– Google developers document: Introduction to HTTP/2</a></li>
<li><a href="https://imququ.com/post/http2-resource.html" target="_blank" rel="noopener noreferrer nofollow">ğŸ“– HTTP2 èµ„æ–™æ±‡æ€»</a></li>
<li><a href="https://ye11ow.gitbooks.io/http2-explained/content/" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ HTTP2 è®²è§£</a></li>
<li><a href="https://segmentfault.com/a/1190000007219256" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ æ·±å…¥ç ”ç©¶ï¼šHTTP2 çš„çœŸæ­£æ€§èƒ½åˆ°åº•å¦‚ä½•</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/29609078" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ æ€æ ·æŠŠç½‘ç«™å‡çº§åˆ° HTTP/2</a></li>
<li><a href="https://juejin.im/post/5c5ada2e6fb9a049dd80be75" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ HTTP/2 å¸¸è§é—®é¢˜è§£ç­”</a></li>
<li><a href="https://juejin.im/post/5c6a9f85e51d4503831ad4fa" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ ä»ç†è®ºåˆ°å®è·µï¼Œå…¨é¢ç†è§£ HTTP/2</a></li>
<li><a href="https://juejin.im/post/5c4e6d11e51d4534dc477f05" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ å†è°ˆ HTTP2 æ€§èƒ½æå‡ä¹‹èƒŒååŸç†</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2018/03/http2_server_push.html" target="_blank" rel="noopener noreferrer nofollow">ğŸ“ é˜®ä¸€å³°ï¼šHTTP/2 æœåŠ¡å™¨æ¨é€ï¼ˆServer Pushï¼‰æ•™ç¨‹</a></li>
<li><a href="https://chrome.google.com/webstore/detail/http2-and-spdy-indicator/mpbpobfflnpcgagjijhmgnchggcjblin/related?hl=zh-CN" target="_blank" rel="noopener noreferrer nofollow">ğŸ›  HTTP/2 and SPDY indicator</a></li>
</ul>
4:["$","div",null,{"className":"markdown-body","children":["$","article",null,{"dangerouslySetInnerHTML":{"__html":"$c"}}]}]
a:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
8:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"front-end"}],["$","meta","2",{"name":"description","content":"front-end knowledge"}],["$","link","3",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
6:null
