<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/d498c84e4ab246b3.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/485ff6fe79292a08.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b9d97b2190475167.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/851cdee6d90716dd.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-78112f590b744806.js"/><script src="/_next/static/chunks/4bd1b696-20882bf820444624.js" async=""></script><script src="/_next/static/chunks/517-98ed787e5f259f2c.js" async=""></script><script src="/_next/static/chunks/main-app-f33d3e3aed85e21f.js" async=""></script><meta name="next-size-adjust" content=""/><title>front-end</title><meta name="description" content="front-end knowledge"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_4d318d __variable_ea5f4b antialiased"><main><div class="markdown-body"><article><h1>Iterator</h1>
<p>遍历器（Iterator）为各种不同的数据结构提供统一的接口访问机制。任何数据结构只要部署 Iterator 接口，即无须初始化集合，以及索引的变量，而是使用迭代器对象的 <code>next</code> 方法，依次返回集合的下一项值，便于逐项处理该数据结构的所有成员，偏向程序化。</p>
<p><strong>ES5 中的 Loop 的缺点</strong></p>
<table>
<thead>
<tr>
<th>循环方法</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>for</code> 语句</td>
<td>条件部分冗杂；多层嵌套需要定义多个变量，复杂度过高</td>
</tr>
<tr>
<td><code>for...in</code> 语句</td>
<td>只能获取对象键名，需要通过属性访问器的方括号形式获取键值；只适用于对象，其他数组类型不适用</td>
</tr>
<tr>
<td><code>forEach</code> 方法</td>
<td>不能中断，跳出循环</td>
</tr>
</tbody>
</table>
<h2>迭代器</h2>
<p>迭代器是带有特殊接口的对象。含有一个 <code>next()</code> 方法，调用后返回一个包含两个属性的对象，分别是 <code>value</code>（表示属性值） 和 <code>done</code>（表示迭代是否完成）。当迭代完成后，即 <code>done</code> 属性为 <code>true</code> 时，调用 <code>next()</code> 无效。</p>
<p>模拟 Iterator 的内部实现（实质是一个返回迭代器对象的工厂函数）：</p>
<pre class="hljs language-js"  style=--lang:"js" ><code><span class="hljs-keyword">let</span> iterable = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createIterator</span>(<span class="hljs-params">array</span>){
    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">next</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
            <span class="hljs-keyword">return</span> count &lt; array.<span class="hljs-property">length</span> ?
                {<span class="hljs-attr">value</span>: array[count], <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>}:
            	{<span class="hljs-attr">value</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span>}
        }
    }
}

<span class="hljs-keyword">let</span> myIterator = <span class="hljs-title function_">createIterator</span>(iterable)

myIterator.<span class="hljs-title function_">next</span>()	<span class="hljs-comment">// {value: 1, done: false}</span>
myIterator.<span class="hljs-title function_">next</span>()	<span class="hljs-comment">// {value: 2, done: false}</span>
myIterator.<span class="hljs-title function_">next</span>()	<span class="hljs-comment">// {value: 3, done: false}</span>
myIterator.<span class="hljs-title function_">next</span>()	<span class="hljs-comment">// {value: undefined, done: true}</span>
</code></pre>
<h2>迭代器协议</h2>
<p>迭代器对象不是新的语法或新的内置对象，而一种协议（ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener noreferrer nofollow">迭代器协议</a>)，所有遵守这个协议的对象，都可以称之为迭代器。也就是说我们上面 ES5 的写法得到的对象遵循迭代器协议，即包含 <code>next</code>，调用 <code>next</code> 返回一个<code>result{value，done}</code>。</p>
<h2>可迭代对象</h2>
<p>满足可迭代协议的对象是可迭代对象。</p>
<p>可迭代协议：对象的 <code>Symbol.iterator</code> 属性的值是一个无参函数，该函数返回一个迭代器。</p>
<p>下面是数组的 <code>Symbol.iterator</code> 属性实现的迭代。</p>
<pre class="hljs language-js"  style=--lang:"js" ><code><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-keyword">const</span> iter = arr[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]()

iter.<span class="hljs-title function_">next</span>()		<span class="hljs-comment">// Output: {value: 0, done: false}</span>
iter.<span class="hljs-title function_">next</span>()		<span class="hljs-comment">// Output: {value: 1, done: false}</span>
iter.<span class="hljs-title function_">next</span>()		<span class="hljs-comment">// Output: {value: 2, done: false}</span>
iter.<span class="hljs-title function_">next</span>()		<span class="hljs-comment">// Output: {value: undefined, done: true}</span>
</code></pre>
<h3>内置可迭代对象</h3>
<p>原生具备 Iterator 接口的数据结构：</p>
<ul>
<li>Array</li>
<li>Map</li>
<li>Set</li>
<li>String</li>
<li>TypedArray</li>
<li>函数的 arguments 对象</li>
<li>NodeList 对象</li>
</ul>
<h3>自定义可迭代对象</h3>
<p>我们可以实现一个自己的可迭代对象：</p>
<pre class="hljs language-js"  style=--lang:"js" ><code><span class="hljs-keyword">let</span> myIterable = {}

myIterable[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] = <span class="hljs-keyword">function</span>*(){
    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>
}

[...myIterable]		<span class="hljs-comment">// Output: [1, 2, 3]</span>
</code></pre>
<h3>接受可迭代对象的内置 API</h3>
<p>许多 API 接受可迭代对象, 例如：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Map" target="_blank" rel="noopener noreferrer nofollow"><code>Map([iterable])</code></a>、<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/WeakMap" target="_blank" rel="noopener noreferrer nofollow"><code>WeakMap([iterable])</code></a>、<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="noopener noreferrer nofollow"><code>Set([iterable])</code></a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakSet" target="_blank" rel="noopener noreferrer nofollow"><code>WeakSet([iterable])</code></a>：</p>
<pre class="hljs language-js"  style=--lang:"js" ><code><span class="hljs-keyword">var</span> myObj = {};
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">1</span>,<span class="hljs-string">&quot;a&quot;</span>],[<span class="hljs-number">2</span>,<span class="hljs-string">&quot;b&quot;</span>],[<span class="hljs-number">3</span>,<span class="hljs-string">&quot;c&quot;</span>]]).<span class="hljs-title function_">get</span>(<span class="hljs-number">2</span>);               <span class="hljs-comment">// &quot;b&quot;</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>([[{},<span class="hljs-string">&quot;a&quot;</span>],[myObj,<span class="hljs-string">&quot;b&quot;</span>],[{},<span class="hljs-string">&quot;c&quot;</span>]]).<span class="hljs-title function_">get</span>(myObj); <span class="hljs-comment">// &quot;b&quot;</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">has</span>(<span class="hljs-number">3</span>);                               <span class="hljs-comment">// true</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(<span class="hljs-string">&quot;123&quot;</span>).<span class="hljs-title function_">has</span>(<span class="hljs-string">&quot;2&quot;</span>);                                 <span class="hljs-comment">// true</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakSet</span>(<span class="hljs-keyword">function</span>*() {
    <span class="hljs-keyword">yield</span> {};
    <span class="hljs-keyword">yield</span> myObj;
    <span class="hljs-keyword">yield</span> {};
}()).<span class="hljs-title function_">has</span>(myObj);
</code></pre>
<p>另外还有 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" target="_blank" rel="noopener noreferrer nofollow"><code>Promise.all(iterable)</code></a>、<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/race" target="_blank" rel="noopener noreferrer nofollow"><code>Promise.race(iterable)</code></a> 以及 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/from" target="_blank" rel="noopener noreferrer nofollow"><code>Array.from()</code></a>。</p>
<h2>for...of 循环</h2>
<p><code>for...of</code> 接受一个可迭代对象（Iterable），或者能被强制转换/包装成一个可迭代对象的值。遍历时，<code>for...of</code> 会获取可迭代对象的 <code>[Symbol.iterator]()</code>，对该迭代器逐次调用 <code>next()</code>，直到迭代器返回对象的 <code>done</code> 属性为 <code>true</code> 时，遍历结束，不对该 <code>value</code> 处理。</p>
<p><code>for...of</code> 循环实例：</p>
<pre class="hljs language-js"  style=--lang:"js" ><code><span class="hljs-keyword">var</span> a = [<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>,<span class="hljs-string">&quot;d&quot;</span>,<span class="hljs-string">&quot;e&quot;</span>];

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> val <span class="hljs-keyword">of</span> a) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( val );
}
<span class="hljs-comment">// &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;</span>
</code></pre>
<p>转换成普通 <code>for</code> 循环示例，等价于上面 <code>for...of</code> 循环：</p>
<pre class="hljs language-js"  style=--lang:"js" ><code><span class="hljs-keyword">var</span> a = [<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>,<span class="hljs-string">&quot;d&quot;</span>,<span class="hljs-string">&quot;e&quot;</span>];

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> val, ret, it = a[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]();
    (ret = it.<span class="hljs-title function_">next</span>()) &amp;&amp; !ret.<span class="hljs-property">done</span>;
) {
    val = ret.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( val );
}
<span class="hljs-comment">// &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;</span>
</code></pre>
<hr>
<p><strong>参考文章</strong>：</p>
<ul>
<li><a href="http://es6.ruanyifeng.com/#docs/iterator" target="_blank" rel="noopener noreferrer nofollow">ECMAScript 6 入门：Iterator</a></li>
<li><a href="https://juejin.im/entry/5924f5302f301e006b35fba5" target="_blank" rel="noopener noreferrer nofollow">ES6 之迭代器（Iterator）</a></li>
</ul>
</article></div></main><script src="/_next/static/chunks/webpack-78112f590b744806.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n7:I[6213,[],\"MetadataBoundary\"]\n9:I[6213,[],\"ViewportBoundary\"]\nb:I[4835,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/d498c84e4ab246b3.css\",\"style\"]\n:HL[\"/_next/static/css/485ff6fe79292a08.css\",\"style\"]\n:HL[\"/_next/static/css/b9d97b2190475167.css\",\"style\"]\n:HL[\"/_next/static/css/851cdee6d90716dd.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"NFjmtHF2up8B2PpbDjLiS\",\"p\":\"\",\"c\":[\"\",\"front-end\",\"standard-built-in-objects\",\"control-abstraction-objects\",\"iterator\",\"iterator\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"front-end\",{\"children\":[[\"slug\",\"standard-built-in-objects/control-abstraction-objects/iterator/iterator\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d498c84e4ab246b3.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/485ff6fe79292a08.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b9d97b2190475167.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_4d318d __variable_ea5f4b antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"front-end\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/851cdee6d90716dd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"slug\",\"standard-built-in-objects/control-abstraction-objects/iterator/iterator\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":\"$L6\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"KgWeTLQpdlygh1wdjRaC-\",{\"children\":[[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$b\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:T2db4,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eIterator\u003c/h1\u003e\n\u003cp\u003e遍历器（Iterator）为各种不同的数据结构提供统一的接口访问机制。任何数据结构只要部署 Iterator 接口，即无须初始化集合，以及索引的变量，而是使用迭代器对象的 \u003ccode\u003enext\u003c/code\u003e 方法，依次返回集合的下一项值，便于逐项处理该数据结构的所有成员，偏向程序化。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eES5 中的 Loop 的缺点\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e循环方法\u003c/th\u003e\n\u003cth\u003e缺点\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003efor\u003c/code\u003e 语句\u003c/td\u003e\n\u003ctd\u003e条件部分冗杂；多层嵌套需要定义多个变量，复杂度过高\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003efor...in\u003c/code\u003e 语句\u003c/td\u003e\n\u003ctd\u003e只能获取对象键名，需要通过属性访问器的方括号形式获取键值；只适用于对象，其他数组类型不适用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eforEach\u003c/code\u003e 方法\u003c/td\u003e\n\u003ctd\u003e不能中断，跳出循环\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2\u003e迭代器\u003c/h2\u003e\n\u003cp\u003e迭代器是带有特殊接口的对象。含有一个 \u003ccode\u003enext()\u003c/code\u003e 方法，调用后返回一个包含两个属性的对象，分别是 \u003ccode\u003evalue\u003c/code\u003e（表示属性值） 和 \u003ccode\u003edone\u003c/code\u003e（表示迭代是否完成）。当迭代完成后，即 \u003ccode\u003edone\u003c/code\u003e 属性为 \u003ccode\u003etrue\u003c/code\u003e 时，调用 \u003ccode\u003enext()\u003c/code\u003e 无效。\u003c/p\u003e\n\u003cp\u003e模拟 Iterator 的内部实现（实质是一个返回迭代器对象的工厂函数）：\u003c/p\u003e\n\u003cpre class=\"hljs language-js\"  style=--lang:\"js\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e iterable = [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e]\n\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecreateIterator\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003earray\u003c/span\u003e){\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e count = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e {\n        \u003cspan class=\"hljs-attr\"\u003enext\u003c/span\u003e: \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e){\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e count \u0026lt; array.\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e ?\n                {\u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: array[count], \u003cspan class=\"hljs-attr\"\u003edone\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e}:\n            \t{\u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eundefined\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003edone\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e}\n        }\n    }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e myIterator = \u003cspan class=\"hljs-title function_\"\u003ecreateIterator\u003c/span\u003e(iterable)\n\nmyIterator.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\u003cspan class=\"hljs-comment\"\u003e// {value: 1, done: false}\u003c/span\u003e\nmyIterator.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\u003cspan class=\"hljs-comment\"\u003e// {value: 2, done: false}\u003c/span\u003e\nmyIterator.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\u003cspan class=\"hljs-comment\"\u003e// {value: 3, done: false}\u003c/span\u003e\nmyIterator.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\u003cspan class=\"hljs-comment\"\u003e// {value: undefined, done: true}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e迭代器协议\u003c/h2\u003e\n\u003cp\u003e迭代器对象不是新的语法或新的内置对象，而一种协议（ \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%8D%8F%E8%AE%AE\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e迭代器协议\u003c/a\u003e)，所有遵守这个协议的对象，都可以称之为迭代器。也就是说我们上面 ES5 的写法得到的对象遵循迭代器协议，即包含 \u003ccode\u003enext\u003c/code\u003e，调用 \u003ccode\u003enext\u003c/code\u003e 返回一个\u003ccode\u003eresult{value，done}\u003c/code\u003e。\u003c/p\u003e\n\u003ch2\u003e可迭代对象\u003c/h2\u003e\n\u003cp\u003e满足可迭代协议的对象是可迭代对象。\u003c/p\u003e\n\u003cp\u003e可迭代协议：对象的 \u003ccode\u003eSymbol.iterator\u003c/code\u003e 属性的值是一个无参函数，该函数返回一个迭代器。\u003c/p\u003e\n\u003cp\u003e下面是数组的 \u003ccode\u003eSymbol.iterator\u003c/code\u003e 属性实现的迭代。\u003c/p\u003e\n\u003cpre class=\"hljs language-js\"  style=--lang:\"js\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e arr = [\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e]\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e iter = arr[\u003cspan class=\"hljs-title class_\"\u003eSymbol\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eiterator\u003c/span\u003e]()\n\niter.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\t\u003cspan class=\"hljs-comment\"\u003e// Output: {value: 0, done: false}\u003c/span\u003e\niter.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\t\u003cspan class=\"hljs-comment\"\u003e// Output: {value: 1, done: false}\u003c/span\u003e\niter.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\t\u003cspan class=\"hljs-comment\"\u003e// Output: {value: 2, done: false}\u003c/span\u003e\niter.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()\t\t\u003cspan class=\"hljs-comment\"\u003e// Output: {value: undefined, done: true}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e内置可迭代对象\u003c/h3\u003e\n\u003cp\u003e原生具备 Iterator 接口的数据结构：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eArray\u003c/li\u003e\n\u003cli\u003eMap\u003c/li\u003e\n\u003cli\u003eSet\u003c/li\u003e\n\u003cli\u003eString\u003c/li\u003e\n\u003cli\u003eTypedArray\u003c/li\u003e\n\u003cli\u003e函数的 arguments 对象\u003c/li\u003e\n\u003cli\u003eNodeList 对象\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e自定义可迭代对象\u003c/h3\u003e\n\u003cp\u003e我们可以实现一个自己的可迭代对象：\u003c/p\u003e\n\u003cpre class=\"hljs language-js\"  style=--lang:\"js\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e myIterable = {}\n\nmyIterable[\u003cspan class=\"hljs-title class_\"\u003eSymbol\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eiterator\u003c/span\u003e] = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e*(){\n    \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n}\n\n[...myIterable]\t\t\u003cspan class=\"hljs-comment\"\u003e// Output: [1, 2, 3]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e接受可迭代对象的内置 API\u003c/h3\u003e\n\u003cp\u003e许多 API 接受可迭代对象, 例如：\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Map\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003eMap([iterable])\u003c/code\u003e\u003c/a\u003e、\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/WeakMap\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003eWeakMap([iterable])\u003c/code\u003e\u003c/a\u003e、\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003eSet([iterable])\u003c/code\u003e\u003c/a\u003e 和 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakSet\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003eWeakSet([iterable])\u003c/code\u003e\u003c/a\u003e：\u003c/p\u003e\n\u003cpre class=\"hljs language-js\"  style=--lang:\"js\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e myObj = {};\n\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMap\u003c/span\u003e([[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;a\u0026quot;\u003c/span\u003e],[\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;b\u0026quot;\u003c/span\u003e],[\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;c\u0026quot;\u003c/span\u003e]]).\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e);               \u003cspan class=\"hljs-comment\"\u003e// \u0026quot;b\u0026quot;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWeakMap\u003c/span\u003e([[{},\u003cspan class=\"hljs-string\"\u003e\u0026quot;a\u0026quot;\u003c/span\u003e],[myObj,\u003cspan class=\"hljs-string\"\u003e\u0026quot;b\u0026quot;\u003c/span\u003e],[{},\u003cspan class=\"hljs-string\"\u003e\u0026quot;c\u0026quot;\u003c/span\u003e]]).\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(myObj); \u003cspan class=\"hljs-comment\"\u003e// \u0026quot;b\u0026quot;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSet\u003c/span\u003e([\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e]).\u003cspan class=\"hljs-title function_\"\u003ehas\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e);                               \u003cspan class=\"hljs-comment\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSet\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;123\u0026quot;\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ehas\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e);                                 \u003cspan class=\"hljs-comment\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWeakSet\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e*() {\n    \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e {};\n    \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e myObj;\n    \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e {};\n}()).\u003cspan class=\"hljs-title function_\"\u003ehas\u003c/span\u003e(myObj);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e另外还有 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/all\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003ePromise.all(iterable)\u003c/code\u003e\u003c/a\u003e、\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/race\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003ePromise.race(iterable)\u003c/code\u003e\u003c/a\u003e 以及 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/from\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003e\u003ccode\u003eArray.from()\u003c/code\u003e\u003c/a\u003e。\u003c/p\u003e\n\u003ch2\u003efor...of 循环\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003efor...of\u003c/code\u003e 接受一个可迭代对象（Iterable），或者能被强制转换/包装成一个可迭代对象的值。遍历时，\u003ccode\u003efor...of\u003c/code\u003e 会获取可迭代对象的 \u003ccode\u003e[Symbol.iterator]()\u003c/code\u003e，对该迭代器逐次调用 \u003ccode\u003enext()\u003c/code\u003e，直到迭代器返回对象的 \u003ccode\u003edone\u003c/code\u003e 属性为 \u003ccode\u003etrue\u003c/code\u003e 时，遍历结束，不对该 \u003ccode\u003evalue\u003c/code\u003e 处理。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efor...of\u003c/code\u003e 循环实例：\u003c/p\u003e\n\u003cpre class=\"hljs language-js\"  style=--lang:\"js\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e a = [\u003cspan class=\"hljs-string\"\u003e\u0026quot;a\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;b\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;c\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;d\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;e\u0026quot;\u003c/span\u003e];\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e val \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e a) {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e( val );\n}\n\u003cspan class=\"hljs-comment\"\u003e// \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e转换成普通 \u003ccode\u003efor\u003c/code\u003e 循环示例，等价于上面 \u003ccode\u003efor...of\u003c/code\u003e 循环：\u003c/p\u003e\n\u003cpre class=\"hljs language-js\"  style=--lang:\"js\" \u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e a = [\u003cspan class=\"hljs-string\"\u003e\u0026quot;a\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;b\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;c\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;d\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026quot;e\u0026quot;\u003c/span\u003e];\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e val, ret, it = a[\u003cspan class=\"hljs-title class_\"\u003eSymbol\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eiterator\u003c/span\u003e]();\n    (ret = it.\u003cspan class=\"hljs-title function_\"\u003enext\u003c/span\u003e()) \u0026amp;\u0026amp; !ret.\u003cspan class=\"hljs-property\"\u003edone\u003c/span\u003e;\n) {\n    val = ret.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e( val );\n}\n\u003cspan class=\"hljs-comment\"\u003e// \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003e参考文章\u003c/strong\u003e：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://es6.ruanyifeng.com/#docs/iterator\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eECMAScript 6 入门：Iterator\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/entry/5924f5302f301e006b35fba5\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"\u003eES6 之迭代器（Iterator）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"markdown-body\",\"children\":[\"$\",\"article\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$c\"}}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"front-end\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"front-end knowledge\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>