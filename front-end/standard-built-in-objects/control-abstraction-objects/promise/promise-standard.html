<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/ec0a9d078e716e00.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/485ff6fe79292a08.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/0ff121a467c0636f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-53834dba86d90934.js"/><script src="/_next/static/chunks/4bd1b696-20882bf820444624.js" async=""></script><script src="/_next/static/chunks/517-98ed787e5f259f2c.js" async=""></script><script src="/_next/static/chunks/main-app-f33d3e3aed85e21f.js" async=""></script><meta name="next-size-adjust" content=""/><title>front-end</title><meta name="description" content="front-end knowledge"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_4d318d __variable_ea5f4b antialiased"><main><div class="markdown-body"><h1>Promise/A+ è§„èŒƒ</h1><article><h1>Promise/A+ è§„èŒƒ</h1>
<p>Promise è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœï¼Œä¸ä¹‹è¿›è¡Œäº¤äº’çš„æ–¹å¼ä¸»è¦æ˜¯ <code>.then</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ³¨å†Œäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºæ¥æ”¶ Promise çš„ç»ˆå€¼æˆ–æœ¬ Promise ä¸èƒ½æ‰§è¡Œçš„åŸå› ã€‚</p>
<p>æœ¬è§„èŒƒè¯¦ç»†åˆ—å‡ºäº† <code>.then</code> æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ‰€æœ‰éµå¾ª Promises/A+ è§„èŒƒå®ç°çš„ Promise å‡å¯ä»¥æœ¬æ ‡å‡†ä½œä¸ºå‚ç…§åŸºç¡€æ¥å®æ–½ <code>.then</code> æ–¹æ³•ã€‚å› è€Œæœ¬è§„èŒƒæ˜¯ååˆ†ç¨³å®šçš„ã€‚å°½ç®¡ Promise/A+ ç»„ç»‡æœ‰æ—¶å¯èƒ½ä¼šä¿®è®¢æœ¬è§„èŒƒï¼Œä½†ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†ä¸€äº›ç‰¹æ®Šçš„è¾¹ç•Œæƒ…å†µï¼Œä¸”è¿™äº›æ”¹åŠ¨éƒ½æ˜¯å¾®å°ä¸”å‘ä¸‹å…¼å®¹çš„ã€‚å¦‚æœæˆ‘ä»¬è¦è¿›è¡Œå¤§è§„æ¨¡ä¸å…¼å®¹çš„æ›´æ–°ï¼Œæˆ‘ä»¬ä¸€å®šä¼šåœ¨äº‹å…ˆè¿›è¡Œè°¨æ…åœ°è€ƒè™‘ã€è¯¦å°½çš„æ¢è®¨å’Œä¸¥æ ¼çš„æµ‹è¯•ã€‚</p>
<p>ä»å†å²ä¸Šè¯´ï¼Œæœ¬è§„èŒƒå®é™…ä¸Šæ˜¯æŠŠä¹‹å‰ Promise/A è§„èŒƒ ä¸­çš„å»ºè®®æ˜ç¡®æˆä¸ºäº†è¡Œä¸ºæ ‡å‡†ï¼šæˆ‘ä»¬ä¸€æ–¹é¢æ‰©å±•äº†åŸæœ‰è§„èŒƒçº¦å®šä¿—æˆçš„è¡Œä¸ºï¼Œä¸€æ–¹é¢åˆ å‡äº†åŸè§„èŒƒçš„ä¸€äº›ç‰¹ä¾‹æƒ…å†µå’Œæœ‰é—®é¢˜çš„éƒ¨åˆ†ã€‚</p>
<p>æœ€åï¼Œæ ¸å¿ƒçš„ Promises/A+ è§„èŒƒä¸è®¾è®¡å¦‚ä½•åˆ›å»ºã€è§£å†³å’Œæ‹’ç» Promiseï¼Œè€Œæ˜¯ä¸“æ³¨äºæä¾›ä¸€ä¸ªé€šç”¨çš„ <code>.then</code> æ–¹æ³•ã€‚ä¸Šè¿°å¯¹äº Promises çš„æ“ä½œæ–¹æ³•å°†æ¥åœ¨å…¶ä»–è§„èŒƒä¸­å¯èƒ½ä¼šæåŠã€‚</p>
<h2>è§„èŒƒæœ¯è¯­</h2>
<ul>
<li><strong>è§£å†³ï¼ˆfulfillï¼‰</strong>ï¼šæŒ‡ä¸€ä¸ª Promise æˆåŠŸæ—¶è¿›è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼Œå¦‚çŠ¶æ€çš„æ”¹å˜ã€å›è°ƒçš„æ‰§è¡Œã€‚è™½ç„¶è§„èŒƒä¸­ç”¨ fulfill æ¥è¡¨ç¤ºè§£å†³ï¼Œä½†åœ¨åä¸–çš„ Promise å®ç°å¤šä»¥ resolve æ¥æŒ‡ä»£ä¹‹ã€‚</li>
<li><strong>æ‹’ç»ï¼ˆrejectï¼‰</strong>ï¼šæŒ‡ä¸€ä¸ª Promise å¤±è´¥æ—¶è¿›è¡Œçš„ä¸€ç³»åˆ—æ“ä½œã€‚</li>
<li><strong>ç»ˆå€¼ï¼ˆeventual valueï¼‰</strong>ï¼šæ‰€è°“ç»ˆå€¼ï¼ŒæŒ‡çš„æ˜¯ Promise è¢«è§£å†³æ—¶ä¼ é€’ç»™è§£å†³å›è°ƒçš„å€¼ï¼Œç”±äº Promise æœ‰ä¸€æ¬¡æ€§çš„ç‰¹å¾ï¼Œå› æ­¤å½“è¿™ä¸ªå€¼è¢«ä¼ é€’æ—¶ï¼Œæ ‡å¿—ç€ Promise ç­‰å¾…æ€çš„ç»“æŸï¼Œæ•…ç§°ä¹‹ç»ˆå€¼ï¼Œæœ‰æ—¶ä¹Ÿç›´æ¥ç®€ç§°ä¸ºå€¼ï¼ˆvalueï¼‰ã€‚</li>
<li><strong>æ‹’å› ï¼ˆreasonï¼‰</strong>ï¼šä¹Ÿå°±æ˜¯æ‹’ç»åŸå› ï¼ŒæŒ‡åœ¨ Promise è¢«æ‹’ç»æ—¶ä¼ é€’ç»™æ‹’ç»å›è°ƒçš„å€¼ã€‚</li>
</ul>
<h2>æœ¯è¯­</h2>
<ul>
<li><strong>Promise</strong>ï¼šPromise æ˜¯ä¸€ä¸ªæ‹¥æœ‰ <code>.then</code> æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œå…¶è¡Œä¸ºç¬¦åˆæœ¬è§„èŒƒï¼›</li>
<li><strong>thenable</strong>ï¼šæ˜¯ä¸€ä¸ªå®šä¹‰äº† <code>.then</code> æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œæ–‡ä¸­è¯‘ä½œ&quot;æ‹¥æœ‰ <code>.then</code> æ–¹æ³•&quot;ï¼›</li>
<li><strong>å€¼ï¼ˆvalueï¼‰</strong>ï¼šæŒ‡ä»»ä½• JavaScript çš„åˆæ³•å€¼ï¼ˆåŒ…æ‹¬ undefinedã€thenable å’Œ Promiseï¼‰ï¼›</li>
<li><strong>å¼‚å¸¸ï¼ˆexceptionï¼‰</strong>ï¼šæ˜¯ä½¿ç”¨ <code>throw</code> è¯­å¥æŠ›å‡ºçš„ä¸€ä¸ªå€¼ã€‚</li>
<li><strong>æ‹’å› ï¼ˆreasonï¼‰</strong>ï¼šè¡¨ç¤ºä¸€ä¸ª Promise çš„æ‹’ç»åŸå› ã€‚</li>
</ul>
<h2>çŠ¶æ€</h2>
<p>ä¸€ä¸ª Promise çš„å½“å‰çŠ¶æ€å¿…é¡»ä¸ºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¸­çš„ä¸€ç§ï¼šç­‰å¾…æ€ï¼ˆPendingï¼‰ã€æ‰§è¡Œæ€ï¼ˆFulfilledï¼‰å’Œæ‹’ç»æ€ï¼ˆRejectedï¼‰ã€‚</p>
<h3>ç­‰å¾…æ€ï¼ˆPendingï¼‰</h3>
<p>å¤„äºç­‰å¾…æ€æ—¶ï¼ŒPromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>å¯ä»¥è¿ç§»è‡³æ‰§è¡Œæ€æˆ–æ‹’ç»æ€</li>
</ul>
<h3>æ‰§è¡Œæ€ï¼ˆFulfilledï¼‰</h3>
<p>å¤„äºæ‰§è¡Œæ€æ—¶ï¼ŒPromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>ä¸èƒ½è¿ç§»è‡³å…¶ä»–ä»»ä½•çŠ¶æ€</li>
<li>å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç»ˆå€¼</li>
</ul>
<h3>æ‹’ç»æ€ï¼ˆRejectedï¼‰</h3>
<p>å¤„äºæ‹’ç»æ€æ—¶ï¼ŒPromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>ä¸èƒ½è¿ç§»è‡³å…¶ä»–ä»»ä½•çŠ¶æ€</li>
<li>å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸å¯å˜çš„æ‹’å› </li>
</ul>
<p>è¿™é‡Œçš„ä¸å¯å˜æŒ‡çš„æ˜¯æ’ç­‰ï¼ˆå³å¯ç”¨ <code>===</code> åˆ¤æ–­ç›¸ç­‰ï¼‰ï¼Œè€Œä¸æ˜¯æ„å‘³ç€æ›´æ·±å±‚æ¬¡çš„ä¸å¯å˜ï¼ˆè¯‘è€…æ³¨ï¼šç›–æŒ‡å½“ value æˆ– reason ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œåªè¦æ±‚å…¶å¼•ç”¨åœ°å€ç›¸ç­‰ï¼Œä½†å±æ€§å€¼å¯è¢«æ›´æ”¹ï¼‰ã€‚</p>
<h2>Then æ–¹æ³•</h2>
<p>ä¸€ä¸ª Promise å¿…é¡»æä¾›ä¸€ä¸ª <code>then</code> æ–¹æ³•ä»¥è®¿é—®å…¶<strong>å½“å‰å€¼</strong>ã€<strong>ç»ˆå€¼</strong>å’Œ<strong>æ‹’å› </strong>ã€‚</p>
<p>Promise çš„ then æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p>
<pre class="hljs"><code class="language-js"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">then</span>(onFulfilled, onRejected);
</code></pre>
<h3>å‚æ•°å¯é€‰</h3>
<p>onFulfilled å’Œ onRejected éƒ½æ˜¯å¯é€‰å‚æ•°ã€‚</p>
<ul>
<li>å¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥</li>
<li>å¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥</li>
</ul>
<h3>onFulfilled ç‰¹æ€§</h3>
<p>å¦‚æœ onFulfilled æ˜¯å‡½æ•°ï¼š</p>
<ul>
<li>å½“ Promise æ‰§è¡Œç»“æŸåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º Promise çš„ç»ˆå€¼</li>
<li>åœ¨ Promise æ‰§è¡Œç»“æŸå‰å…¶ä¸å¯è¢«è°ƒç”¨</li>
<li>å…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡</li>
</ul>
<h3>onRejected ç‰¹æ€§</h3>
<p>å¦‚æœ onRejected æ˜¯å‡½æ•°ï¼š</p>
<ul>
<li>å½“ Promise è¢«æ‹’ç»æ‰§è¡Œåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º Promise çš„æ‹’å› </li>
<li>åœ¨ Promise è¢«æ‹’ç»æ‰§è¡Œå‰å…¶ä¸å¯è¢«è°ƒç”¨</li>
<li>å…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡</li>
</ul>
<h3>è°ƒç”¨æ—¶æœº</h3>
<p>onFulfilled å’Œ onRejected åªæœ‰åœ¨æ‰§è¡Œç¯å¢ƒå †æ ˆä»…åŒ…å«å¹³å°ä»£ç æ—¶æ‰å¯è¢«è°ƒç”¨ã€‚<a href="#%E6%B3%A81">æ³¨ 1</a></p>
<h3>è°ƒç”¨è¦æ±‚</h3>
<p>onFulfilled å’Œ onRejected å¿…é¡»è¢«ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼ˆå³æ²¡æœ‰ this å€¼ï¼‰<a href="#%E6%B3%A82">æ³¨ 2</a></p>
<h3>å¤šæ¬¡è°ƒç”¨</h3>
<p><code>then</code> æ–¹æ³•å¯ä»¥è¢«åŒä¸€ä¸ª Promise è°ƒç”¨å¤šæ¬¡</p>
<ul>
<li>å½“ Promise æˆåŠŸæ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰ onFulfilled éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ</li>
<li>å½“ Promise è¢«æ‹’ç»æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰çš„ onRejected éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ</li>
</ul>
<h3>è¿”å›</h3>
<p><code>then</code> æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª Promise å¯¹è±¡<a href="#%E6%B3%A83">æ³¨ 3</a></p>
<pre class="hljs"><code class="language-js">promise2 = promise1.<span class="hljs-title function_">then</span>(onFulfilled, onRejected);
</code></pre>
<ul>
<li>å¦‚æœ onFulfilled æˆ–è€… onRejected è¿”å›ä¸€ä¸ªå€¼ <code>x</code> ï¼Œåˆ™è¿è¡Œä¸‹é¢çš„ Promise è§£å†³è¿‡ç¨‹ï¼š<code>[[Resolve]](Promise2, x)</code></li>
<li>å¦‚æœ onFulfilled æˆ–è€… onRejected æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ <code>e</code> ï¼Œåˆ™ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œï¼Œå¹¶è¿”å›æ‹’å›  <code>e</code></li>
<li>å¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ä¸” promise1 æˆåŠŸæ‰§è¡Œï¼Œ promise2 å¿…é¡»æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„å€¼</li>
<li>å¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ä¸” promise1 æ‹’ç»æ‰§è¡Œï¼Œ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„æ‹’å› </li>
</ul>
<p><strong>è¯‘è€…æ³¨</strong>ï¼šç†è§£ä¸Šé¢çš„&quot;è¿”å›&quot;éƒ¨åˆ†éå¸¸é‡è¦ï¼Œå³ï¼š<strong>ä¸è®º <code>promise1</code> è¢« reject è¿˜æ˜¯è¢« resolve æ—¶ <code>promise2</code> éƒ½ä¼šè¢« resolveï¼Œåªæœ‰å‡ºç°å¼‚å¸¸æ—¶æ‰ä¼šè¢« rejectedã€‚</strong></p>
<h2>è§£å†³è¿‡ç¨‹</h2>
<p><strong>Promise è§£å†³è¿‡ç¨‹</strong>æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ“ä½œï¼Œå…¶éœ€è¾“å…¥ä¸€ä¸ª Promise å’Œä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬è¡¨ç¤ºä¸º <code>[[Resolve]](Promise, x)</code>ï¼Œå¦‚æœ <code>x</code> æœ‰ <code>then</code> æ–¹æ³•ä¸”çœ‹ä¸Šå»åƒä¸€ä¸ª Promise ï¼Œè§£å†³ç¨‹åºå³å°è¯•ä½¿ Promise æ¥å— <code>x</code> çš„çŠ¶æ€ï¼›å¦åˆ™å…¶ç”¨ <code>x</code> çš„å€¼æ¥æ‰§è¡Œ Promise ã€‚</p>
<p>è¿™ç§ thenable çš„ç‰¹æ€§ä½¿å¾— Promise çš„å®ç°æ›´å…·æœ‰é€šç”¨æ€§ï¼šåªè¦å…¶æš´éœ²å‡ºä¸€ä¸ªéµå¾ª Promise/A+ åè®®çš„ <code>then</code> æ–¹æ³•å³å¯ï¼›è¿™åŒæ—¶ä¹Ÿä½¿éµå¾ª Promise/A+ è§„èŒƒçš„å®ç°å¯ä»¥ä¸é‚£äº›ä¸å¤ªè§„èŒƒä½†å¯ç”¨çš„å®ç°èƒ½è‰¯å¥½å…±å­˜ã€‚</p>
<p>è¿è¡Œ <code>[[Resolve]](Promise, x)</code> éœ€éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š</p>
<h3>x ä¸ Promise ç›¸ç­‰</h3>
<p>å¦‚æœ Promise å’Œ x æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œä»¥ TypeError ä¸ºæ‹’å› æ‹’ç»æ‰§è¡Œ Promise</p>
<h3>x ä¸º Promise</h3>
<p>å¦‚æœ x ä¸º Promise ï¼Œåˆ™ä½¿ Promise æ¥å— x çš„çŠ¶æ€ <a href="#%E6%B3%A84">æ³¨ 4</a>ï¼š</p>
<ul>
<li>å¦‚æœ x å¤„äºç­‰å¾…æ€ï¼ŒPromise éœ€ä¿æŒä¸ºç­‰å¾…æ€ç›´è‡³ x è¢«æ‰§è¡Œæˆ–æ‹’ç»</li>
<li>å¦‚æœ x å¤„äºæ‰§è¡Œæ€ï¼Œç”¨ç›¸åŒçš„å€¼æ‰§è¡Œ Promise</li>
<li>å¦‚æœ x å¤„äºæ‹’ç»æ€ï¼Œç”¨ç›¸åŒçš„æ‹’å› æ‹’ç» Promise</li>
</ul>
<h3>x ä¸ºå¯¹è±¡æˆ–å‡½æ•°</h3>
<p>å¦‚æœ x ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼š</p>
<ul>
<li>æŠŠ <code>x.then</code> èµ‹å€¼ç»™ <code>then</code> <a href="#%E6%B3%A85">æ³¨ 5</a></li>
<li>å¦‚æœå– <code>x.then</code> çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ <code>e</code> ï¼Œåˆ™ä»¥ <code>e</code> ä¸ºæ‹’å› æ‹’ç» Promise</li>
<li>å¦‚æœ <code>then</code> æ˜¯å‡½æ•°ï¼Œå°† <code>x</code> ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ <code>this</code> è°ƒç”¨ä¹‹ã€‚ä¼ é€’ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å«åš <code>resolvePromise</code> ï¼Œç¬¬äºŒä¸ªå‚æ•°å«åš <code>rejectPromise</code>:
<ul>
<li>å¦‚æœ <code>resolvePromise</code> ä»¥å€¼ <code>y</code> ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ [[Resolve]](Promise, y)</li>
<li>å¦‚æœ <code>rejectPromise</code> ä»¥æ‹’å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ‹’å›  r æ‹’ç» Promise</li>
<li>å¦‚æœ <code>resolvePromise</code> å’Œ <code>rejectPromise</code> å‡è¢«è°ƒç”¨ï¼Œæˆ–è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©ä¸‹çš„è°ƒç”¨</li>
<li>å¦‚æœè°ƒç”¨ <code>then</code> æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ <code>e</code>ï¼š
<ul>
<li>å¦‚æœ <code>resolvePromise</code> æˆ– <code>rejectPromise</code> å·²ç»è¢«è°ƒç”¨ï¼Œåˆ™å¿½ç•¥ä¹‹</li>
<li>å¦åˆ™ä»¥ <code>e</code> ä¸ºæ‹’å› æ‹’ç» Promise</li>
</ul>
</li>
<li>å¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ Promise</li>
</ul>
</li>
<li>å¦‚æœ x ä¸ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ Promise</li>
</ul>
<p>å¦‚æœä¸€ä¸ª Promise è¢«ä¸€ä¸ªå¾ªç¯çš„ thenable é“¾ä¸­çš„å¯¹è±¡è§£å†³ï¼Œè€Œ <code>[[Resolve]](Promise, thenable)</code> çš„é€’å½’æ€§è´¨åˆä½¿å¾—å…¶è¢«å†æ¬¡è°ƒç”¨ï¼Œæ ¹æ®ä¸Šè¿°çš„ç®—æ³•å°†ä¼šé™·å…¥æ— é™é€’å½’ä¹‹ä¸­ã€‚ç®—æ³•è™½ä¸å¼ºåˆ¶è¦æ±‚ï¼Œä½†ä¹Ÿé¼“åŠ±æ–½è€…æ£€æµ‹è¿™æ ·çš„é€’å½’æ˜¯å¦å­˜åœ¨ï¼Œè‹¥æ£€æµ‹åˆ°å­˜åœ¨åˆ™ä»¥ä¸€ä¸ªå¯è¯†åˆ«çš„ TypeError ä¸ºæ‹’å› æ¥æ‹’ç» Promise <a href="#%E6%B3%A86">æ³¨ 6</a>ã€‚</p>
<h2>æ³¨é‡Š</h2>
<h3>æ³¨ 1</h3>
<p>è¿™é‡Œçš„<strong>å¹³å°ä»£ç </strong>æŒ‡çš„æ˜¯å¼•æ“ã€ç¯å¢ƒä»¥åŠ promise çš„å®æ–½ä»£ç ã€‚å®è·µä¸­è¦ç¡®ä¿ onFulfilled å’Œ onRejected æ–¹æ³•å¼‚æ­¥æ‰§è¡Œï¼Œä¸”åº”è¯¥åœ¨ then æ–¹æ³•è¢«è°ƒç”¨çš„é‚£ä¸€è½®äº‹ä»¶å¾ªç¯ä¹‹åçš„æ–°æ‰§è¡Œæ ˆä¸­æ‰§è¡Œã€‚è¿™ä¸ªäº‹ä»¶é˜Ÿåˆ—å¯ä»¥é‡‡ç”¨ <strong>å®ä»»åŠ¡ï¼ˆmacro-taskï¼‰</strong> æœºåˆ¶æˆ–è€… <strong>å¾®ä»»åŠ¡ï¼ˆmicro-taskï¼‰</strong> æœºåˆ¶æ¥å®ç°ã€‚ç”±äº Promise çš„å®æ–½ä»£ç æœ¬èº«å°±æ˜¯å¹³å°ä»£ç ï¼ˆ<strong>è¯‘è€…æ³¨</strong>ï¼šå³éƒ½æ˜¯ JavaScriptï¼‰ï¼Œæ•…ä»£ç è‡ªèº«åœ¨å¤„ç†åœ¨å¤„ç†ç¨‹åºæ—¶å¯èƒ½å·²ç»åŒ…å«ä¸€ä¸ªä»»åŠ¡è°ƒåº¦é˜Ÿåˆ—ã€‚</p>
<p><strong>è¯‘è€…æ³¨</strong>ï¼šè¿™é‡ŒæåŠäº† <code>macrotask</code> å’Œ <code>microtask</code> ä¸¤ä¸ªæ¦‚å¿µï¼Œè¿™è¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡çš„ä¸¤ç§åˆ†ç±»ã€‚åœ¨æŒ‚èµ·ä»»åŠ¡æ—¶ï¼ŒJavaScript å¼•æ“ä¼šå°†æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§ç±»åˆ«åˆ†åˆ°è¿™ä¸¤ä¸ªé˜Ÿåˆ—ä¸­ï¼Œé¦–å…ˆåœ¨ <code>macrotask</code> çš„é˜Ÿåˆ—ï¼ˆè¿™ä¸ªé˜Ÿåˆ—ä¹Ÿè¢«å«åš <code>task queue</code> ä»»åŠ¡é˜Ÿåˆ—ï¼‰ä¸­å–å‡ºç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæ¯•åå–å‡º <code>microtask</code> é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡é¡ºåºæ‰§è¡Œï¼›ä¹‹åå†å– <code>macrotask</code> ä»»åŠ¡ï¼Œå‘¨è€Œå¤å§‹ï¼Œç›´è‡³ä¸¤ä¸ªé˜Ÿåˆ—çš„ä»»åŠ¡éƒ½å–å®Œã€‚</p>
<p>ä¸¤ä¸ªç±»åˆ«çš„å…·ä½“åˆ†ç±»å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>macro-task</strong>: scriptï¼ˆæ•´ä½“ä»£ç ï¼‰ã€<code>setTimeout</code>ã€<code>setInterval</code>ã€setImmediateã€I/Oã€UI rendering</li>
<li><strong>micro-task</strong>: process.nextTickã€Promiseï¼ˆè¿™é‡ŒæŒ‡æµè§ˆå™¨å®ç°çš„åŸç”Ÿ Promiseï¼‰ã€Object.observeã€MutationObserver</li>
</ul>
<h3>æ³¨ 2</h3>
<p>åœ¨ä¸¥æ ¼æ¨¡å¼ï¼ˆ<code>strict</code>ï¼‰ä¸­ï¼Œå‡½æ•° <code>this</code> çš„å€¼ä¸º <code>undefined</code>ï¼›åœ¨éä¸¥æ ¼æ¨¡å¼ä¸­å…¶ä¸ºå…¨å±€å¯¹è±¡ã€‚</p>
<h3>æ³¨ 3</h3>
<p>ä»£ç å®ç°åœ¨æ»¡è¶³æ‰€æœ‰è¦æ±‚çš„æƒ…å†µä¸‹å¯ä»¥å…è®¸ <code>promise2 === promise1</code> ã€‚æ¯ä¸ªå®ç°éƒ½è¦æ–‡æ¡£è¯´æ˜å…¶æ˜¯å¦å…è®¸ä»¥åŠåœ¨ä½•ç§æ¡ä»¶ä¸‹å…è®¸ <code>promise2 === promise1</code>ã€‚</p>
<h3>æ³¨ 4</h3>
<p>æ€»ä½“æ¥è¯´ï¼Œå¦‚æœ <code>x</code> ç¬¦åˆå½“å‰å®ç°ï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºå®ƒæ˜¯çœŸæ­£çš„ Promise ã€‚è¿™ä¸€è§„åˆ™å…è®¸é‚£äº›ç‰¹ä¾‹å®ç°æ¥å—ç¬¦åˆå·²çŸ¥è¦æ±‚çš„ Promise çŠ¶æ€ã€‚</p>
<h3>æ³¨ 5</h3>
<p>è¿™æ­¥æˆ‘ä»¬å…ˆæ˜¯å­˜å‚¨äº†ä¸€ä¸ªæŒ‡å‘ <code>x.then</code> çš„å¼•ç”¨ï¼Œç„¶åæµ‹è¯•å¹¶è°ƒç”¨è¯¥å¼•ç”¨ï¼Œä»¥é¿å…å¤šæ¬¡è®¿é—® <code>x.then</code> å±æ€§ã€‚è¿™ç§é¢„é˜²æªæ–½ç¡®ä¿äº†è¯¥å±æ€§çš„ä¸€è‡´æ€§ï¼Œå› ä¸ºå…¶å€¼å¯èƒ½åœ¨æ£€ç´¢è°ƒç”¨æ—¶è¢«æ”¹å˜ã€‚</p>
<h3>æ³¨ 6</h3>
<p>å®ç°ä¸åº”è¯¥å¯¹ thenable é“¾çš„æ·±åº¦è®¾é™ï¼Œå¹¶å‡å®šè¶…å‡ºæœ¬é™åˆ¶çš„é€’å½’å°±æ˜¯æ— é™å¾ªç¯ã€‚åªæœ‰çœŸæ­£çš„å¾ªç¯é€’å½’æ‰åº”èƒ½å¯¼è‡´ TypeError å¼‚å¸¸ï¼›å¦‚æœä¸€æ¡æ— é™é•¿çš„é“¾ä¸Š thenable å‡ä¸ç›¸åŒï¼Œé‚£ä¹ˆé€’å½’ä¸‹å»æ°¸è¿œæ˜¯æ­£ç¡®çš„è¡Œä¸ºã€‚</p>
<h2>å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://Promisesaplus.com/">ğŸ“– Promise/A+ è§„èŒƒåŸæ–‡</a></li>
<li><a href="http://www.ituring.com.cn/article/66566">ğŸ“– Promise/A+ è§„èŒƒè¯‘æ–‡</a></li>
<li><a href="https://juejin.im/post/6844904116913700877">ğŸ“ æ‰‹å†™ä¸€ä¸ª Promise/A+ï¼Œå®Œç¾é€šè¿‡å®˜æ–¹ 872 ä¸ªæµ‹è¯•ç”¨ä¾‹</a></li>
<li><a href="https://juejin.im/post/6856213486633304078">ğŸ“ æ‰‹å†™ Promise æ ¸å¿ƒåŸç†</a></li>
</ul>
</article></div></main><script src="/_next/static/chunks/webpack-53834dba86d90934.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n5:I[6213,[],\"OutletBoundary\"]\n7:I[6213,[],\"MetadataBoundary\"]\n9:I[6213,[],\"ViewportBoundary\"]\nb:I[4835,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/ec0a9d078e716e00.css\",\"style\"]\n:HL[\"/_next/static/css/485ff6fe79292a08.css\",\"style\"]\n:HL[\"/_next/static/css/0ff121a467c0636f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"P2aiewlOc1Z9OPuSRFf3D\",\"p\":\"\",\"c\":[\"\",\"front-end\",\"standard-built-in-objects\",\"control-abstraction-objects\",\"promise\",\"promise-standard\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"front-end\",{\"children\":[[\"slug\",\"standard-built-in-objects/control-abstraction-objects/promise/promise-standard\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ec0a9d078e716e00.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_4d318d __variable_ea5f4b antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"front-end\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/485ff6fe79292a08.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0ff121a467c0636f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"slug\",\"standard-built-in-objects/control-abstraction-objects/promise/promise-standard\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"front-end\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":\"$L6\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"jjruH7FF0MIFaGC7wc5tN\",{\"children\":[[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$b\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:T31db,"])</script><script>self.__next_f.push([1,"\u003ch1\u003ePromise/A+ è§„èŒƒ\u003c/h1\u003e\n\u003cp\u003ePromise è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœï¼Œä¸ä¹‹è¿›è¡Œäº¤äº’çš„æ–¹å¼ä¸»è¦æ˜¯ \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ³¨å†Œäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºæ¥æ”¶ Promise çš„ç»ˆå€¼æˆ–æœ¬ Promise ä¸èƒ½æ‰§è¡Œçš„åŸå› ã€‚\u003c/p\u003e\n\u003cp\u003eæœ¬è§„èŒƒè¯¦ç»†åˆ—å‡ºäº† \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ‰€æœ‰éµå¾ª Promises/A+ è§„èŒƒå®ç°çš„ Promise å‡å¯ä»¥æœ¬æ ‡å‡†ä½œä¸ºå‚ç…§åŸºç¡€æ¥å®æ–½ \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•ã€‚å› è€Œæœ¬è§„èŒƒæ˜¯ååˆ†ç¨³å®šçš„ã€‚å°½ç®¡ Promise/A+ ç»„ç»‡æœ‰æ—¶å¯èƒ½ä¼šä¿®è®¢æœ¬è§„èŒƒï¼Œä½†ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†ä¸€äº›ç‰¹æ®Šçš„è¾¹ç•Œæƒ…å†µï¼Œä¸”è¿™äº›æ”¹åŠ¨éƒ½æ˜¯å¾®å°ä¸”å‘ä¸‹å…¼å®¹çš„ã€‚å¦‚æœæˆ‘ä»¬è¦è¿›è¡Œå¤§è§„æ¨¡ä¸å…¼å®¹çš„æ›´æ–°ï¼Œæˆ‘ä»¬ä¸€å®šä¼šåœ¨äº‹å…ˆè¿›è¡Œè°¨æ…åœ°è€ƒè™‘ã€è¯¦å°½çš„æ¢è®¨å’Œä¸¥æ ¼çš„æµ‹è¯•ã€‚\u003c/p\u003e\n\u003cp\u003eä»å†å²ä¸Šè¯´ï¼Œæœ¬è§„èŒƒå®é™…ä¸Šæ˜¯æŠŠä¹‹å‰ Promise/A è§„èŒƒ ä¸­çš„å»ºè®®æ˜ç¡®æˆä¸ºäº†è¡Œä¸ºæ ‡å‡†ï¼šæˆ‘ä»¬ä¸€æ–¹é¢æ‰©å±•äº†åŸæœ‰è§„èŒƒçº¦å®šä¿—æˆçš„è¡Œä¸ºï¼Œä¸€æ–¹é¢åˆ å‡äº†åŸè§„èŒƒçš„ä¸€äº›ç‰¹ä¾‹æƒ…å†µå’Œæœ‰é—®é¢˜çš„éƒ¨åˆ†ã€‚\u003c/p\u003e\n\u003cp\u003eæœ€åï¼Œæ ¸å¿ƒçš„ Promises/A+ è§„èŒƒä¸è®¾è®¡å¦‚ä½•åˆ›å»ºã€è§£å†³å’Œæ‹’ç» Promiseï¼Œè€Œæ˜¯ä¸“æ³¨äºæä¾›ä¸€ä¸ªé€šç”¨çš„ \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•ã€‚ä¸Šè¿°å¯¹äº Promises çš„æ“ä½œæ–¹æ³•å°†æ¥åœ¨å…¶ä»–è§„èŒƒä¸­å¯èƒ½ä¼šæåŠã€‚\u003c/p\u003e\n\u003ch2\u003eè§„èŒƒæœ¯è¯­\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eè§£å†³ï¼ˆfulfillï¼‰\u003c/strong\u003eï¼šæŒ‡ä¸€ä¸ª Promise æˆåŠŸæ—¶è¿›è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼Œå¦‚çŠ¶æ€çš„æ”¹å˜ã€å›è°ƒçš„æ‰§è¡Œã€‚è™½ç„¶è§„èŒƒä¸­ç”¨ fulfill æ¥è¡¨ç¤ºè§£å†³ï¼Œä½†åœ¨åä¸–çš„ Promise å®ç°å¤šä»¥ resolve æ¥æŒ‡ä»£ä¹‹ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ‹’ç»ï¼ˆrejectï¼‰\u003c/strong\u003eï¼šæŒ‡ä¸€ä¸ª Promise å¤±è´¥æ—¶è¿›è¡Œçš„ä¸€ç³»åˆ—æ“ä½œã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç»ˆå€¼ï¼ˆeventual valueï¼‰\u003c/strong\u003eï¼šæ‰€è°“ç»ˆå€¼ï¼ŒæŒ‡çš„æ˜¯ Promise è¢«è§£å†³æ—¶ä¼ é€’ç»™è§£å†³å›è°ƒçš„å€¼ï¼Œç”±äº Promise æœ‰ä¸€æ¬¡æ€§çš„ç‰¹å¾ï¼Œå› æ­¤å½“è¿™ä¸ªå€¼è¢«ä¼ é€’æ—¶ï¼Œæ ‡å¿—ç€ Promise ç­‰å¾…æ€çš„ç»“æŸï¼Œæ•…ç§°ä¹‹ç»ˆå€¼ï¼Œæœ‰æ—¶ä¹Ÿç›´æ¥ç®€ç§°ä¸ºå€¼ï¼ˆvalueï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ‹’å› ï¼ˆreasonï¼‰\u003c/strong\u003eï¼šä¹Ÿå°±æ˜¯æ‹’ç»åŸå› ï¼ŒæŒ‡åœ¨ Promise è¢«æ‹’ç»æ—¶ä¼ é€’ç»™æ‹’ç»å›è°ƒçš„å€¼ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eæœ¯è¯­\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ePromise\u003c/strong\u003eï¼šPromise æ˜¯ä¸€ä¸ªæ‹¥æœ‰ \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œå…¶è¡Œä¸ºç¬¦åˆæœ¬è§„èŒƒï¼›\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ethenable\u003c/strong\u003eï¼šæ˜¯ä¸€ä¸ªå®šä¹‰äº† \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œæ–‡ä¸­è¯‘ä½œ\u0026quot;æ‹¥æœ‰ \u003ccode\u003e.then\u003c/code\u003e æ–¹æ³•\u0026quot;ï¼›\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå€¼ï¼ˆvalueï¼‰\u003c/strong\u003eï¼šæŒ‡ä»»ä½• JavaScript çš„åˆæ³•å€¼ï¼ˆåŒ…æ‹¬ undefinedã€thenable å’Œ Promiseï¼‰ï¼›\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¼‚å¸¸ï¼ˆexceptionï¼‰\u003c/strong\u003eï¼šæ˜¯ä½¿ç”¨ \u003ccode\u003ethrow\u003c/code\u003e è¯­å¥æŠ›å‡ºçš„ä¸€ä¸ªå€¼ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ‹’å› ï¼ˆreasonï¼‰\u003c/strong\u003eï¼šè¡¨ç¤ºä¸€ä¸ª Promise çš„æ‹’ç»åŸå› ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eçŠ¶æ€\u003c/h2\u003e\n\u003cp\u003eä¸€ä¸ª Promise çš„å½“å‰çŠ¶æ€å¿…é¡»ä¸ºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¸­çš„ä¸€ç§ï¼šç­‰å¾…æ€ï¼ˆPendingï¼‰ã€æ‰§è¡Œæ€ï¼ˆFulfilledï¼‰å’Œæ‹’ç»æ€ï¼ˆRejectedï¼‰ã€‚\u003c/p\u003e\n\u003ch3\u003eç­‰å¾…æ€ï¼ˆPendingï¼‰\u003c/h3\u003e\n\u003cp\u003eå¤„äºç­‰å¾…æ€æ—¶ï¼ŒPromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¯ä»¥è¿ç§»è‡³æ‰§è¡Œæ€æˆ–æ‹’ç»æ€\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eæ‰§è¡Œæ€ï¼ˆFulfilledï¼‰\u003c/h3\u003e\n\u003cp\u003eå¤„äºæ‰§è¡Œæ€æ—¶ï¼ŒPromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸èƒ½è¿ç§»è‡³å…¶ä»–ä»»ä½•çŠ¶æ€\u003c/li\u003e\n\u003cli\u003eå¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç»ˆå€¼\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eæ‹’ç»æ€ï¼ˆRejectedï¼‰\u003c/h3\u003e\n\u003cp\u003eå¤„äºæ‹’ç»æ€æ—¶ï¼ŒPromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸èƒ½è¿ç§»è‡³å…¶ä»–ä»»ä½•çŠ¶æ€\u003c/li\u003e\n\u003cli\u003eå¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸å¯å˜çš„æ‹’å› \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eè¿™é‡Œçš„ä¸å¯å˜æŒ‡çš„æ˜¯æ’ç­‰ï¼ˆå³å¯ç”¨ \u003ccode\u003e===\u003c/code\u003e åˆ¤æ–­ç›¸ç­‰ï¼‰ï¼Œè€Œä¸æ˜¯æ„å‘³ç€æ›´æ·±å±‚æ¬¡çš„ä¸å¯å˜ï¼ˆè¯‘è€…æ³¨ï¼šç›–æŒ‡å½“ value æˆ– reason ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œåªè¦æ±‚å…¶å¼•ç”¨åœ°å€ç›¸ç­‰ï¼Œä½†å±æ€§å€¼å¯è¢«æ›´æ”¹ï¼‰ã€‚\u003c/p\u003e\n\u003ch2\u003eThen æ–¹æ³•\u003c/h2\u003e\n\u003cp\u003eä¸€ä¸ª Promise å¿…é¡»æä¾›ä¸€ä¸ª \u003ccode\u003ethen\u003c/code\u003e æ–¹æ³•ä»¥è®¿é—®å…¶\u003cstrong\u003eå½“å‰å€¼\u003c/strong\u003eã€\u003cstrong\u003eç»ˆå€¼\u003c/strong\u003eå’Œ\u003cstrong\u003eæ‹’å› \u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003ePromise çš„ then æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(onFulfilled, onRejected);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eå‚æ•°å¯é€‰\u003c/h3\u003e\n\u003cp\u003eonFulfilled å’Œ onRejected éƒ½æ˜¯å¯é€‰å‚æ•°ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥\u003c/li\u003e\n\u003cli\u003eå¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eonFulfilled ç‰¹æ€§\u003c/h3\u003e\n\u003cp\u003eå¦‚æœ onFulfilled æ˜¯å‡½æ•°ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå½“ Promise æ‰§è¡Œç»“æŸåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º Promise çš„ç»ˆå€¼\u003c/li\u003e\n\u003cli\u003eåœ¨ Promise æ‰§è¡Œç»“æŸå‰å…¶ä¸å¯è¢«è°ƒç”¨\u003c/li\u003e\n\u003cli\u003eå…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eonRejected ç‰¹æ€§\u003c/h3\u003e\n\u003cp\u003eå¦‚æœ onRejected æ˜¯å‡½æ•°ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå½“ Promise è¢«æ‹’ç»æ‰§è¡Œåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º Promise çš„æ‹’å› \u003c/li\u003e\n\u003cli\u003eåœ¨ Promise è¢«æ‹’ç»æ‰§è¡Œå‰å…¶ä¸å¯è¢«è°ƒç”¨\u003c/li\u003e\n\u003cli\u003eå…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eè°ƒç”¨æ—¶æœº\u003c/h3\u003e\n\u003cp\u003eonFulfilled å’Œ onRejected åªæœ‰åœ¨æ‰§è¡Œç¯å¢ƒå †æ ˆä»…åŒ…å«å¹³å°ä»£ç æ—¶æ‰å¯è¢«è°ƒç”¨ã€‚\u003ca href=\"#%E6%B3%A81\"\u003eæ³¨ 1\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eè°ƒç”¨è¦æ±‚\u003c/h3\u003e\n\u003cp\u003eonFulfilled å’Œ onRejected å¿…é¡»è¢«ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼ˆå³æ²¡æœ‰ this å€¼ï¼‰\u003ca href=\"#%E6%B3%A82\"\u003eæ³¨ 2\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eå¤šæ¬¡è°ƒç”¨\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ethen\u003c/code\u003e æ–¹æ³•å¯ä»¥è¢«åŒä¸€ä¸ª Promise è°ƒç”¨å¤šæ¬¡\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå½“ Promise æˆåŠŸæ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰ onFulfilled éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ\u003c/li\u003e\n\u003cli\u003eå½“ Promise è¢«æ‹’ç»æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰çš„ onRejected éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eè¿”å›\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ethen\u003c/code\u003e æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª Promise å¯¹è±¡\u003ca href=\"#%E6%B3%A83\"\u003eæ³¨ 3\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"hljs\"\u003e\u003ccode class=\"language-js\"\u003epromise2 = promise1.\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(onFulfilled, onRejected);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœ onFulfilled æˆ–è€… onRejected è¿”å›ä¸€ä¸ªå€¼ \u003ccode\u003ex\u003c/code\u003e ï¼Œåˆ™è¿è¡Œä¸‹é¢çš„ Promise è§£å†³è¿‡ç¨‹ï¼š\u003ccode\u003e[[Resolve]](Promise2, x)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eå¦‚æœ onFulfilled æˆ–è€… onRejected æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ \u003ccode\u003ee\u003c/code\u003e ï¼Œåˆ™ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œï¼Œå¹¶è¿”å›æ‹’å›  \u003ccode\u003ee\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eå¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ä¸” promise1 æˆåŠŸæ‰§è¡Œï¼Œ promise2 å¿…é¡»æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„å€¼\u003c/li\u003e\n\u003cli\u003eå¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ä¸” promise1 æ‹’ç»æ‰§è¡Œï¼Œ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„æ‹’å› \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eè¯‘è€…æ³¨\u003c/strong\u003eï¼šç†è§£ä¸Šé¢çš„\u0026quot;è¿”å›\u0026quot;éƒ¨åˆ†éå¸¸é‡è¦ï¼Œå³ï¼š\u003cstrong\u003eä¸è®º \u003ccode\u003epromise1\u003c/code\u003e è¢« reject è¿˜æ˜¯è¢« resolve æ—¶ \u003ccode\u003epromise2\u003c/code\u003e éƒ½ä¼šè¢« resolveï¼Œåªæœ‰å‡ºç°å¼‚å¸¸æ—¶æ‰ä¼šè¢« rejectedã€‚\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003eè§£å†³è¿‡ç¨‹\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003ePromise è§£å†³è¿‡ç¨‹\u003c/strong\u003eæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ“ä½œï¼Œå…¶éœ€è¾“å…¥ä¸€ä¸ª Promise å’Œä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬è¡¨ç¤ºä¸º \u003ccode\u003e[[Resolve]](Promise, x)\u003c/code\u003eï¼Œå¦‚æœ \u003ccode\u003ex\u003c/code\u003e æœ‰ \u003ccode\u003ethen\u003c/code\u003e æ–¹æ³•ä¸”çœ‹ä¸Šå»åƒä¸€ä¸ª Promise ï¼Œè§£å†³ç¨‹åºå³å°è¯•ä½¿ Promise æ¥å— \u003ccode\u003ex\u003c/code\u003e çš„çŠ¶æ€ï¼›å¦åˆ™å…¶ç”¨ \u003ccode\u003ex\u003c/code\u003e çš„å€¼æ¥æ‰§è¡Œ Promise ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™ç§ thenable çš„ç‰¹æ€§ä½¿å¾— Promise çš„å®ç°æ›´å…·æœ‰é€šç”¨æ€§ï¼šåªè¦å…¶æš´éœ²å‡ºä¸€ä¸ªéµå¾ª Promise/A+ åè®®çš„ \u003ccode\u003ethen\u003c/code\u003e æ–¹æ³•å³å¯ï¼›è¿™åŒæ—¶ä¹Ÿä½¿éµå¾ª Promise/A+ è§„èŒƒçš„å®ç°å¯ä»¥ä¸é‚£äº›ä¸å¤ªè§„èŒƒä½†å¯ç”¨çš„å®ç°èƒ½è‰¯å¥½å…±å­˜ã€‚\u003c/p\u003e\n\u003cp\u003eè¿è¡Œ \u003ccode\u003e[[Resolve]](Promise, x)\u003c/code\u003e éœ€éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š\u003c/p\u003e\n\u003ch3\u003ex ä¸ Promise ç›¸ç­‰\u003c/h3\u003e\n\u003cp\u003eå¦‚æœ Promise å’Œ x æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œä»¥ TypeError ä¸ºæ‹’å› æ‹’ç»æ‰§è¡Œ Promise\u003c/p\u003e\n\u003ch3\u003ex ä¸º Promise\u003c/h3\u003e\n\u003cp\u003eå¦‚æœ x ä¸º Promise ï¼Œåˆ™ä½¿ Promise æ¥å— x çš„çŠ¶æ€ \u003ca href=\"#%E6%B3%A84\"\u003eæ³¨ 4\u003c/a\u003eï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœ x å¤„äºç­‰å¾…æ€ï¼ŒPromise éœ€ä¿æŒä¸ºç­‰å¾…æ€ç›´è‡³ x è¢«æ‰§è¡Œæˆ–æ‹’ç»\u003c/li\u003e\n\u003cli\u003eå¦‚æœ x å¤„äºæ‰§è¡Œæ€ï¼Œç”¨ç›¸åŒçš„å€¼æ‰§è¡Œ Promise\u003c/li\u003e\n\u003cli\u003eå¦‚æœ x å¤„äºæ‹’ç»æ€ï¼Œç”¨ç›¸åŒçš„æ‹’å› æ‹’ç» Promise\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003ex ä¸ºå¯¹è±¡æˆ–å‡½æ•°\u003c/h3\u003e\n\u003cp\u003eå¦‚æœ x ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæŠŠ \u003ccode\u003ex.then\u003c/code\u003e èµ‹å€¼ç»™ \u003ccode\u003ethen\u003c/code\u003e \u003ca href=\"#%E6%B3%A85\"\u003eæ³¨ 5\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eå¦‚æœå– \u003ccode\u003ex.then\u003c/code\u003e çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ \u003ccode\u003ee\u003c/code\u003e ï¼Œåˆ™ä»¥ \u003ccode\u003ee\u003c/code\u003e ä¸ºæ‹’å› æ‹’ç» Promise\u003c/li\u003e\n\u003cli\u003eå¦‚æœ \u003ccode\u003ethen\u003c/code\u003e æ˜¯å‡½æ•°ï¼Œå°† \u003ccode\u003ex\u003c/code\u003e ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ \u003ccode\u003ethis\u003c/code\u003e è°ƒç”¨ä¹‹ã€‚ä¼ é€’ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å«åš \u003ccode\u003eresolvePromise\u003c/code\u003e ï¼Œç¬¬äºŒä¸ªå‚æ•°å«åš \u003ccode\u003erejectPromise\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003eå¦‚æœ \u003ccode\u003eresolvePromise\u003c/code\u003e ä»¥å€¼ \u003ccode\u003ey\u003c/code\u003e ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ [[Resolve]](Promise, y)\u003c/li\u003e\n\u003cli\u003eå¦‚æœ \u003ccode\u003erejectPromise\u003c/code\u003e ä»¥æ‹’å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ‹’å›  r æ‹’ç» Promise\u003c/li\u003e\n\u003cli\u003eå¦‚æœ \u003ccode\u003eresolvePromise\u003c/code\u003e å’Œ \u003ccode\u003erejectPromise\u003c/code\u003e å‡è¢«è°ƒç”¨ï¼Œæˆ–è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©ä¸‹çš„è°ƒç”¨\u003c/li\u003e\n\u003cli\u003eå¦‚æœè°ƒç”¨ \u003ccode\u003ethen\u003c/code\u003e æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ \u003ccode\u003ee\u003c/code\u003eï¼š\n\u003cul\u003e\n\u003cli\u003eå¦‚æœ \u003ccode\u003eresolvePromise\u003c/code\u003e æˆ– \u003ccode\u003erejectPromise\u003c/code\u003e å·²ç»è¢«è°ƒç”¨ï¼Œåˆ™å¿½ç•¥ä¹‹\u003c/li\u003e\n\u003cli\u003eå¦åˆ™ä»¥ \u003ccode\u003ee\u003c/code\u003e ä¸ºæ‹’å› æ‹’ç» Promise\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eå¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ Promise\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eå¦‚æœ x ä¸ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ Promise\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå¦‚æœä¸€ä¸ª Promise è¢«ä¸€ä¸ªå¾ªç¯çš„ thenable é“¾ä¸­çš„å¯¹è±¡è§£å†³ï¼Œè€Œ \u003ccode\u003e[[Resolve]](Promise, thenable)\u003c/code\u003e çš„é€’å½’æ€§è´¨åˆä½¿å¾—å…¶è¢«å†æ¬¡è°ƒç”¨ï¼Œæ ¹æ®ä¸Šè¿°çš„ç®—æ³•å°†ä¼šé™·å…¥æ— é™é€’å½’ä¹‹ä¸­ã€‚ç®—æ³•è™½ä¸å¼ºåˆ¶è¦æ±‚ï¼Œä½†ä¹Ÿé¼“åŠ±æ–½è€…æ£€æµ‹è¿™æ ·çš„é€’å½’æ˜¯å¦å­˜åœ¨ï¼Œè‹¥æ£€æµ‹åˆ°å­˜åœ¨åˆ™ä»¥ä¸€ä¸ªå¯è¯†åˆ«çš„ TypeError ä¸ºæ‹’å› æ¥æ‹’ç» Promise \u003ca href=\"#%E6%B3%A86\"\u003eæ³¨ 6\u003c/a\u003eã€‚\u003c/p\u003e\n\u003ch2\u003eæ³¨é‡Š\u003c/h2\u003e\n\u003ch3\u003eæ³¨ 1\u003c/h3\u003e\n\u003cp\u003eè¿™é‡Œçš„\u003cstrong\u003eå¹³å°ä»£ç \u003c/strong\u003eæŒ‡çš„æ˜¯å¼•æ“ã€ç¯å¢ƒä»¥åŠ promise çš„å®æ–½ä»£ç ã€‚å®è·µä¸­è¦ç¡®ä¿ onFulfilled å’Œ onRejected æ–¹æ³•å¼‚æ­¥æ‰§è¡Œï¼Œä¸”åº”è¯¥åœ¨ then æ–¹æ³•è¢«è°ƒç”¨çš„é‚£ä¸€è½®äº‹ä»¶å¾ªç¯ä¹‹åçš„æ–°æ‰§è¡Œæ ˆä¸­æ‰§è¡Œã€‚è¿™ä¸ªäº‹ä»¶é˜Ÿåˆ—å¯ä»¥é‡‡ç”¨ \u003cstrong\u003eå®ä»»åŠ¡ï¼ˆmacro-taskï¼‰\u003c/strong\u003e æœºåˆ¶æˆ–è€… \u003cstrong\u003eå¾®ä»»åŠ¡ï¼ˆmicro-taskï¼‰\u003c/strong\u003e æœºåˆ¶æ¥å®ç°ã€‚ç”±äº Promise çš„å®æ–½ä»£ç æœ¬èº«å°±æ˜¯å¹³å°ä»£ç ï¼ˆ\u003cstrong\u003eè¯‘è€…æ³¨\u003c/strong\u003eï¼šå³éƒ½æ˜¯ JavaScriptï¼‰ï¼Œæ•…ä»£ç è‡ªèº«åœ¨å¤„ç†åœ¨å¤„ç†ç¨‹åºæ—¶å¯èƒ½å·²ç»åŒ…å«ä¸€ä¸ªä»»åŠ¡è°ƒåº¦é˜Ÿåˆ—ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eè¯‘è€…æ³¨\u003c/strong\u003eï¼šè¿™é‡ŒæåŠäº† \u003ccode\u003emacrotask\u003c/code\u003e å’Œ \u003ccode\u003emicrotask\u003c/code\u003e ä¸¤ä¸ªæ¦‚å¿µï¼Œè¿™è¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡çš„ä¸¤ç§åˆ†ç±»ã€‚åœ¨æŒ‚èµ·ä»»åŠ¡æ—¶ï¼ŒJavaScript å¼•æ“ä¼šå°†æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§ç±»åˆ«åˆ†åˆ°è¿™ä¸¤ä¸ªé˜Ÿåˆ—ä¸­ï¼Œé¦–å…ˆåœ¨ \u003ccode\u003emacrotask\u003c/code\u003e çš„é˜Ÿåˆ—ï¼ˆè¿™ä¸ªé˜Ÿåˆ—ä¹Ÿè¢«å«åš \u003ccode\u003etask queue\u003c/code\u003e ä»»åŠ¡é˜Ÿåˆ—ï¼‰ä¸­å–å‡ºç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæ¯•åå–å‡º \u003ccode\u003emicrotask\u003c/code\u003e é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡é¡ºåºæ‰§è¡Œï¼›ä¹‹åå†å– \u003ccode\u003emacrotask\u003c/code\u003e ä»»åŠ¡ï¼Œå‘¨è€Œå¤å§‹ï¼Œç›´è‡³ä¸¤ä¸ªé˜Ÿåˆ—çš„ä»»åŠ¡éƒ½å–å®Œã€‚\u003c/p\u003e\n\u003cp\u003eä¸¤ä¸ªç±»åˆ«çš„å…·ä½“åˆ†ç±»å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003emacro-task\u003c/strong\u003e: scriptï¼ˆæ•´ä½“ä»£ç ï¼‰ã€\u003ccode\u003esetTimeout\u003c/code\u003eã€\u003ccode\u003esetInterval\u003c/code\u003eã€setImmediateã€I/Oã€UI rendering\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003emicro-task\u003c/strong\u003e: process.nextTickã€Promiseï¼ˆè¿™é‡ŒæŒ‡æµè§ˆå™¨å®ç°çš„åŸç”Ÿ Promiseï¼‰ã€Object.observeã€MutationObserver\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eæ³¨ 2\u003c/h3\u003e\n\u003cp\u003eåœ¨ä¸¥æ ¼æ¨¡å¼ï¼ˆ\u003ccode\u003estrict\u003c/code\u003eï¼‰ä¸­ï¼Œå‡½æ•° \u003ccode\u003ethis\u003c/code\u003e çš„å€¼ä¸º \u003ccode\u003eundefined\u003c/code\u003eï¼›åœ¨éä¸¥æ ¼æ¨¡å¼ä¸­å…¶ä¸ºå…¨å±€å¯¹è±¡ã€‚\u003c/p\u003e\n\u003ch3\u003eæ³¨ 3\u003c/h3\u003e\n\u003cp\u003eä»£ç å®ç°åœ¨æ»¡è¶³æ‰€æœ‰è¦æ±‚çš„æƒ…å†µä¸‹å¯ä»¥å…è®¸ \u003ccode\u003epromise2 === promise1\u003c/code\u003e ã€‚æ¯ä¸ªå®ç°éƒ½è¦æ–‡æ¡£è¯´æ˜å…¶æ˜¯å¦å…è®¸ä»¥åŠåœ¨ä½•ç§æ¡ä»¶ä¸‹å…è®¸ \u003ccode\u003epromise2 === promise1\u003c/code\u003eã€‚\u003c/p\u003e\n\u003ch3\u003eæ³¨ 4\u003c/h3\u003e\n\u003cp\u003eæ€»ä½“æ¥è¯´ï¼Œå¦‚æœ \u003ccode\u003ex\u003c/code\u003e ç¬¦åˆå½“å‰å®ç°ï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºå®ƒæ˜¯çœŸæ­£çš„ Promise ã€‚è¿™ä¸€è§„åˆ™å…è®¸é‚£äº›ç‰¹ä¾‹å®ç°æ¥å—ç¬¦åˆå·²çŸ¥è¦æ±‚çš„ Promise çŠ¶æ€ã€‚\u003c/p\u003e\n\u003ch3\u003eæ³¨ 5\u003c/h3\u003e\n\u003cp\u003eè¿™æ­¥æˆ‘ä»¬å…ˆæ˜¯å­˜å‚¨äº†ä¸€ä¸ªæŒ‡å‘ \u003ccode\u003ex.then\u003c/code\u003e çš„å¼•ç”¨ï¼Œç„¶åæµ‹è¯•å¹¶è°ƒç”¨è¯¥å¼•ç”¨ï¼Œä»¥é¿å…å¤šæ¬¡è®¿é—® \u003ccode\u003ex.then\u003c/code\u003e å±æ€§ã€‚è¿™ç§é¢„é˜²æªæ–½ç¡®ä¿äº†è¯¥å±æ€§çš„ä¸€è‡´æ€§ï¼Œå› ä¸ºå…¶å€¼å¯èƒ½åœ¨æ£€ç´¢è°ƒç”¨æ—¶è¢«æ”¹å˜ã€‚\u003c/p\u003e\n\u003ch3\u003eæ³¨ 6\u003c/h3\u003e\n\u003cp\u003eå®ç°ä¸åº”è¯¥å¯¹ thenable é“¾çš„æ·±åº¦è®¾é™ï¼Œå¹¶å‡å®šè¶…å‡ºæœ¬é™åˆ¶çš„é€’å½’å°±æ˜¯æ— é™å¾ªç¯ã€‚åªæœ‰çœŸæ­£çš„å¾ªç¯é€’å½’æ‰åº”èƒ½å¯¼è‡´ TypeError å¼‚å¸¸ï¼›å¦‚æœä¸€æ¡æ— é™é•¿çš„é“¾ä¸Š thenable å‡ä¸ç›¸åŒï¼Œé‚£ä¹ˆé€’å½’ä¸‹å»æ°¸è¿œæ˜¯æ­£ç¡®çš„è¡Œä¸ºã€‚\u003c/p\u003e\n\u003ch2\u003eå‚è€ƒèµ„æ–™\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://Promisesaplus.com/\"\u003eğŸ“– Promise/A+ è§„èŒƒåŸæ–‡\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.ituring.com.cn/article/66566\"\u003eğŸ“– Promise/A+ è§„èŒƒè¯‘æ–‡\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/post/6844904116913700877\"\u003eğŸ“ æ‰‹å†™ä¸€ä¸ª Promise/A+ï¼Œå®Œç¾é€šè¿‡å®˜æ–¹ 872 ä¸ªæµ‹è¯•ç”¨ä¾‹\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/post/6856213486633304078\"\u003eğŸ“ æ‰‹å†™ Promise æ ¸å¿ƒåŸç†\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"markdown-body\",\"children\":[[\"$\",\"h1\",null,{\"children\":\"Promise/A+ è§„èŒƒ\"}],[\"$\",\"article\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$c\"}}]]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"front-end\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"front-end knowledge\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>